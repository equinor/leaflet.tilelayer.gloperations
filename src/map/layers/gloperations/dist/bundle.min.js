this.L=this.L||{},this.L.TileLayer=this.L.TileLayer||{},this.L.TileLayer.GLOperations=function(e){"use strict";var Mu=Math.PI,Hu=Math.sin,Vu=Math.cos,Ou=Math.sqrt,zu=Math.atan2,Pu=Math.round,Gu=Math.abs,ju=Math.pow,Uu=Math.LN10,Wu=Math.log,Xu=Math.floor,qu=Math.max,Yu=Math.ceil,Zu=Math.min,Ku=String.fromCharCode;function t(e,t){function o(){this.constructor=e}$u(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}function o(e,t,o,i){return new(o||(o=Promise))(function(n,a){function r(e){try{s(i.next(e))}catch(t){a(t)}}function l(e){try{s(i["throw"](e))}catch(t){a(t)}}function s(e){e.done?n(e.value):new o(function(t){t(e.value)}).then(r,l)}s((i=i.apply(e,t||[])).next())})}function n(e,o){function i(e){return function(t){return a([e,t])}}function a(t){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,l&&(s=2&t[0]?l["return"]:t[0]?l["throw"]||((s=l["return"])&&s.call(l),0):l.next)&&!(s=s.call(l,t[1])).done)return s;switch((l=0,s)&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return r.label++,{value:t[1],done:!1};case 5:r.label++,l=t[1],t=[0];continue;case 7:t=r.ops.pop(),r.trys.pop();continue;default:if((s=r.trys,!(s=0<s.length&&s[s.length-1]))&&(6===t[0]||2===t[0])){r=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){r.label=t[1];break}if(6===t[0]&&r.label<s[1]){r.label=s[1],s=t;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(t);break}s[2]&&r.ops.pop(),r.trys.pop();continue;}t=o.call(e,r)}catch(o){t=[6,o],l=0}finally{n=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},n,l,s,d;return d={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d}function a(e){var t=nc.call(e,rc),o=e[rc];try{e[rc]=void 0;var i=!0}catch(t){}var n=ac.call(e);return i&&(t?e[rc]=o:delete e[rc]),n}function r(e){return sc.call(e)}function l(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":dc&&dc in Object(e)?a(e):r(e)}function s(e){return null!=e&&"object"==typeof e}function d(e){return"symbol"==typeof e||s(e)&&l(e)=="[object Symbol]"}function f(e){return"number"==typeof e?e:d(e)?fc:+e}function u(e,t){for(var o=-1,i=null==e?0:e.length,n=Array(i);++o<i;)n[o]=t(e[o],o,e);return n}function c(e){if("string"==typeof e)return e;if(uc(e))return u(e,c)+"";if(d(e))return gc?gc.call(e):"";var t=e+"";return"0"==t&&1/e==-cc?"-0":t}function p(e,t){return function(o,i){var n;if(void 0===o&&void 0===i)return t;if(void 0!==o&&(n=o),void 0!==i){if(void 0===n)return i;"string"==typeof o||"string"==typeof i?(o=c(o),i=c(i)):(o=f(o),i=f(i)),n=e(o,i)}return n}}function g(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function h(e){if("number"==typeof e)return e;if(d(e))return mc;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(xc,"");var o=_c.test(e);return o||yc.test(e)?vc(e.slice(2),o?2:8):bc.test(e)?mc:+e}function m(e){if(!e)return 0===e?e:0;if(e=h(e),e===Tc||e===-Tc){var t=0>e?-1:1;return 1.7976931348623157e+308*t}return e===e?e:0}function x(e){var t=m(e),o=t%1;return t===t?o?t-o:t:0}function b(e){return e}function _(e){if(!g(e))return!1;var t=l(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"}function y(e){return!!Cc&&Cc in e}function v(e){if(null!=e){try{return Bc.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function T(e){if(!g(e)||y(e))return!1;var t=_(e)?Rc:Sc;return t.test(v(e))}function w(e,t){return null==e?void 0:e[t]}function S(e,t){var o=w(e,t);return T(o)?o:void 0}function I(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);}var o=Vc(e.prototype),i=e.apply(o,t);return g(i)?i:o}}function F(e,t,o){function i(){var t=this&&this!==tc&&this instanceof i?a:e;return t.apply(n?o:this,arguments)}var n=t&1,a=I(e);return i}function R(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2]);}return e.apply(t,o)}function k(e,t,o,i){for(var n=-1,a=e.length,r=o.length,l=-1,s=t.length,d=Oc(a-r,0),f=Array(s+d),u=!i;++l<s;)f[l]=t[l];for(;++n<r;)(u||n<a)&&(f[o[n]]=e[n]);for(;d--;)f[l++]=e[n++];return f}function N(e,t,o,i){for(var n=-1,a=e.length,r=-1,l=o.length,s=-1,d=t.length,f=zc(a-l,0),u=Array(f+d),c=!i;++n<f;)u[n]=e[n];for(var p=n;++s<d;)u[p+s]=t[s];for(;++r<l;)(c||n<a)&&(u[p+o[r]]=e[n++]);return u}function M(e,t){for(var o=e.length,i=0;o--;)e[o]===t&&++i;return i}function H(){}function V(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function O(){}function z(e){for(var t=e.name+"",o=Gc[t],i=Uc.call(Gc,t)?o.length:0;i--;){var n=o[i],a=n.func;if(null==a||a==e)return n.name}return t}function P(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function G(e,t){var o=-1,i=e.length;for(t||(t=Array(i));++o<i;)t[o]=e[o];return t}function j(e){if(e instanceof V)return e.clone();var t=new P(e.__wrapped__,e.__chain__);return t.__actions__=G(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function U(e){if(s(e)&&!uc(e)&&!(e instanceof V)){if(e instanceof P)return e;if(Xc.call(e,"__wrapped__"))return j(e)}return new P(e)}function W(e){var t=z(e),o=U[t];if("function"!=typeof o||!(t in V.prototype))return!1;if(e===o)return!0;var i=Pc(o);return!!i&&e===i[0]}function X(e){var t=0,o=0;return function(){var i=qc(),n=16-(i-o);if(o=i,!(0<n))t=0;else if(800<=++t)return arguments[0];return e.apply(void 0,arguments)}}function Y(e){var t=e.match(Zc);return t?t[1].split(Kc):[]}function Z(e,t){var o=t.length;if(!o)return e;var i=o-1;return t[i]=(1<o?"& ":"")+t[i],t=t.join(2<o?", ":" "),e.replace($c,"{\n/* [wrapped with "+t+"] */\n")}function $(e){return function(){return e}}function Q(e,t){for(var o=-1,i=null==e?0:e.length;++o<i&&!(!1===t(e[o],o,e)););return e}function J(e,t,o,i){for(var n=e.length,a=o+(i?1:-1);i?a--:++a<n;)if(t(e[a],a,e))return a;return-1}function ee(e){return e!==e}function te(e,t,o){for(var i=o-1,n=e.length;++i<n;)if(e[i]===t)return i;return-1}function oe(e,t,o){return t===t?te(e,t,o):J(e,ee,o)}function ie(e,t){var o=null==e?0:e.length;return!!o&&-1<oe(e,t,0)}function ne(e,t){return Q(tp,function(o){var i="_."+o[0];t&o[1]&&!ie(e,i)&&e.push(i)}),e.sort()}function ae(e,t,o){var i=t+"";return ep(e,Z(i,ne(Y(i),o)))}function le(e,t,o,i,n,a,r,l,s,d){var f=8&t,u=f?r:void 0,c=f?void 0:r,p=f?a:void 0,g=f?void 0:a;t|=f?32:64,t&=~(f?64:32),4&t||(t&=-4);var h=[e,t,n,p,u,g,c,l,s,d],m=o.apply(void 0,h);return W(e)&&Yc(m,h),m.placeholder=i,ae(m,e,t)}function se(e){return e.placeholder}function de(e,t){var o=typeof e;return t=null==t?9007199254740991:t,!!t&&("number"==o||"symbol"!=o&&op.test(e))&&-1<e&&0==e%1&&e<t}function fe(e,t){for(var o=e.length,i=ip(t.length,o),n=G(e);i--;){var a=t[i];e[i]=de(a,o)?n[a]:void 0}return e}function ue(e,t){for(var o=-1,i=e.length,n=0,a=[];++o<i;){var r=e[o];(r===t||r==="__lodash_placeholder__")&&(e[o]="__lodash_placeholder__",a[n++]=o)}return a}function ce(e,t,o,i,n,a,r,l,s,d){function f(){for(var x=arguments.length,b=Array(x),_=x;_--;)b[_]=arguments[_];if(g)var y=se(f),v=M(b,y);if(i&&(b=k(b,i,n,g)),a&&(b=N(b,a,r,g)),x-=v,g&&x<d){var T=ue(b,y);return le(e,t,ce,f.placeholder,o,b,T,l,s,d-x)}var A=c?o:this,C=p?A[e]:e;return x=b.length,l?b=fe(b,l):h&&1<x&&b.reverse(),u&&s<x&&(b.length=s),this&&this!==tc&&this instanceof f&&(C=m||I(C)),C.apply(A,b)}var u=t&128,c=t&1,p=t&2,g=t&24,h=t&512,m=p?void 0:I(e);return f}function pe(e,t,o){function i(){for(var a=arguments.length,r=Array(a),l=a,s=se(i);l--;)r[l]=arguments[l];var d=3>a&&r[0]!==s&&r[a-1]!==s?[]:ue(r,s);if(a-=d.length,a<o)return le(e,t,ce,i.placeholder,void 0,r,d,void 0,void 0,o-a);var f=this&&this!==tc&&this instanceof i?n:e;return R(f,this,r)}var n=I(e);return i}function ge(e,t,o,i){function n(){for(var t=-1,l=arguments.length,s=-1,d=i.length,f=Array(d+l),u=this&&this!==tc&&this instanceof n?r:e;++s<d;)f[s]=i[s];for(;l--;)f[s++]=arguments[++t];return R(u,a?o:this,f)}var a=t&1,r=I(e);return n}function he(e,t){var o=e[1],i=t[1],n=o|i,a=131>n,r=128==i&&8==o||128==i&&256==o&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==o;if(!(a||r))return e;1&i&&(e[2]=t[2],n|=1&o?0:4);var l=t[3];if(l){var s=e[3];e[3]=s?k(s,l,t[4]):l,e[4]=s?ue(e[3],"__lodash_placeholder__"):t[4]}return l=t[5],l&&(s=e[5],e[5]=s?N(s,l,t[6]):l,e[6]=s?ue(e[5],"__lodash_placeholder__"):t[6]),l=t[7],l&&(e[7]=l),128&i&&(e[8]=null==e[8]?t[8]:np(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=n,e}function me(e,t,o,i,n,a,r,l){var s=2&t;if(!s&&"function"!=typeof e)throw new TypeError("Expected a function");var d=i?i.length:0;if(d||(t&=-97,i=n=void 0),r=void 0===r?r:ap(x(r),0),l=void 0===l?l:x(l),d-=n?n.length:0,64&t){var f=i,u=n;i=n=void 0}var c=s?void 0:Pc(e),p=[e,t,o,i,n,f,u,a,r,l];if(c&&he(p,c),e=p[0],t=p[1],o=p[2],i=p[3],n=p[4],l=p[9]=void 0===p[9]?s?0:e.length:ap(p[9]-d,0),!l&&24&t&&(t&=-25),!t||1==t)var g=F(e,t,o);else g=8==t||16==t?pe(e,t,l):32!=t&&33!=t||n.length?ce.apply(void 0,p):ge(e,t,o,i);var h=c?Mc:Yc;return ae(h(g,p),e,t)}function xe(e,t,o){return t=o?void 0:t,t=e&&null==t?e.length:t,me(e,128,void 0,void 0,void 0,void 0,t)}function be(e,t,o){"__proto__"==t&&Qc?Qc(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function _e(e,t){return e===t||e!==e&&t!==t}function i(e,t,o){var i=e[t];lp.call(e,t)&&_e(i,o)&&(o!==void 0||t in e)||be(e,t,o)}function ye(e,t,o,n){var a=!o;o||(o={});for(var r=-1,l=t.length;++r<l;){var s=t[r],d=n?n(o[s],e[s],s,o,e):void 0;d===void 0&&(d=e[s]),a?be(o,s,d):i(o,s,d)}return o}function ve(e,t,o){return t=sp(void 0===t?e.length-1:t,0),function(){for(var i=arguments,n=-1,a=sp(i.length-t,0),r=Array(a);++n<a;)r[n]=i[t+n];n=-1;for(var l=Array(t+1);++n<t;)l[n]=i[n];return l[t]=o(r),R(e,this,l)}}function Te(e,t){return ep(ve(e,t,b),e+"")}function Ae(e){return"number"==typeof e&&-1<e&&0==e%1&&e<=9007199254740991}function Ce(e){return null!=e&&Ae(e.length)&&!_(e)}function Ee(e,t,o){if(!g(o))return!1;var i=typeof t;return!("number"==i?!(Ce(o)&&de(t,o.length)):!("string"==i&&t in o))&&_e(o[t],e)}function Be(e){return Te(function(t,o){var i=-1,n=o.length,a=1<n?o[n-1]:void 0,r=2<n?o[2]:void 0;for(a=3<e.length&&"function"==typeof a?(n--,a):void 0,r&&Ee(o[0],o[1],r)&&(a=3>n?void 0:a,n=1),t=Object(t);++i<n;){var l=o[i];l&&e(t,l,i,a)}return t})}function we(e){var t=e&&e.constructor,o="function"==typeof t&&t.prototype||dp;return e===o}function Se(e,t){for(var o=-1,i=Array(e);++o<e;)i[o]=t(o);return i}function Le(e){return s(e)&&l(e)=="[object Arguments]"}function De(){return!1}function Ie(e){return function(t){return e(t)}}function Fe(e,t){var o=uc(e),i=!o&&pp(e),n=!o&&!i&&_p(e),a=!o&&!i&&!n&&wp(e),r=o||i||n||a,l=r?Se(e.length,String):[],s=l.length;for(var d in e)(t||Lp.call(e,d))&&!(r&&("length"==d||n&&("offset"==d||"parent"==d)||a&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||de(d,s)))&&l.push(d);return l}function Re(e,t){return function(o){return e(t(o))}}function ke(e){if(!we(e))return Dp(e);var t=[];for(var o in Object(e))Fp.call(e,o)&&"constructor"!=o&&t.push(o);return t}function Ne(e){return Ce(e)?Fe(e):ke(e)}function Me(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t}function He(e){if(!g(e))return Me(e);var t=we(e),o=[];for(var i in e)("constructor"!=i||!t&&Hp.call(e,i))&&o.push(i);return o}function Ve(e){return Ce(e)?Fe(e,!0):He(e)}function Oe(e,t){if(uc(e))return!1;var o=typeof e;return!!("number"==o||"symbol"==o||"boolean"==o||null==e||d(e))||Gp.test(e)||!Pp.test(e)||null!=t&&e in Object(t)}function ze(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}function Pe(e,t){for(var o=e.length;o--;)if(_e(e[o][0],t))return o;return-1}function Ge(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}function je(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function Ue(e,t){var o=e.__data__;return je(t)?o["string"==typeof t?"string":"hash"]:o.map}function We(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}function Xe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var o=function(){var i=arguments,n=t?t.apply(this,i):i[0],a=o.cache;if(a.has(n))return a.get(n);var r=e.apply(this,i);return o.cache=a.set(n,r)||a,r};return o.cache=new(Xe.Cache||We),o}function qe(e){return null==e?"":c(e)}function Ye(e,t){return uc(e)?e:Oe(e,t)?[e]:Jp(qe(e))}function Ze(e){if("string"==typeof e||d(e))return e;var t=e+"";return"0"==t&&1/e==-eg?"-0":t}function Ke(e,t){t=Ye(t,e);for(var o=0,i=t.length;null!=e&&o<i;)e=e[Ze(t[o++])];return o&&o==i?e:void 0}function $e(e,t,o){var i=null==e?void 0:Ke(e,t);return i===void 0?o:i}function Qe(e,t){for(var o=-1,i=t.length,n=Array(i);++o<i;)n[o]=null==e?void 0:$e(e,t[o]);return n}function Je(e,t){for(var o=-1,i=t.length,n=e.length;++o<i;)e[n+o]=t[o];return e}function et(e){return uc(e)||pp(e)||!!(tg&&e&&e[tg])}function tt(e,t,o,i,n){var a=-1,r=e.length;for(o||(o=et),n||(n=[]);++a<r;){var l=e[a];0<t&&o(l)?1<t?tt(l,t-1,o,i,n):Je(n,l):!i&&(n[n.length]=l)}return n}function ot(e){var t=null==e?0:e.length;return t?tt(e,1):[]}function it(e){return ep(ve(e,void 0,ot),e+"")}function nt(e){if(!s(e)||l(e)!="[object Object]")return!1;var t=at(e);if(null===t)return!0;var o=rg.call(t,"constructor")&&t.constructor;return"function"==typeof o&&o instanceof o&&ag.call(o)==lg}function rt(e){if(!s(e))return!1;var t=l(e);return t=="[object Error]"||t=="[object DOMException]"||"string"==typeof e.message&&"string"==typeof e.name&&!nt(e)}function st(e,t){var o;if("function"!=typeof t)throw new TypeError("Expected a function");return e=x(e),function(){return 0<--e&&(o=t.apply(this,arguments)),1>=e&&(t=void 0),o}}function dt(e,t,o){var i=-1,n=e.length;0>t&&(t=-t>n?0:n+t),o=o>n?n:o,0>o&&(o+=n),n=t>o?0:o-t>>>0,t>>>=0;for(var a=Array(n);++i<n;)a[i]=e[i+t];return a}function ft(e,t,o){var i=e.length;return o=void 0===o?i:o,!t&&o>=i?e:dt(e,t,o)}function ut(e){return cg.test(e)}function ct(e){return e.split("")}function pt(e){return e.match(Ag)||[]}function ht(e){return ut(e)?pt(e):ct(e)}function mt(e){return function(t){t=qe(t);var o=ut(t)?ht(t):void 0,i=o?o[0]:t.charAt(0),n=o?ft(o,1).join(""):t.slice(1);return i[e]()+n}}function xt(e){return Cg(qe(e).toLowerCase())}function bt(e,t,o,i){var n=-1,a=null==e?0:e.length;for(i&&a&&(o=e[++n]);++n<a;)o=t(o,e[n],n,e);return o}function _t(e){return function(t){return null==e?void 0:e[t]}}function yt(e){return e=qe(e),e&&e.replace(Bg,Eg).replace(wg,"")}function vt(e){return e.match(Sg)||[]}function Tt(e){return Lg.test(e)}function At(e){return e.match(Kg)||[]}function Ct(e,t,o){return e=qe(e),t=o?void 0:t,void 0===t?Tt(e)?At(e):vt(e):e.match(t)||[]}function Et(e){return function(t){return bt(Ct(yt(t).replace($g,"")),e,"")}}function Bt(e){var t=Math[e];return function(e,o){if(e=h(e),o=null==o?0:eh(x(o),292),o&&Jg(e)){var i=(qe(e)+"e").split("e"),n=t(i[0]+"e"+(+i[1]+o));return i=(qe(n)+"e").split("e"),+(i[0]+"e"+(+i[1]-o))}return t(e)}}function wt(e){var t=U(e);return t.__chain__=!0,t}function St(e,t,o){t=(o?Ee(e,t,o):void 0===t)?1:ih(x(t),0);var i=null==e?0:e.length;if(!i||1>t)return[];for(var n=0,a=0,r=Array(oh(i/t));n<i;)r[a++]=dt(e,n,n+=t);return r}function Lt(e,t,o){return e===e&&(void 0!==o&&(e=e<=o?e:o),void 0!==t&&(e=e>=t?e:t)),e}function Dt(e){var t=this.__data__=new Ge(e);this.size=t.size}function It(e,t){return e&&ye(t,Ne(t),e)}function Ft(e,t){return e&&ye(t,Ve(t),e)}function Rt(e,t){if(t)return e.slice();var o=e.length,i=sh?sh(o):new e.constructor(o);return e.copy(i),i}function kt(e,t){for(var o=-1,i=null==e?0:e.length,n=0,a=[];++o<i;){var r=e[o];t(r,o,e)&&(a[n++]=r)}return a}function Nt(){return[]}function Mt(e,t){return ye(e,ch(e),t)}function Ht(e,t){return ye(e,gh(e),t)}function Vt(e,t,o){var i=t(e);return uc(e)?i:Je(i,o(e))}function Ot(e){return Vt(e,Ne,ch)}function zt(e){return Vt(e,Ve,gh)}function Pt(e){var t=e.length,o=new e.constructor(t);return t&&"string"==typeof e[0]&&Ih.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Gt(e){var t=new e.constructor(e.byteLength);return new Fh(t).set(new Fh(e)),t}function jt(e,t){var o=t?Gt(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Ut(e){var t=new e.constructor(e.source,Rh.exec(e));return t.lastIndex=e.lastIndex,t}function Wt(e){return Nh?Object(Nh.call(e)):{}}function Xt(e,t){var o=t?Gt(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function qt(e,t,o){var i=e.constructor;return"[object ArrayBuffer]"===t?Gt(e):"[object Boolean]"===t||"[object Date]"===t?new i(+e):"[object DataView]"===t?jt(e,o):"[object Float32Array]"===t||"[object Float64Array]"===t||"[object Int8Array]"===t||"[object Int16Array]"===t||"[object Int32Array]"===t||"[object Uint8Array]"===t||"[object Uint8ClampedArray]"===t||"[object Uint16Array]"===t||"[object Uint32Array]"===t?Xt(e,o):"[object Map]"===t?new i:"[object Number]"===t||"[object String]"===t?new i(e):"[object RegExp]"===t?Ut(e):"[object Set]"===t?new i:"[object Symbol]"===t?Wt(e):void 0}function Yt(e){return"function"!=typeof e.constructor||we(e)?{}:Vc(at(e))}function Zt(e,t,o,n,a,r){var l=1&t,s=2&t,d;if(o&&(d=a?o(e,n,a,r):o(e)),void 0!==d)return d;if(!g(e))return e;var f=uc(e);if(!f){var u=Lh(e),c="[object Function]"==u||"[object GeneratorFunction]"==u;if(_p(e))return Rt(e,l);if("[object Object]"!=u&&"[object Arguments]"!=u&&(!c||a)){if(!zh[u])return a?e:{};d=qt(e,u,l)}else if(d=s||c?{}:Yt(e),!l)return s?Ht(e,Ft(d,e)):Mt(e,It(d,e))}else if(d=Pt(e),!l)return G(e,d);r||(r=new Dt);var p=r.get(e);if(p)return p;r.set(e,d),Oh(e)?e.forEach(function(i){d.add(Zt(i,t,o,i,e,r))}):Hh(e)&&e.forEach(function(i,n){d.set(n,Zt(i,t,o,n,e,r))});var h=4&t?s?zt:Ot:s?keysIn:Ne,m=f?void 0:h(e);return Q(m||e,function(n,a){m&&(a=n,n=e[a]),i(d,a,Zt(n,t,o,a,e,r))}),d}function Kt(e){var t=-1,o=null==e?0:e.length;for(this.__data__=new We;++t<o;)this.add(e[t])}function $t(e,t){for(var o=-1,i=null==e?0:e.length;++o<i;)if(t(e[o],o,e))return!0;return!1}function Qt(e,t){return e.has(t)}function Jt(e,t,o,i,n,a){var r=1&o,l=e.length,s=t.length;if(l!=s&&!(r&&s>l))return!1;var d=a.get(e);if(d&&a.get(t))return d==t;var f=-1,u=!0,c=2&o?new Kt:void 0;for(a.set(e,t),a.set(t,e);++f<l;){var p=e[f],g=t[f];if(i)var h=r?i(g,p,f,t,e,a):i(p,g,f,e,t,a);if(void 0!==h){if(h)continue;u=!1;break}if(c){if(!$t(t,function(e,t){if(!Qt(c,t)&&(p===e||n(p,e,o,i,a)))return c.push(t)})){u=!1;break}}else if(!(p===g||n(p,g,o,i,a))){u=!1;break}}return a["delete"](e),a["delete"](t),u}function eo(e){var t=-1,o=Array(e.size);return e.forEach(function(e,i){o[++t]=[i,e]}),o}function to(e){var t=-1,o=Array(e.size);return e.forEach(function(e){o[++t]=e}),o}function oo(e,t,o,i,n,a,r){switch(o){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!!(e.byteLength==t.byteLength&&a(new Fh(e),new Fh(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _e(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var l=eo;case"[object Set]":var s=1&i;if(l||(l=to),e.size!=t.size&&!s)return!1;var d=r.get(e);if(d)return d==t;i|=2,r.set(e,t);var f=Jt(l(e),l(t),i,n,a,r);return r["delete"](e),f;case"[object Symbol]":if(Gh)return Gh.call(e)==Gh.call(t);}return!1}function io(e,t,o,i,n,a){var r=1&o,l=Ot(e),s=l.length,d=Ot(t),f=d.length;if(s!=f&&!r)return!1;for(var u=s,c;u--;)if(c=l[u],r?!(c in t):!Uh.call(t,c))return!1;var p=a.get(e);if(p&&a.get(t))return p==t;var g=!0;a.set(e,t),a.set(t,e);for(var h=r;++u<s;){c=l[u];var m=e[c],x=t[c];if(i)var b=r?i(x,m,c,t,e,a):i(m,x,c,e,t,a);if(void 0===b?!(m===x||n(m,x,o,i,a)):!b){g=!1;break}h||(h="constructor"==c)}if(g&&!h){var _=e.constructor,y=t.constructor;_!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof y&&y instanceof y)&&(g=!1)}return a["delete"](e),a["delete"](t),g}function no(e,t,o,i,n,a){var r=uc(e),l=uc(t),s=r?"[object Array]":Lh(e),d=l?"[object Array]":Lh(t);s="[object Arguments]"==s?"[object Object]":s,d="[object Arguments]"==d?"[object Object]":d;var f="[object Object]"==s,u="[object Object]"==d,c=s==d;if(c&&_p(e)){if(!_p(t))return!1;r=!0,f=!1}if(c&&!f)return a||(a=new Dt),r||wp(e)?Jt(e,t,o,i,n,a):oo(e,t,s,o,i,n,a);if(!(1&o)){var p=f&&Xh.call(e,"__wrapped__"),g=u&&Xh.call(t,"__wrapped__");if(p||g){var h=p?e.value():e,m=g?t.value():t;return a||(a=new Dt),n(h,m,o,i,a)}}return!!c&&(a||(a=new Dt),io(e,t,o,i,n,a))}function ao(e,t,o,i,n){return!(e!==t)||(null!=e&&null!=t&&(s(e)||s(t))?no(e,t,o,i,ao,n):e!==e&&t!==t)}function ro(e,t,o,i){var n=o.length,a=n,r=!i;if(null==e)return!a;for(e=Object(e);n--;){var l=o[n];if(r&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++n<a;){l=o[n];var s=l[0],d=e[s],f=l[1];if(!(r&&l[2])){var u=new Dt;if(i)var c=i(d,f,s,e,t,u);if(void 0===c?!ao(f,d,3,i,u):!c)return!1}else if(void 0===d&&!(s in e))return!1}return!0}function lo(e){return e===e&&!g(e)}function so(e){for(var t=Ne(e),o=t.length;o--;){var i=t[o],n=e[i];t[o]=[i,n,lo(n)]}return t}function fo(e,t){return function(o){return null!=o&&o[e]===t&&(t!==void 0||e in Object(o))}}function uo(e){var t=so(e);return 1==t.length&&t[0][2]?fo(t[0][0],t[0][1]):function(o){return o===e||ro(o,e,t)}}function co(e,t){return null!=e&&t in Object(e)}function po(e,t,o){t=Ye(t,e);for(var i=-1,n=t.length,a=!1,r;++i<n&&(r=Ze(t[i]),!!(a=null!=e&&o(e,r)));)e=e[r];return a||++i!=n?a:(n=null==e?0:e.length,!!n&&Ae(n)&&de(r,n)&&(uc(e)||pp(e)))}function go(e,t){return null!=e&&po(e,t,co)}function ho(e,t){return Oe(e)&&lo(t)?fo(Ze(e),t):function(o){var i=$e(o,e);return i===void 0&&i===t?go(o,e):ao(t,i,3)}}function mo(e){return function(t){return null==t?void 0:t[e]}}function xo(e){return function(t){return Ke(t,e)}}function bo(e){return Oe(e)?mo(Ze(e)):xo(e)}function _o(e){return"function"==typeof e?e:null==e?b:"object"==typeof e?uc(e)?ho(e[0],e[1]):uo(e):bo(e)}function yo(e,t,o){var i=o.length;if(null==e)return!i;for(e=Object(e);i--;){var n=o[i],a=t[n],r=e[n];if(r===void 0&&!(n in e)||!a(r))return!1}return!0}function vo(e){var t=Ne(e);return function(o){return yo(o,e,t)}}function To(e,t,o,i){for(var n=-1,a=null==e?0:e.length;++n<a;){var r=e[n];t(i,r,o(r),e)}return i}function Ao(e){return function(t,o,i){for(var n=-1,a=Object(t),r=i(t),l=r.length;l--;){var s=r[e?l:++n];if(!1===o(a[s],s,a))break}return t}}function Co(e,t){return e&&qh(e,t,Ne)}function Eo(e,t){return function(o,i){if(null==o)return o;if(!Ce(o))return e(o,i);for(var n=o.length,a=t?n:-1,r=Object(o);(t?a--:++a<n)&&!(!1===i(r[a],a,r)););return o}}function Bo(e,t,o,i){return Yh(e,function(e,n,a){t(i,e,o(e),a)}),i}function wo(e,t){return function(o,i){var n=uc(o)?To:Bo,a=t?t():{};return n(o,e,_o(i,2),a)}}function So(e,t,o){t=o?void 0:t;var i=me(e,8,void 0,void 0,void 0,void 0,void 0,t);return i.placeholder=So.placeholder,i}function Lo(e,t,o){t=o?void 0:t;var i=me(e,16,void 0,void 0,void 0,void 0,void 0,t);return i.placeholder=Lo.placeholder,i}function Do(e,t,o){function i(t){var o=b,i=_;return b=_=void 0,c=t,v=e.apply(i,o),v}function n(e){return c=e,T=setTimeout(l,t),p?i(e):v}function a(e){var o=e-A,i=e-c,n=t-o;return m?em(n,y-i):n}function r(e){var o=e-A,i=e-c;return void 0===A||o>=t||0>o||m&&i>=y}function l(){var e=Qh();return r(e)?s(e):void(T=setTimeout(l,a(e)))}function s(e){return(T=void 0,x&&b)?i(e):(b=_=void 0,v)}function d(){void 0!==T&&clearTimeout(T),c=0,b=A=_=T=void 0}function f(){return void 0===T?v:s(Qh())}function u(){var e=Qh(),o=r(e);if(b=arguments,_=this,A=e,o){if(void 0===T)return n(A);if(m)return clearTimeout(T),T=setTimeout(l,t),i(A)}return void 0===T&&(T=setTimeout(l,t)),v}var c=0,p=!1,m=!1,x=!0,b,_,y,v,T,A;if("function"!=typeof e)throw new TypeError("Expected a function");return t=h(t)||0,g(o)&&(p=!!o.leading,m="maxWait"in o,y=m?Jh(h(o.maxWait)||0,t):y,x="trailing"in o?!!o.trailing:x),u.cancel=d,u.flush=f,u}function Io(e,t,o){(o===void 0||_e(e[t],o))&&(o!==void 0||t in e)||be(e,t,o)}function Fo(e){return s(e)&&Ce(e)}function Ro(e,t){return"constructor"===t&&"function"==typeof e[t]||"__proto__"==t?void 0:e[t]}function ko(e){return ye(e,Ve(e))}function No(e,t,o,i,n,a,r){var l=Ro(e,o),s=Ro(t,o),d=r.get(s);if(d)return void Io(e,o,d);var f=a?a(l,s,o+"",e,t,r):void 0,u=f===void 0;if(u){var c=uc(s),p=!c&&_p(s),h=!c&&!p&&wp(s);f=s,c||p||h?uc(l)?f=l:Fo(l)?f=G(l):p?(u=!1,f=Rt(s,!0)):h?(u=!1,f=Xt(s,!0)):f=[]:nt(s)||pp(s)?(f=l,pp(l)?f=ko(l):(!g(l)||_(l))&&(f=Yt(s))):u=!1}u&&(r.set(s,f),n(f,s,i,a,r),r["delete"](s)),Io(e,o,f)}function Mo(e,t,o,i,n){e===t||qh(t,function(a,r){if(n||(n=new Dt),g(a))No(e,t,r,o,Mo,i,n);else{var l=i?i(Ro(e,r),a,r+"",e,t,n):void 0;void 0===l&&(l=a),Io(e,r,l)}},Ve)}function Ho(e,t,o,i,n,a){return g(e)&&g(t)&&(a.set(t,e),Mo(e,t,void 0,Ho,a),a["delete"](t)),e}function Vo(e,t,o){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout(function(){e.apply(void 0,o)},t)}function Oo(e,t,o){for(var i=-1,n=null==e?0:e.length;++i<n;)if(o(t,e[i]))return!0;return!1}function zo(e,t,o,i){var n=-1,a=ie,r=!0,l=e.length,s=[],d=t.length;if(!l)return s;o&&(t=u(t,Ie(o))),i?(a=Oo,r=!1):t.length>=200&&(a=Qt,r=!1,t=new Kt(t));outer:for(;++n<l;){var f=e[n],c=null==o?f:o(f);if(f=i||0!==f?f:0,r&&c===c){for(var p=d;p--;)if(t[p]===c)continue outer;s.push(f)}else a(t,c,i)||s.push(f)}return s}function Po(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}function Go(e,t,o,i){for(var n=e.length,a=i?n:-1;(i?a--:++a<n)&&t(e[a],a,e););return o?dt(e,i?0:a,i?a+1:n):dt(e,i?a+1:0,i?n:a)}function jo(e){return"function"==typeof e?e:b}function Uo(e,t){var o=uc(e)?Q:Yh;return o(e,jo(t))}function Wo(e,t){for(var o=null==e?0:e.length;o--&&!(!1===t(e[o],o,e)););return e}function Xo(e,t){return e&&cm(e,t,Ne)}function qo(e,t){var o=uc(e)?Wo:pm;return o(e,jo(t))}function Yo(e,t){return u(t,function(t){return[t,e[t]]})}function Zo(e){var t=-1,o=Array(e.size);return e.forEach(function(e){o[++t]=[e,e]}),o}function Ko(e){return function(t){var o=Lh(t);return"[object Map]"==o?eo(t):"[object Set]"==o?Zo(t):Yo(t,e(t))}}function $o(e){return e=qe(e),e&&bm.test(e)?e.replace(xm,mm):e}function Qo(e,t){for(var o=-1,i=null==e?0:e.length;++o<i;)if(!t(e[o],o,e))return!1;return!0}function Jo(e,t){var o=!0;return Yh(e,function(e,i,n){return o=!!t(e,i,n),o}),o}function ei(e){return e?Lt(x(e),0,4294967295):0}function ti(e,t,o,i){var n=e.length;for(o=x(o),0>o&&(o=-o>n?0:n+o),i=void 0===i||i>n?n:x(i),0>i&&(i+=n),i=o>i?0:ei(i);o<i;)e[o++]=t;return e}function oi(e,t){var o=[];return Yh(e,function(e,i,n){t(e,i,n)&&o.push(e)}),o}function ii(e){return function(t,o,i){var n=Object(t);if(!Ce(t)){var a=_o(o,3);t=Ne(t),o=function(e){return a(n[e],e,n)}}var r=e(t,o,i);return-1<r?n[a?t[r]:r]:void 0}}function ni(e,t,o){var i=null==e?0:e.length;if(!i)return-1;var n=null==o?0:x(o);return 0>n&&(n=vm(i+n,0)),J(e,_o(t,3),n)}function ai(e,t,o){var i;return o(e,function(e,o,n){if(t(e,o,n))return i=o,!1}),i}function ri(e,t,o){var i=null==e?0:e.length;if(!i)return-1;var n=i-1;return void 0!==o&&(n=x(o),n=0>o?Am(i+n,0):Cm(n,i-1)),J(e,_o(t,3),n,!0)}function li(e){return e&&e.length?e[0]:void 0}function si(e,t){var o=-1,i=Ce(e)?Array(e.length):[];return Yh(e,function(e,n,a){i[++o]=t(e,n,a)}),i}function di(e,t){var o=uc(e)?u:si;return o(e,_o(t,3))}function fi(e,t){return tt(di(e,t),1)}function ui(e){return it(function(t){var o=t.length,i=o,n=P.prototype.thru;for(e&&t.reverse();i--;){var a=t[i];if("function"!=typeof a)throw new TypeError("Expected a function");if(n&&!r&&"wrapper"==z(a))var r=new P([],!0)}for(i=r?i:o;++i<o;){a=t[i];var l=z(a),s="wrapper"==l?Pc(a):void 0;r=s&&W(s[0])&&424==s[1]&&!s[4].length&&1==s[9]?r[z(s[0])].apply(r,s[3]):1==a.length&&W(a)?r[l]():r.thru(a)}return function(){var e=arguments,i=e[0];if(r&&1==e.length&&uc(i))return r.plant(i).value();for(var n=0,a=o?t[n].apply(this,e):i;++n<o;)a=t[n].call(this,a);return a}})}function ci(e,t){return kt(t,function(t){return _(e[t])})}function pi(e,t){return e>t}function gi(e){return function(t,o){return"string"==typeof t&&"string"==typeof o||(t=h(t),o=h(o)),e(t,o)}}function hi(e,t){return null!=e&&km.call(e,t)}function mi(e,t,o){return e>=Mm(t,o)&&e<Nm(t,o)}function xi(e){return"string"==typeof e||!uc(e)&&s(e)&&l(e)=="[object String]"}function bi(e,t){return u(t,function(t){return e[t]})}function _i(e){return null==e?[]:bi(e,Ne(e))}function yi(e,t,o){for(var i=o?Oo:ie,n=e[0].length,a=e.length,r=a,l=Array(a),s=1/0,d=[];r--;){var f=e[r];r&&t&&(f=u(f,Ie(t))),s=Hm(f.length,s),l[r]=!o&&(t||120<=n&&120<=f.length)?new Kt(r&&f):void 0}f=e[0];var c=-1,p=l[0];outer:for(;++c<n&&d.length<s;){var g=f[c],h=t?t(g):g;if(g=o||0!==g?g:0,p?!Qt(p,h):!i(d,h,o)){for(r=a;--r;){var m=l[r];if(m?!Qt(m,h):!i(e[r],h,o))continue outer}p&&p.push(h),d.push(g)}}return d}function vi(e){return Fo(e)?e:[]}function Ti(e,t,o,i){return Co(e,function(e,n,a){t(i,o(e),n,a)}),i}function Ai(e,t){return function(o,i){return Ti(o,e,t(i),{})}}function Ci(e,t){return 2>t.length?e:Ke(e,dt(t,0,-1))}function Ei(e,t,o){t=Ye(t,e),e=Ci(e,t);var i=null==e?e:e[Ze(Po(t))];return null==i?void 0:R(i,e,o)}function Bi(e){if(null==e)return!0;if(Ce(e)&&(uc(e)||"string"==typeof e||"function"==typeof e.splice||_p(e)||wp(e)||pp(e)))return!e.length;var t=Lh(e);if(t=="[object Map]"||t=="[object Set]")return!e.size;if(we(e))return!ke(e).length;for(var o in e)if(tx.call(e,o))return!1;return!0}function wi(e){return"number"==typeof e&&e==x(e)}function Si(e){return"number"==typeof e||s(e)&&l(e)=="[object Number]"}function Li(e){return e===void 0}function Di(e,t,o){for(var i=o+1;i--;)if(e[i]===t)return i;return i}function Ii(e,t){return e<t}function Fi(e,t){var o={};return t=_o(t,3),Co(e,function(e,i,n){be(o,i,t(e,i,n))}),o}function Ri(e,t,o){for(var i=-1,n=e.length;++i<n;){var a=e[i],r=t(a);if(null!=r&&(l===void 0?r===r&&!d(r):o(r,l)))var l=r,s=a}return s}function ki(e,t){for(var o=-1,i=e.length,n;++o<i;){var a=t(e[o]);a!==void 0&&(n=n===void 0?a:n+a)}return n}function Ni(e,t){var o=null==e?0:e.length;return o?ki(e,t)/o:px}function Mi(e,t,o){var i=Ne(t),n=ci(t,i),a=!(g(o)&&"chain"in o)||!!o.chain,r=_(e);return Q(n,function(o){var i=t[o];e[o]=i,r&&(e.prototype[o]=function(){var t=this.__chain__;if(a||t){var o=e(this.__wrapped__),n=o.__actions__=G(this.__actions__);return n.push({func:i,args:arguments,thisArg:e}),o.__chain__=t,o}return i.apply(e,Je([this.value()],arguments))})}),e}function Hi(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2]);}return!e.apply(this,t)}}function Vi(e){for(var t=[],o;!(o=e.next()).done;)t.push(o.value);return t}function Oi(e){if(!e)return[];if(Ce(e))return xi(e)?ht(e):G(e);if(bx&&e[bx])return Vi(e[bx]());var t=Lh(e),o=t=="[object Map]"?eo:t=="[object Set]"?to:_i;return o(e)}function zi(e,t){var o=e.length;if(o)return t+=0>t?o:0,de(t,o)?e[t]:void 0}function Pi(e,t){return t=Ye(t,e),e=Ci(e,t),null==e||delete e[Ze(Po(t))]}function Gi(e){return nt(e)?void 0:e}function ji(e,t,o,n){if(!g(e))return e;t=Ye(t,e);for(var a=-1,r=t.length,l=e;null!=l&&++a<r;){var s=Ze(t[a]),d=o;if(a!=r-1){var f=l[s];d=n?n(f,s,l):void 0,d===void 0&&(d=g(f)?f:de(t[a+1])?[]:{})}i(l,s,d),l=l[s]}return e}function Ui(e,t,o){for(var i=-1,n=t.length,a={};++i<n;){var r=t[i],l=Ke(e,r);o(l,r)&&ji(a,Ye(r,e),l)}return a}function Wi(e,t){if(null==e)return{};var o=u(zt(e),function(e){return[e]});return t=_o(t),Ui(e,o,function(e,o){return t(e,o[0])})}function Xi(e,t){var o=e.length;for(e.sort(t);o--;)e[o]=e[o].value;return e}function qi(e,t){if(e!==t){var o=e!==void 0,i=null===e,n=e===e,a=d(e),r=t!==void 0,l=null===t,s=t===t,f=d(t);if(!l&&!f&&!a&&e>t||a&&r&&s&&!l&&!f||i&&r&&s||!o&&s||!n)return 1;if(!i&&!a&&!f&&e<t||f&&o&&n&&!i&&!a||l&&o&&n||!r&&n||!s)return-1}return 0}function Yi(e,t,o){for(var i=-1,n=e.criteria,a=t.criteria,r=n.length,l=o.length;++i<r;){var s=qi(n[i],a[i]);if(s){if(i>=l)return s;var d=o[i];return s*("desc"==d?-1:1)}}return e.index-t.index}function Zi(e,t,o){var i=-1;t=u(t.length?t:[b],Ie(_o));var n=si(e,function(e){var o=u(t,function(t){return t(e)});return{criteria:o,index:++i,value:e}});return Xi(n,function(e,t){return Yi(e,t,o)})}function Ki(e){return it(function(t){return t=u(t,Ie(_o)),Te(function(o){var i=this;return e(t,function(e){return R(e,i,o)})})})}function $i(e,t){var o="";if(!e||1>t||t>9007199254740991)return o;do t%2&&(o+=e),t=Cx(t/2),t&&(e+=e);while(t);return o}function Qi(e){for(var t=Mx.lastIndex=0;Mx.test(e);)++t;return t}function Ji(e){return ut(e)?Qi(e):Ex(e)}function en(e,t){t=t===void 0?" ":c(t);var o=t.length;if(2>o)return o?$i(t,e):t;var i=$i(t,Hx(e/Ji(t)));return ut(t)?ft(ht(i),0,e).join(""):i.slice(0,e)}function tn(e,t){return Ui(e,t,function(t,o){return go(e,o)})}function on(e,t,o,i){for(var n=o-1,a=e.length;++n<a;)if(i(e[n],t))return n;return-1}function nn(e,t,o,i){var n=i?on:oe,a=-1,r=t.length,l=e;for(e===t&&(t=G(t)),o&&(l=u(e,Ie(o)));++a<r;)for(var s=0,d=t[a],f=o?o(d):d;-1<(s=n(l,f,s,i));)l!==e&&Wx.call(l,s,1),Wx.call(e,s,1);return e}function an(e,t){return e&&e.length&&t&&t.length?nn(e,t):e}function rn(e,t){for(var o=e?t.length:0,i=o-1;o--;){var n=t[o];if(o==i||n!==a){var a=n;de(n)?Yx.call(e,n,1):Pi(e,n)}}return e}function ln(e,t){return e+Kx($x()*(t-e+1))}function sn(e,t,o,i){for(var n=-1,a=tb(eb((t-e)/(o||1)),0),r=Array(a);a--;)r[i?a:++n]=e,e+=o;return r}function dn(e){return function(t,o,i){return i&&"number"!=typeof i&&Ee(t,o,i)&&(o=i=void 0),t=m(t),void 0===o?(o=t,t=0):o=m(o),i=void 0===i?t<o?1:-1:m(i),sn(t,o,i,e)}}function fn(e,t,o,i,n){return n(e,function(e,n,a){o=i?(i=!1,e):t(o,e,n,a)}),o}function un(e,t,o,i){var n=null==e?0:e.length;for(i&&n&&(o=e[--n]);n--;)o=t(o,e[n],n,e);return o}function cn(e){return null==e?e:rb.call(e)}function pn(e){var t=e.length;return t?e[ln(0,t-1)]:void 0}function gn(e){return pn(_i(e))}function hn(e,t){var o=-1,i=e.length;for(t=void 0===t?i:t;++o<t;){var n=ln(o,i-1),a=e[n];e[n]=e[o],e[o]=a}return e.length=t,e}function mn(e,t){return hn(G(e),Lt(t,0,e.length))}function xn(e,t){var o=_i(e);return hn(o,Lt(t,0,o.length))}function bn(e){return hn(G(e))}function _n(e){return hn(_i(e))}function yn(e,t){var o;return Yh(e,function(e,i,n){return o=t(e,i,n),!o}),!!o}function vn(e,t,o,i){t=o(t);for(var n=0,a=null==e?0:e.length,r=t!==t,l=null===t,s=d(t),f=void 0===t;n<a;){var u=fb((n+a)/2),c=o(e[u]),p=c!==void 0,g=null===c,h=c===c,m=d(c);if(r)var x=i||h;else x=f?h&&(i||p):l?h&&p&&(i||!g):s?h&&p&&!g&&(i||!m):!(g||m)&&(i?c<=t:c<t);x?n=u+1:a=u}return ub(a,4294967294)}function Tn(e,t,o){var i=0,n=null==e?i:e.length;if("number"==typeof t&&t===t&&n<=2147483647){for(;i<n;){var a=i+n>>>1,r=e[a];null!==r&&!d(r)&&(o?r<=t:r<t)?i=a+1:n=a}return n}return vn(e,t,b,o)}function An(e,t){for(var o=-1,i=e.length,n=0,a=[];++o<i;){var r=e[o],l=t?t(r):r;if(!o||!_e(l,s)){var s=l;a[n++]=0===r?0:r}}return a}function Cn(e,t,o,i){return void 0===e||_e(e,gb[o])&&!hb.call(i,o)?t:e}function En(e){return"\\"+mb[e]}function Bn(e,t,o){var i=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return g(o)&&(i="leading"in o?!!o.leading:i,n="trailing"in o?!!o.trailing:n),Do(e,t,{leading:i,maxWait:t,trailing:n})}function wn(e,t){return t(e)}function Sn(e,t){var o=e;return o instanceof V&&(o=o.value()),bt(t,function(e,t){return t.func.apply(t.thisArg,Je([e],t.args))},o)}function Ln(){return Sn(this.__wrapped__,this.__actions__)}function Dn(e,t){for(var o=e.length;o--&&-1<oe(t,e[o],0););return o}function In(e,t){for(var o=-1,i=e.length;++o<i&&-1<oe(t,e[o],0););return o}function Fn(e,t){var o=30,i="...";if(g(t)){var n="separator"in t?t.separator:n;o="length"in t?x(t.length):o,i="omission"in t?c(t.omission):i}e=qe(e);var a=e.length;if(ut(e)){var r=ht(e);a=r.length}if(o>=a)return e;var l=o-Ji(i);if(1>l)return i;var s=r?ft(r,0,l).join(""):e.slice(0,l);if(void 0===n)return s+i;if(r&&(l+=s.length-l),ax(n)){if(e.slice(l).search(n)){var d=s,f;for(n.global||(n=RegExp(n.source,qe(Fb.exec(n))+"g")),n.lastIndex=0;f=n.exec(d);)var u=f.index;s=s.slice(0,void 0===u?l:u)}}else if(e.indexOf(c(n),l)!=l){var p=s.lastIndexOf(n);-1<p&&(s=s.slice(0,p))}return s+i}function Rn(e,t,o){var i=-1,n=ie,a=e.length,r=!0,l=[],s=l;if(o)r=!1,n=Oo;else if(a>=200){var d=t?null:Mb(e);if(d)return to(d);r=!1,n=Qt,s=new Kt}else s=t?[]:l;outer:for(;++i<a;){var f=e[i],u=t?t(f):f;if(f=o||0!==f?f:0,r&&u===u){for(var c=s.length;c--;)if(s[c]===u)continue outer;t&&s.push(u),l.push(f)}else n(s,u,o)||(s!==l&&s.push(u),l.push(f))}return l}function kn(e){var t=++zb;return qe(e)+t}function Nn(e){if(!(e&&e.length))return[];var t=0;return e=kt(e,function(e){if(Fo(e))return t=Pb(e.length,t),!0}),Se(t,function(t){return u(e,mo(t))})}function Mn(e,t){if(!(e&&e.length))return[];var o=Nn(e);return null==t?o:u(o,function(e){return R(t,void 0,e)})}function Hn(e,t,o,i){return ji(e,t,o(Ke(e,t)),i)}function Vn(e,t,o){var i=e.length;if(2>i)return i?Rn(e[0]):[];for(var n=-1,a=Array(i);++n<i;)for(var r=e[n],l=-1;++l<i;)l!=n&&(a[n]=zo(a[n]||r,e[l],t,o));return Rn(tt(a,1),t,o)}function On(e,t,o){for(var i=-1,n=e.length,a=t.length,r={};++i<n;){var l=i<a?t[i]:void 0;o(r,e[i],l)}return r}function zn(e,t,o){for(var i=-1,n=o.length;++i<n;){var a=o[i],r=a.size;switch(a.type){case"drop":e+=r;break;case"dropRight":t-=r;break;case"take":t=l_(t,e+r);break;case"takeRight":e=r_(e,t-r);}}return{start:e,end:t}}function Pn(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function Gn(e,t){return t={exports:{}},e(t,t.exports),t.exports}function jn(e){for(var t=e.length;0<=--t;)e[t]=0}function Un(e,t,o,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=o,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}function Wn(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function qn(e){return 256>e?N_[e]:N_[256+(e>>>7)]}function Yn(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=255&t>>>8}function Kn(e,t,o){e.bi_valid>16-o?(e.bi_buf|=65535&t<<e.bi_valid,Yn(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=o-16):(e.bi_buf|=65535&t<<e.bi_valid,e.bi_valid+=o)}function $n(e,t,o){Kn(e,o[2*t],o[2*t+1])}function Qn(e,t){var o=0;do o|=1&e,e>>>=1,o<<=1;while(0<--t);return o>>>1}function Jn(e){16===e.bi_valid?(Yn(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function ea(e,t){var o=t.dyn_tree,i=t.max_code,a=t.stat_desc.static_tree,r=t.stat_desc.has_stree,l=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,d=t.stat_desc.max_length,u=0,c,p,g,x,b,_;for(x=0;x<=15;x++)e.bl_count[x]=0;for(o[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;573>c;c++)(p=e.heap[c],x=o[2*o[2*p+1]+1]+1,x>d&&(x=d,u++),o[2*p+1]=x,!(p>i))&&(e.bl_count[x]++,b=0,p>=s&&(b=l[p-s]),_=o[2*p],e.opt_len+=_*(x+b),r&&(e.static_len+=_*(a[2*p+1]+b)));if(0!==u){do{for(x=d-1;0===e.bl_count[x];)x--;e.bl_count[x]--,e.bl_count[x+1]+=2,e.bl_count[d]--,u-=2}while(0<u);for(x=d;0!==x;x--)for(p=e.bl_count[x];0!==p;)(g=e.heap[--c],!(g>i))&&(o[2*g+1]!==x&&(e.opt_len+=(x-o[2*g+1])*o[2*g],o[2*g+1]=x),p--)}}function ta(e,t,o){var i=Array(16),a=0,r,l;for(r=1;r<=15;r++)i[r]=a=a+o[r-1]<<1;for(l=0;l<=t;l++){var s=e[2*l+1];0!==s&&(e[2*l]=Qn(i[s]++,s))}}function oa(){var e=Array(16),t,o,i,a,r;for(i=0,a=0;a<28;a++)for(H_[a]=i,t=0;t<1<<L_[a];t++)M_[i++]=a;for(M_[i-1]=a,r=0,a=0;16>a;a++)for(V_[a]=r,t=0;t<1<<D_[a];t++)N_[r++]=a;for(r>>=7;a<30;a++)for(V_[a]=r<<7,t=0;t<1<<D_[a]-7;t++)N_[256+r++]=a;for(o=0;o<=15;o++)e[o]=0;for(t=0;143>=t;)R_[2*t+1]=8,t++,e[8]++;for(;255>=t;)R_[2*t+1]=9,t++,e[9]++;for(;279>=t;)R_[2*t+1]=7,t++,e[7]++;for(;287>=t;)R_[2*t+1]=8,t++,e[8]++;for(ta(R_,287,e),t=0;t<30;t++)k_[2*t+1]=5,k_[2*t]=Qn(t,5);W_=new Un(R_,L_,257,286,15),X_=new Un(k_,D_,0,30,15),q_=new Un([],I_,0,19,7)}function ia(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function na(e){8<e.bi_valid?Yn(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function aa(e,t,o,i){na(e),i&&(Yn(e,o),Yn(e,~o)),__.arraySet(e.pending_buf,e.window,t,o,e.pending),e.pending+=o}function ra(e,t,o,i){var n=2*t,a=2*o;return e[n]<e[a]||e[n]===e[a]&&i[t]<=i[o]}function la(e,t,o){for(var i=e.heap[o],n=o<<1;n<=e.heap_len&&(n<e.heap_len&&ra(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!ra(t,i,e.heap[n],e.depth));)e.heap[o]=e.heap[n],o=n,n<<=1;e.heap[o]=i}function sa(e,t,o){var i=0,n,a,r,l;if(0!==e.last_lit)do n=e.pending_buf[e.d_buf+2*i]<<8|e.pending_buf[e.d_buf+2*i+1],a=e.pending_buf[e.l_buf+i],i++,0===n?$n(e,a,t):(r=M_[a],$n(e,r+256+1,t),l=L_[r],0!==l&&(a-=H_[r],Kn(e,a,l)),n--,r=qn(n),$n(e,r,o),l=D_[r],0!==l&&(n-=V_[r],Kn(e,n,l)));while(i<e.last_lit);$n(e,256,t)}function da(e,t){var o=t.dyn_tree,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,r=t.stat_desc.elems,l=-1,s,d,f;for(e.heap_len=0,e.heap_max=573,s=0;s<r;s++)0===o[2*s]?o[2*s+1]=0:(e.heap[++e.heap_len]=l=s,e.depth[s]=0);for(;2>e.heap_len;)f=e.heap[++e.heap_len]=2>l?++l:0,o[2*f]=1,e.depth[f]=0,e.opt_len--,a&&(e.static_len-=i[2*f+1]);for(t.max_code=l,s=e.heap_len>>1;1<=s;s--)la(e,o,s);f=r;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],la(e,o,1),d=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=d,o[2*f]=o[2*s]+o[2*d],e.depth[f]=(e.depth[s]>=e.depth[d]?e.depth[s]:e.depth[d])+1,o[2*s+1]=o[2*d+1]=f,e.heap[1]=f++,la(e,o,1);while(2<=e.heap_len);e.heap[--e.heap_max]=e.heap[1],ea(e,t),ta(o,l,e.bl_count)}function fa(e,t,o){var i=-1,a=t[1],r=0,l=7,s=4,d,f;for(0===a&&(l=138,s=3),t[2*(o+1)+1]=65535,d=0;d<=o;d++){if(f=a,a=t[2*(d+1)+1],++r<l&&f===a)continue;else r<s?e.bl_tree[2*f]+=r:0===f?10>=r?e.bl_tree[34]++:e.bl_tree[36]++:(f!==i&&e.bl_tree[2*f]++,e.bl_tree[32]++);r=0,i=f,0===a?(l=138,s=3):f===a?(l=6,s=3):(l=7,s=4)}}function ua(e,t,o){var i=-1,a=t[1],r=0,l=7,s=4,d,f;for(0===a&&(l=138,s=3),d=0;d<=o;d++){if(f=a,a=t[2*(d+1)+1],++r<l&&f===a)continue;else if(r<s)do $n(e,f,e.bl_tree);while(0!=--r);else 0===f?10>=r?($n(e,17,e.bl_tree),Kn(e,r-3,3)):($n(e,18,e.bl_tree),Kn(e,r-11,7)):(f!==i&&($n(e,f,e.bl_tree),r--),$n(e,16,e.bl_tree),Kn(e,r-3,2));r=0,i=f,0===a?(l=138,s=3):f===a?(l=6,s=3):(l=7,s=4)}}function ca(e){var t;for(fa(e,e.dyn_ltree,e.l_desc.max_code),fa(e,e.dyn_dtree,e.d_desc.max_code),da(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*F_[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function pa(e,t,o,i){var n;for(Kn(e,t-257,5),Kn(e,o-1,5),Kn(e,i-4,4),n=0;n<i;n++)Kn(e,e.bl_tree[2*F_[n]+1],3);ua(e,e.dyn_ltree,t-1),ua(e,e.dyn_dtree,o-1)}function ga(e){var t=4093624447,o;for(o=0;31>=o;o++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*o])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(o=32;o<256;o++)if(0!==e.dyn_ltree[2*o])return 1;return 0}function ha(e){O_||(oa(),O_=!0),e.l_desc=new Wn(e.dyn_ltree,W_),e.d_desc=new Wn(e.dyn_dtree,X_),e.bl_desc=new Wn(e.bl_tree,q_),e.bi_buf=0,e.bi_valid=0,ia(e)}function ma(e,t,o,i){Kn(e,0+(i?1:0),3),aa(e,t,o,!0)}function xa(e,t){return e.msg=U_[t],t}function ba(e){return(e<<1)-(4<e?9:0)}function _a(e){for(var t=e.length;0<=--t;)e[t]=0}function ya(e){var t=e.state,o=t.pending;o>e.avail_out&&(o=e.avail_out);0===o||(__.arraySet(e.output,t.pending_buf,t.pending_out,o,e.next_out),e.next_out+=o,t.pending_out+=o,e.total_out+=o,e.avail_out-=o,t.pending-=o,0===t.pending&&(t.pending_out=0))}function va(e,t){z_._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ya(e.strm)}function Ta(e,t){e.pending_buf[e.pending++]=t}function Aa(e,t){e.pending_buf[e.pending++]=255&t>>>8,e.pending_buf[e.pending++]=255&t}function Ca(e,t,o,i){var n=e.avail_in;return(n>i&&(n=i),0===n)?0:(e.avail_in-=n,__.arraySet(t,e.input,e.next_in,n,o),1===e.state.wrap?e.adler=P_(e.adler,t,n,o):2===e.state.wrap&&(e.adler=j_(e.adler,t,n,o)),e.next_in+=n,e.total_in+=n,n)}function Ea(e,t){var o=e.max_chain_length,i=e.strstart,n=e.prev_length,a=e.nice_match,r=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,l=e.window,s=e.w_mask,d=e.prev,f=e.strstart+258,u=l[i+n-1],c=l[i+n],p,g;e.prev_length>=e.good_match&&(o>>=2),a>e.lookahead&&(a=e.lookahead);do{if(p=t,l[p+n]!==c||l[p+n-1]!==u||l[p]!==l[i]||l[++p]!==l[i+1])continue;i+=2,p++;do;while(l[++i]===l[++p]&&l[++i]===l[++p]&&l[++i]===l[++p]&&l[++i]===l[++p]&&l[++i]===l[++p]&&l[++i]===l[++p]&&l[++i]===l[++p]&&l[++i]===l[++p]&&i<f);if(g=258-(f-i),i=f-258,g>n){if(e.match_start=t,n=g,g>=a)break;u=l[i+n-1],c=l[i+n]}}while((t=d[t&s])>r&&0!=--o);return n<=e.lookahead?n:e.lookahead}function Ba(e){var t=e.w_size,o,i,a,r,l;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-262)){__.arraySet(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,o=i;do a=e.head[--o],e.head[o]=a>=t?a-t:0;while(--i);i=t,o=i;do a=e.prev[--o],e.prev[o]=a>=t?a-t:0;while(--i);r+=t}if(0===e.strm.avail_in)break;if(i=Ca(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=i,3<=e.lookahead+e.insert)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(3>e.lookahead+e.insert)););}while(262>e.lookahead&&0!==e.strm.avail_in)}function wa(e,t){for(var o,i;;){if(262>e.lookahead){if(Ba(e),262>e.lookahead&&0===t)return 1;if(0===e.lookahead)break}if(o=0,3<=e.lookahead&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==o&&e.strstart-o<=e.w_size-262&&(e.match_length=Ea(e,o)),!(3<=e.match_length))i=z_._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;else if(i=z_._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&3<=e.lookahead){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;if(i&&(va(e,!1),0===e.strm.avail_out))return 1}return e.insert=2>e.strstart?e.strstart:2,4===t?(va(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(va(e,!1),0===e.strm.avail_out)?1:2}function Sa(e,t){for(var o,i,n;;){if(262>e.lookahead){if(Ba(e),262>e.lookahead&&0===t)return 1;if(0===e.lookahead)break}if(o=0,3<=e.lookahead&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==o&&e.prev_length<e.max_lazy_match&&e.strstart-o<=e.w_size-262&&(e.match_length=Ea(e,o),5>=e.match_length&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),3<=e.prev_length&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,i=z_._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,o=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(va(e,!1),0===e.strm.avail_out))return 1}else if(!e.match_available)e.match_available=1,e.strstart++,e.lookahead--;else if(i=z_._tr_tally(e,0,e.window[e.strstart-1]),i&&va(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}return e.match_available&&(i=z_._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=2>e.strstart?e.strstart:2,4===t?(va(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(va(e,!1),0===e.strm.avail_out)?1:2}function La(e,t){for(var o=e.window,i,n,a,r;;){if(258>=e.lookahead){if(Ba(e),258>=e.lookahead&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,3<=e.lookahead&&0<e.strstart&&(a=e.strstart-1,n=o[a],n===o[++a]&&n===o[++a]&&n===o[++a])){r=e.strstart+258;do;while(n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&a<r);e.match_length=258-(r-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(3<=e.match_length?(i=z_._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=z_._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(va(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(va(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(va(e,!1),0===e.strm.avail_out)?1:2}function Da(e,t){for(var o;;){if(0===e.lookahead&&(Ba(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,o=z_._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,o&&(va(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(va(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(va(e,!1),0===e.strm.avail_out)?1:2}function Ia(e,t,o,i,n){this.good_length=e,this.max_lazy=t,this.nice_length=o,this.max_chain=i,this.func=n}function Fa(e){e.window_size=2*e.w_size,_a(e.head),e.max_lazy_match=Y_[e.level].max_lazy,e.good_match=Y_[e.level].good_length,e.nice_match=Y_[e.level].nice_length,e.max_chain_length=Y_[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}function Ra(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new __.Buf16(1146),this.dyn_dtree=new __.Buf16(122),this.bl_tree=new __.Buf16(78),_a(this.dyn_ltree),_a(this.dyn_dtree),_a(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new __.Buf16(16),this.heap=new __.Buf16(573),_a(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new __.Buf16(573),_a(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ka(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,t=e.state,t.pending=0,t.pending_out=0,0>t.wrap&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,z_._tr_init(t),0):xa(e,-2)}function Na(e){var t=ka(e);return 0===t&&Fa(e.state),t}function Ma(e,t,o,i,n,a){if(!e)return-2;var r=1;if(-1===t&&(t=6),0>i?(r=0,i=-i):15<i&&(r=2,i-=16),1>n||9<n||8!==o||8>i||15<i||0>t||9<t||0>a||4<a)return xa(e,-2);8===i&&(i=9);var l=new Ra;return e.state=l,l.strm=e,l.wrap=r,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=n+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new __.Buf8(2*l.w_size),l.head=new __.Buf16(l.hash_size),l.prev=new __.Buf16(l.w_size),l.lit_bufsize=1<<n+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new __.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=o,Na(e)}function Ha(e,t){var o,i,n,a;if(!e||!e.state||5<t||0>t)return e?xa(e,-2):-2;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return xa(e,0===e.avail_out?-5:-2);if(i.strm=e,o=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,Ta(i,31),Ta(i,139),Ta(i,8),i.gzhead?(Ta(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Ta(i,255&i.gzhead.time),Ta(i,255&i.gzhead.time>>8),Ta(i,255&i.gzhead.time>>16),Ta(i,255&i.gzhead.time>>24),Ta(i,9===i.level?2:2<=i.strategy||2>i.level?4:0),Ta(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(Ta(i,255&i.gzhead.extra.length),Ta(i,255&i.gzhead.extra.length>>8)),i.gzhead.hcrc&&(e.adler=j_(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(Ta(i,0),Ta(i,0),Ta(i,0),Ta(i,0),Ta(i,0),Ta(i,9===i.level?2:2<=i.strategy||2>i.level?4:0),Ta(i,3),i.status=113);else{var r=8+(i.w_bits-8<<4)<<8,l=-1;l=2<=i.strategy||2>i.level?0:6>i.level?1:6===i.level?2:3,r|=l<<6,0!==i.strstart&&(r|=32),r+=31-r%31,i.status=113,Aa(i,r),0!==i.strstart&&(Aa(i,e.adler>>>16),Aa(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=j_(e.adler,i.pending_buf,i.pending-n,n)),ya(e),n=i.pending,i.pending===i.pending_buf_size));)Ta(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(e.adler=j_(e.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=j_(e.adler,i.pending_buf,i.pending-n,n)),ya(e),n=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,Ta(i,a)}while(0!==a);i.gzhead.hcrc&&i.pending>n&&(e.adler=j_(e.adler,i.pending_buf,i.pending-n,n)),0===a&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=j_(e.adler,i.pending_buf,i.pending-n,n)),ya(e),n=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,Ta(i,a)}while(0!==a);i.gzhead.hcrc&&i.pending>n&&(e.adler=j_(e.adler,i.pending_buf,i.pending-n,n)),0===a&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&ya(e),i.pending+2<=i.pending_buf_size&&(Ta(i,255&e.adler),Ta(i,255&e.adler>>8),e.adler=0,i.status=113)):i.status=113),0!==i.pending){if(ya(e),0===e.avail_out)return i.last_flush=-1,0;}else if(0===e.avail_in&&ba(t)<=ba(o)&&4!==t)return xa(e,-5);if(666===i.status&&0!==e.avail_in)return xa(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var d=2===i.strategy?Da(i,t):3===i.strategy?La(i,t):Y_[i.level].func(i,t);if((3===d||4===d)&&(i.status=666),1===d||3===d)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===d&&(1===t?z_._tr_align(i):5!==t&&(z_._tr_stored_block(i,0,0,!1),3===t&&(_a(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),ya(e),0===e.avail_out))return i.last_flush=-1,0}return 4===t?0>=i.wrap?1:(2===i.wrap?(Ta(i,255&e.adler),Ta(i,255&e.adler>>8),Ta(i,255&e.adler>>16),Ta(i,255&e.adler>>24),Ta(i,255&e.total_in),Ta(i,255&e.total_in>>8),Ta(i,255&e.total_in>>16),Ta(i,255&e.total_in>>24)):(Aa(i,e.adler>>>16),Aa(i,65535&e.adler)),ya(e),0<i.wrap&&(i.wrap=-i.wrap),0===i.pending?1:0):0}function Va(e,t){if(65534>t&&(e.subarray&&$_||!e.subarray&&K_))return Ku.apply(null,__.shrinkBuf(e,t));for(var o="",n=0;n<t;n++)o+=Ku(e[n]);return o}function Oa(e){if(!(this instanceof Oa))return new Oa(e);this.options=__.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&16>t.windowBits&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ty,this.strm.avail_out=0;var o=Z_.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==o)throw new Error(U_[o]);if(t.header&&Z_.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(i="string"==typeof t.dictionary?ey.string2buf(t.dictionary):"[object ArrayBuffer]"===oy.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,o=Z_.deflateSetDictionary(this.strm,i),0!==o)throw new Error(U_[o]);this._dict_set=!0}}function za(e,t){var o=new Oa(t);if(o.push(e,!0),o.err)throw o.msg||U_[o.err];return o.result}function Pa(e){return(255&e>>>24)+(65280&e>>>8)+((65280&e)<<8)+((255&e)<<24)}function Ga(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new __.Buf16(320),this.work=new __.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ja(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new __.Buf32(852),t.distcode=t.distdyn=new __.Buf32(592),t.sane=1,t.back=-1,0):-2}function Ua(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,ja(e)):-2}function Wa(e,t){var o,i;return e&&e.state?(i=e.state,0>t?(o=0,t=-t):(o=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||15<t))?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=o,i.wbits=t,Ua(e)):-2}function Xa(e,t){var o,i;return e?(i=new Ga,e.state=i,i.window=null,o=Wa(e,t),0!==o&&(e.state=null),o):-2}function qa(e){if(yy){var t;for(Ey=new __.Buf32(512),By=new __.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(_y(1,e.lens,0,288,Ey,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;_y(2,e.lens,0,32,By,0,e.work,{bits:5}),yy=!1}e.lencode=Ey,e.lenbits=9,e.distcode=By,e.distbits=5}function Ya(e,t,o,i){var n=e.state,a;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new __.Buf8(n.wsize)),i>=n.wsize?(__.arraySet(n.window,t,o-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):(a=n.wsize-n.wnext,a>i&&(a=i),__.arraySet(n.window,t,o-i,a,n.wnext),i-=a,i?(__.arraySet(n.window,t,o-i,i,0),n.wnext=i,n.whave=n.wsize):(n.wnext+=a,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=a))),0}function Za(e){if(!(this instanceof Za))return new Za(e);this.options=__.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&16>t.windowBits&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),0<=t.windowBits&&16>t.windowBits&&!(e&&e.windowBits)&&(t.windowBits+=32),15<t.windowBits&&48>t.windowBits&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ty,this.strm.avail_out=0;var o=vy.inflateInit2(this.strm,t.windowBits);if(o!==Ty.Z_OK)throw new Error(U_[o]);this.header=new Ay,vy.inflateGetHeader(this.strm,this.header)}function Ka(e,t){var o=new Za(t);if(o.push(e,!0),o.err)throw o.msg||U_[o.err];return o.result}function $a(e){return e.map(function(e){var t=e.color,o=e.offset;return{color:Qa(t),offset:o}})}function Qa(e){if("transparent"===e)return[1,1,1,0];var t=e.match(Fy);if(null===t)throw new Error("'"+e+"' is not a valid RGB color expression.");var o=t[1],i=t[2],n=t[3];return[+o/255,+i/255,+n/255,1]}function Ja(){var e=new Uint8Array([170,187]),t=new Uint16Array(e.buffer);return 48042===t[0]}function er(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var o=e[0];return Array(o).fill(void 0).map(function(e,t){return t})}var i=e[0],o=e[1],n=e[2],a=void 0===n?1:n;if(0===a)throw new Error("Argument step must be nonzero.");for(var r=[],l=i;0<a?l<o:l>o;l+=a)r.push(l);return r}function tr(e,t,i){return o(this,void 0,void 0,function(){return n(this,function(){return[2,new Promise(function(t,o){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.addEventListener("load",function(){t(i.response)}),i.addEventListener("error",o),i.send(null)}).then(function(e){return new Uint8Array(Iy(e).data)}).catch(function(){return Ry(t,i)})]})})}function or(e,t){return[2/e,0,0,0,0,-2/t,0,0,0,0,1,0,-1,1,0,1]}function ir(e){var t=e[0],o=t.x,i=t.y,n=e[1],a=n.x,r=n.y;return[[o,i],[a,i],[o,r],[a,r]]}function nr(e){return new Promise(function(t){return setTimeout(t,e)})}function ar(e,t){var o=e.z-t.z,i=e.x-t.x,n=e.y-t.y;return 0==o?0===i?n:i:o}function rr(e,t){return e.length===t.length&&e.every(function(e,o){return 0===ar(e,t[o])})}function lr(e){return e}function sr(e,t){var o=Object.keys(t).map(function(e){return"#define "+e+" "+t[e]+"\n"}).join("");return o+"\n"+e}function dr(e,t,o,i){return{colorScaleUniforms:Ny(t,e),sentinelValuesUniforms:Ny(i,o),fragMacros:{SCALE_MAX_LENGTH:t,SENTINEL_MAX_LENGTH:i}}}function fr(e,t){return{uniforms:{nodataValue:t,littleEndian:ky,transformMatrix:function(e){var t=e.viewportWidth,o=e.viewportHeight;return or(t,o)}},attributes:{position:function(t,o){var i=o.canvasCoordinates,n=i[0],a=i[1],r=[n+e,a+e],l=r[0],s=r[1];return[[n,a],[l,a],[n,s],[l,s]]}},depth:{enable:!1},primitive:"triangle strip",count:4,viewport:function(e,t){var o=t.canvasSize,i=o[0],n=o[1];return{width:i,height:n}}}}function ur(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoord;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vTexCoord = texCoord;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\n\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform sampler2D texture;\nuniform bool littleEndian;\nuniform bool enableSimpleHillshade;\n\nuniform float textureSize;\nuniform float tileSize;\nuniform vec4 textureBounds;\nvarying vec2 vTexCoord;\n\nuniform float offset;\nuniform float slopescale;\nuniform float slopeFactor;\nuniform float deg2rad;\nuniform float azimuth;\nuniform float altitude;\n\nfloat getTexelValue(vec2 pos) {\n  vec4 texelRgba = texture2D(texture, pos);\n  float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n  return texelFloat;\n}\n\nfloat getRelativeHeight(vec2 pos, float v, vec4 textureBounds) {\n  // if (pos.x < textureBounds[0]) {\n  //   pos = vec2(textureBounds[0], pos.y);\n  // }\n  // if (pos.x > textureBounds[2]) {\n  //   pos = vec2(textureBounds[2], pos.y);\n  // }\n  // if (pos.y < textureBounds[1]) {\n  //   pos = vec2(pos.x, textureBounds[1]);\n  // }\n  // if (pos.y > textureBounds[3]) {\n  //   pos = vec2(pos.x, textureBounds[3]);\n  // }\n  float pixelFloatValue = getTexelValue(pos);\n  float test = step(0.0, pixelFloatValue);\n  float testReturn = ((test * pixelFloatValue) + ((1.0 - test) * v)) * (slopescale*slopeFactor);\n  return testReturn;\n}\n\nfloat hillshade(vec2 pos, float v, float offset, vec4 textureBounds) {\n  float cv = v * (slopescale * slopeFactor);\n  vec4 nv = vec4(\n  getRelativeHeight(vec2(pos.x + offset, pos.y), v, textureBounds),\n  getRelativeHeight(vec2(pos.x - offset, pos.y), v, textureBounds),\n  getRelativeHeight(vec2(pos.x, pos.y + offset), v, textureBounds),\n  getRelativeHeight(vec2(pos.x, pos.y - offset), v, textureBounds)\n  );\n\n  vec2 grad = vec2(\n    (nv[0] - cv) / 2.0 + (cv - nv[1]) / 2.0,\n    (nv[2] - cv) / 2.0 + (cv - nv[3]) / 2.0\n  );\n\n  float slope = max(3.141593 / 2.0 - atan(sqrt(dot(grad, grad))), 0.0);\n  float aspect = atan(-grad.y, grad.x);\n\n  float hs = sin(altitude * deg2rad) * sin(slope) +\n    cos(altitude * deg2rad) * cos(slope) *\n    cos((azimuth * deg2rad) - aspect);\n\n  return clamp(hs, 0.0, 1.0);\n}\n\nvoid main() {\n  float texelFloat = getTexelValue(vTexCoord);\n\n  if (isCloseEnough(texelFloat, nodataValue)) {\n    discard;\n  }\n\n  vec4 clr = computeColor(texelFloat, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n\n  if (enableSimpleHillshade) {\n    float hs = hillshade(vTexCoord, texelFloat, offset, textureBounds);\n    clr.rgb = clr.rgb * hs;\n  }\n\n  gl_FragColor = clr;\n}\n",o.fragMacros),uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},texture:function(e,t){var o=t.texture;return o},enableSimpleHillshade:function(e,t){var o=t.enableSimpleHillshade;return o},offset:0,azimuth:0,altitude:0,slopescale:0,deg2rad:My,slopeFactor:Hy,tileSize:0,textureSize:0,textureBounds:[0,0,0,0]}),attributes:Qu({},t.attributes,{texCoord:function(e,t){var o=t.textureBounds;return ir(o)}})}))}function cr(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoord;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vTexCoord = texCoord;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\n\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform sampler2D texture;\nuniform bool littleEndian;\nuniform bool enableSimpleHillshade;\n\nuniform float textureSize;\nuniform float tileSize;\nuniform vec4 textureBounds;\nvarying vec2 vTexCoord;\n\nuniform float offset;\nuniform float slopescale;\nuniform float slopeFactor;\nuniform float deg2rad;\nuniform float azimuth;\nuniform float altitude;\n\nfloat getTexelValue(vec2 pos) {\n  vec4 texelRgba = texture2D(texture, pos);\n  float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n  return texelFloat;\n}\n\nfloat getRelativeHeight(vec2 pos, float v, vec4 textureBounds) {\n  // if (pos.x < textureBounds[0]) {\n  //   pos = vec2(textureBounds[0], pos.y);\n  // }\n  // if (pos.x > textureBounds[2]) {\n  //   pos = vec2(textureBounds[2], pos.y);\n  // }\n  // if (pos.y < textureBounds[1]) {\n  //   pos = vec2(pos.x, textureBounds[1]);\n  // }\n  // if (pos.y > textureBounds[3]) {\n  //   pos = vec2(pos.x, textureBounds[3]);\n  // }\n  float pixelFloatValue = getTexelValue(pos);\n  float test = step(0.0, pixelFloatValue);\n  float testReturn = ((test * pixelFloatValue) + ((1.0 - test) * v)) * (slopescale*slopeFactor);\n  return testReturn;\n}\n\nfloat hillshade(vec2 pos, float v, float offset, vec4 textureBounds) {\n  float cv = v * (slopescale * slopeFactor);\n  vec4 nv = vec4(\n  getRelativeHeight(vec2(pos.x + offset, pos.y), v, textureBounds),\n  getRelativeHeight(vec2(pos.x - offset, pos.y), v, textureBounds),\n  getRelativeHeight(vec2(pos.x, pos.y + offset), v, textureBounds),\n  getRelativeHeight(vec2(pos.x, pos.y - offset), v, textureBounds)\n  );\n\n  vec2 grad = vec2(\n    (nv[0] - cv) / 2.0 + (cv - nv[1]) / 2.0,\n    (nv[2] - cv) / 2.0 + (cv - nv[3]) / 2.0\n  );\n\n  float slope = max(3.141593 / 2.0 - atan(sqrt(dot(grad, grad))), 0.0);\n  float aspect = atan(-grad.y, grad.x);\n\n  float hs = sin(altitude * deg2rad) * sin(slope) +\n    cos(altitude * deg2rad) * cos(slope) *\n    cos((azimuth * deg2rad) - aspect);\n\n  return clamp(hs, 0.0, 1.0);\n}\n\nvoid main() {\n  float texelFloat = getTexelValue(vTexCoord);\n\n  if (isCloseEnough(texelFloat, nodataValue)) {\n    discard;\n  }\n\n  vec4 clr = computeColor(texelFloat, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n\n  if (enableSimpleHillshade) {\n    float hs = hillshade(vTexCoord, texelFloat, offset, textureBounds);\n    clr.rgb = clr.rgb * hs;\n  }\n\n  gl_FragColor = clr;\n}\n",o.fragMacros),uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},texture:function(e,t){var o=t.texture;return o},enableSimpleHillshade:function(e,t){var o=t.enableSimpleHillshade;return o},azimuth:function(e,t){var o=t.azimuth;return o},altitude:function(e,t){var o=t.altitude;return o},slopescale:function(e,t){var o=t.slopescale;return o},deg2rad:My,slopeFactor:Hy,offset:function(e,t){var o=t.offset;return o},textureBounds:function(e,t){var o=t.textureBounds;return[[o[0].x],[o[0].y],[o[1].x],[o[1].y]]},textureSize:function(e,t){var o=t.textureSize;return o},tileSize:function(e,t){var o=t.tileSize;return o}}),attributes:Qu({},t.attributes,{texCoord:function(e,t){var o=t.textureBounds;return ir(o)}})}))}function pr(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\n// use same coords for all textures?\nattribute vec2 texCoordB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\n\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform sampler2D texture;\nuniform bool littleEndian;\nuniform sampler2D hillshadePregenTexture;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vec4 texelRgba = texture2D(texture, vTexCoordA);\n  float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n\n  if (isCloseEnough(texelFloat, nodataValue)) {\n    discard;\n  }\n\n  vec4 clr = computeColor(texelFloat, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n\n  // Hillshade\n  float l = texture2D(hillshadePregenTexture, vTexCoordB).r;\n  clr.rgb = l * pow(clr.rgb, vec3(2.0));\n  clr.rgb = pow(clr.rgb, vec3(1.0/2.2));\n\n  gl_FragColor = clr;\n}\n",o.fragMacros),uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},texture:function(e,t){var o=t.texture;return o},hillshadePregenTexture:function(e,t){var o=t.hillshadePregenTexture;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBounds;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsHs;return ir(o)}})}))}function gr(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\n// use same coords for all textures?\nattribute vec2 texCoordB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\n\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform bool littleEndian;\nuniform float interpolationFraction;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nbool isSentinelValue(ScaleStop sentinelValues[SENTINEL_MAX_LENGTH], int len, float value) {\n  for (int i = 0; i < SENTINEL_MAX_LENGTH; ++i) {\n    if (i == len) {\n      break;\n    }\n    if (isCloseEnough(sentinelValues[i].offset, value)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nvoid main() {\n  if (interpolationFraction <= 0.0) {\n    vec4 texelRgba = texture2D(textureA, vTexCoordA);\n    float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n    if (isCloseEnough(texelFloat, nodataValue)) {\n      discard;\n    }\n    gl_FragColor = computeColor(texelFloat, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  } else if (interpolationFraction >= 1.0) {\n    vec4 texelRgba = texture2D(textureB, vTexCoordB);\n    float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n    if (isCloseEnough(texelFloat, nodataValue)) {\n      discard;\n    }\n    gl_FragColor = computeColor(texelFloat, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  } else {\n    // retrieve and decode pixel value from both tiles\n    vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n    float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n    vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n    float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n    bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n    bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n    if (aIsNodata && bIsNodata) {\n      discard;\n    } else if (\n      aIsNodata\n      || bIsNodata\n      || colorScaleLength == 0\n      || isSentinelValue(sentinelValues, sentinelValuesLength, texelFloatA)\n      || isSentinelValue(sentinelValues, sentinelValuesLength, texelFloatB)\n    ) {\n      vec4 colorA = (\n        aIsNodata\n        ? TRANSPARENT\n        : computeColor(texelFloatA, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength)\n      );\n      vec4 colorB = (\n        bIsNodata\n        ? TRANSPARENT\n        : computeColor(texelFloatB, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength)\n      );\n      gl_FragColor = mix(colorA, colorB, interpolationFraction);\n    } else {\n      float interpolated = mix(texelFloatA, texelFloatB, interpolationFraction);\n      gl_FragColor = computeColor(interpolated, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n    }\n  }\n}\n",o.fragMacros),uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},interpolationFraction:function(e,t){var o=t.interpolationFraction;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)}})}))}function hr(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoord;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vTexCoord = texCoord;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n// precision highp sampler2D;\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform sampler2D textureA;\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float multiplierA;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoord);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n\n  if (aIsNodata || texelFloatA < filterLowA || texelFloatA > filterHighA) {\n    // TODO: Check if we need to disable filtering\n    // https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/discard.php\n    gl_FragColor = TRANSPARENT;\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA;\n    gl_FragColor = computeColor(texelFloatFinal, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  }\n}\n",o.fragMacros),depth:{enable:!1},uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},textureA:function(e,t){var o=t.textureA;return o}}),attributes:Qu({},t.attributes,{texCoord:function(e,t){var o=t.textureBoundsA;return ir(o)}})}))}function mr(e,t){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoord;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vTexCoord = texCoord;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nprecision highp sampler2D;\n#define GLSLIFY 1\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\nfloat shiftRight (float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shiftLeft (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat maskLast (float v, float bits_0) {\n    return mod(v, shiftLeft(1.0, bits_0));\n}\nfloat extractBits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return maskLast(shiftRight(num, from), to - from);\n}\nvec4 floatToRgba(float texelFloat, bool littleEndian) {\n    if (texelFloat == 0.0) return vec4(0, 0, 0, 0);\n    float sign = texelFloat > 0.0 ? 0.0 : 1.0;\n    texelFloat = abs(texelFloat);\n    float exponent = floor(log2(texelFloat));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((texelFloat / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extractBits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extractBits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extractBits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return (\n      littleEndian\n      ? vec4(byte4, byte3, byte2, byte1)\n      : vec4(byte1, byte2, byte3, byte4)\n    );\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nuniform sampler2D textureA;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float multiplierA;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoord);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n\n  if (aIsNodata || texelFloatA < filterLowA || texelFloatA > filterHighA) {\n    gl_FragColor = floatToRgba(nodataValue, littleEndian);\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA;\n    gl_FragColor = floatToRgba(texelFloatFinal, littleEndian);\n  }\n}\n",depth:{enable:!1},uniforms:Qu({},t.uniforms,{filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},textureA:function(e,t){var o=t.textureA;return o}}),attributes:Qu({},t.attributes,{texCoord:function(e,t){var o=t.textureBoundsA;return ir(o)}})}))}function xr(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\n// use same coords for all textures?\nattribute vec2 texCoordB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n// precision highp sampler2D;\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float multiplierA;\nuniform float multiplierB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n\n  if (aIsNodata || bIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB\n      ) {\n    // TODO: Check if we need to disable filtering\n    // https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/discard.php\n    gl_FragColor = TRANSPARENT;\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB;\n    gl_FragColor = computeColor(texelFloatFinal, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  }\n}\n",o.fragMacros),depth:{enable:!1},uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)}})}))}function br(e,t){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\n// use same coords for all textures?\nattribute vec2 texCoordB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nprecision highp sampler2D;\n#define GLSLIFY 1\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\nfloat shiftRight (float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shiftLeft (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat maskLast (float v, float bits_0) {\n    return mod(v, shiftLeft(1.0, bits_0));\n}\nfloat extractBits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return maskLast(shiftRight(num, from), to - from);\n}\nvec4 floatToRgba(float texelFloat, bool littleEndian) {\n    if (texelFloat == 0.0) return vec4(0, 0, 0, 0);\n    float sign = texelFloat > 0.0 ? 0.0 : 1.0;\n    texelFloat = abs(texelFloat);\n    float exponent = floor(log2(texelFloat));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((texelFloat / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extractBits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extractBits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extractBits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return (\n      littleEndian\n      ? vec4(byte4, byte3, byte2, byte1)\n      : vec4(byte1, byte2, byte3, byte4)\n    );\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float multiplierA;\nuniform float multiplierB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n\n  if (aIsNodata || bIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB\n      ) {\n    gl_FragColor = floatToRgba(nodataValue, littleEndian);\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB;\n    gl_FragColor = floatToRgba(texelFloatFinal, littleEndian);\n  }\n}\n",depth:{enable:!1},uniforms:Qu({},t.uniforms,{filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)}})}))}function _r(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\nattribute vec2 texCoordB;\nattribute vec2 texCoordC;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  vTexCoordC = texCoordC;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n// precision highp float;\n// precision highp sampler2D;\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform sampler2D textureC;\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float filterLowC;\nuniform float filterHighC;\nuniform float multiplierA;\nuniform float multiplierB;\nuniform float multiplierC;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  vec4 texelRgbaC = texture2D(textureC, vTexCoordC);\n  float texelFloatC = rgbaToFloat(texelRgbaC, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n  bool cIsNodata = isCloseEnough(texelFloatC, nodataValue);\n\n  if (aIsNodata || bIsNodata || cIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB ||\n      texelFloatC < filterLowC || texelFloatC > filterHighC\n      ) {\n    // TODO: Check if we need to disable filtering\n    // https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/discard.php\n    gl_FragColor = TRANSPARENT;\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB + texelFloatC * multiplierC;\n    gl_FragColor = computeColor(texelFloatFinal, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  }\n}\n",o.fragMacros),depth:{enable:!1},uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},filterLowC:function(e,t){var o=t.filterLowC;return o},filterHighC:function(e,t){var o=t.filterHighC;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},multiplierC:function(e,t){var o=t.multiplierC;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},textureC:function(e,t){var o=t.textureC;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)},texCoordC:function(e,t){var o=t.textureBoundsC;return ir(o)}})}))}function yr(e,t){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\nattribute vec2 texCoordB;\nattribute vec2 texCoordC;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  vTexCoordC = texCoordC;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nprecision highp sampler2D;\n#define GLSLIFY 1\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\nfloat shiftRight (float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shiftLeft (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat maskLast (float v, float bits_0) {\n    return mod(v, shiftLeft(1.0, bits_0));\n}\nfloat extractBits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return maskLast(shiftRight(num, from), to - from);\n}\nvec4 floatToRgba(float texelFloat, bool littleEndian) {\n    if (texelFloat == 0.0) return vec4(0, 0, 0, 0);\n    float sign = texelFloat > 0.0 ? 0.0 : 1.0;\n    texelFloat = abs(texelFloat);\n    float exponent = floor(log2(texelFloat));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((texelFloat / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extractBits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extractBits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extractBits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return (\n      littleEndian\n      ? vec4(byte4, byte3, byte2, byte1)\n      : vec4(byte1, byte2, byte3, byte4)\n    );\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform sampler2D textureC;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float filterLowC;\nuniform float filterHighC;\nuniform float multiplierA;\nuniform float multiplierB;\nuniform float multiplierC;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  vec4 texelRgbaC = texture2D(textureC, vTexCoordC);\n  float texelFloatC = rgbaToFloat(texelRgbaC, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n  bool cIsNodata = isCloseEnough(texelFloatC, nodataValue);\n\n  if (aIsNodata || bIsNodata || cIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB ||\n      texelFloatC < filterLowC || texelFloatC > filterHighC\n      ) {\n    gl_FragColor = floatToRgba(nodataValue, littleEndian);\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB + texelFloatC * multiplierC;\n    gl_FragColor = floatToRgba(texelFloatFinal, littleEndian);\n  }\n}\n",depth:{enable:!1},uniforms:Qu({},t.uniforms,{filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},filterLowC:function(e,t){var o=t.filterLowC;return o},filterHighC:function(e,t){var o=t.filterHighC;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},multiplierC:function(e,t){var o=t.multiplierC;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},textureC:function(e,t){var o=t.textureC;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)},texCoordC:function(e,t){var o=t.textureBoundsC;return ir(o)}})}))}function vr(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\nattribute vec2 texCoordB;\nattribute vec2 texCoordC;\nattribute vec2 texCoordD;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  vTexCoordC = texCoordC;\n  vTexCoordD = texCoordD;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n// precision highp float;\n// precision highp sampler2D;\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform sampler2D textureC;\nuniform sampler2D textureD;\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float filterLowC;\nuniform float filterHighC;\nuniform float filterLowD;\nuniform float filterHighD;\nuniform float multiplierA;\nuniform float multiplierB;\nuniform float multiplierC;\nuniform float multiplierD;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  vec4 texelRgbaC = texture2D(textureC, vTexCoordC);\n  float texelFloatC = rgbaToFloat(texelRgbaC, littleEndian);\n  vec4 texelRgbaD = texture2D(textureD, vTexCoordD);\n  float texelFloatD = rgbaToFloat(texelRgbaD, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n  bool cIsNodata = isCloseEnough(texelFloatC, nodataValue);\n  bool dIsNodata = isCloseEnough(texelFloatD, nodataValue);\n\n  if (aIsNodata || bIsNodata || cIsNodata || dIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB ||\n      texelFloatC < filterLowC || texelFloatC > filterHighC ||\n      texelFloatD < filterLowD || texelFloatD > filterHighD\n      ) {\n    // TODO: Check if we need to disable filtering\n    // https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/discard.php\n    gl_FragColor = TRANSPARENT;\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB + texelFloatC * multiplierC + texelFloatD * multiplierD;\n    gl_FragColor = computeColor(texelFloatFinal, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  }\n}\n",o.fragMacros),depth:{enable:!1},uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},filterLowC:function(e,t){var o=t.filterLowC;return o},filterHighC:function(e,t){var o=t.filterHighC;return o},filterLowD:function(e,t){var o=t.filterLowD;return o},filterHighD:function(e,t){var o=t.filterHighD;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},multiplierC:function(e,t){var o=t.multiplierC;return o},multiplierD:function(e,t){var o=t.multiplierD;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},textureC:function(e,t){var o=t.textureC;return o},textureD:function(e,t){var o=t.textureD;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)},texCoordC:function(e,t){var o=t.textureBoundsC;return ir(o)},texCoordD:function(e,t){var o=t.textureBoundsD;return ir(o)}})}))}function Tr(e,t){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\nattribute vec2 texCoordB;\nattribute vec2 texCoordC;\nattribute vec2 texCoordD;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  vTexCoordC = texCoordC;\n  vTexCoordD = texCoordD;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nprecision highp sampler2D;\n#define GLSLIFY 1\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\nfloat shiftRight (float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shiftLeft (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat maskLast (float v, float bits_0) {\n    return mod(v, shiftLeft(1.0, bits_0));\n}\nfloat extractBits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return maskLast(shiftRight(num, from), to - from);\n}\nvec4 floatToRgba(float texelFloat, bool littleEndian) {\n    if (texelFloat == 0.0) return vec4(0, 0, 0, 0);\n    float sign = texelFloat > 0.0 ? 0.0 : 1.0;\n    texelFloat = abs(texelFloat);\n    float exponent = floor(log2(texelFloat));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((texelFloat / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extractBits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extractBits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extractBits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return (\n      littleEndian\n      ? vec4(byte4, byte3, byte2, byte1)\n      : vec4(byte1, byte2, byte3, byte4)\n    );\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform sampler2D textureC;\nuniform sampler2D textureD;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float filterLowC;\nuniform float filterHighC;\nuniform float filterLowD;\nuniform float filterHighD;\nuniform float multiplierA;\nuniform float multiplierB;\nuniform float multiplierC;\nuniform float multiplierD;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  vec4 texelRgbaC = texture2D(textureC, vTexCoordC);\n  float texelFloatC = rgbaToFloat(texelRgbaC, littleEndian);\n  vec4 texelRgbaD = texture2D(textureD, vTexCoordD);\n  float texelFloatD = rgbaToFloat(texelRgbaD, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n  bool cIsNodata = isCloseEnough(texelFloatC, nodataValue);\n  bool dIsNodata = isCloseEnough(texelFloatD, nodataValue);\n\n  if (aIsNodata || bIsNodata || cIsNodata || dIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB ||\n      texelFloatC < filterLowC || texelFloatC > filterHighC ||\n      texelFloatD < filterLowD || texelFloatD > filterHighD\n      ) {\n    gl_FragColor = floatToRgba(nodataValue, littleEndian);\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB + texelFloatC * multiplierC + texelFloatD * multiplierD;\n    gl_FragColor = floatToRgba(texelFloatFinal, littleEndian);\n  }\n}\n",depth:{enable:!1},uniforms:Qu({},t.uniforms,{filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},filterLowC:function(e,t){var o=t.filterLowC;return o},filterHighC:function(e,t){var o=t.filterHighC;return o},filterLowD:function(e,t){var o=t.filterLowD;return o},filterHighD:function(e,t){var o=t.filterHighD;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},multiplierC:function(e,t){var o=t.multiplierC;return o},multiplierD:function(e,t){var o=t.multiplierD;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},textureC:function(e,t){var o=t.textureC;return o},textureD:function(e,t){var o=t.textureD;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)},texCoordC:function(e,t){var o=t.textureBoundsC;return ir(o)},texCoordD:function(e,t){var o=t.textureBoundsD;return ir(o)}})}))}function Ar(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\nattribute vec2 texCoordB;\nattribute vec2 texCoordC;\nattribute vec2 texCoordD;\nattribute vec2 texCoordE;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\nvarying vec2 vTexCoordE;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  vTexCoordC = texCoordC;\n  vTexCoordD = texCoordD;\n  vTexCoordE = texCoordE;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform sampler2D textureC;\nuniform sampler2D textureD;\nuniform sampler2D textureE;\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float filterLowC;\nuniform float filterHighC;\nuniform float filterLowD;\nuniform float filterHighD;\nuniform float filterLowE;\nuniform float filterHighE;\nuniform float multiplierA;\nuniform float multiplierB;\nuniform float multiplierC;\nuniform float multiplierD;\nuniform float multiplierE;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\nvarying vec2 vTexCoordE;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  vec4 texelRgbaC = texture2D(textureC, vTexCoordC);\n  float texelFloatC = rgbaToFloat(texelRgbaC, littleEndian);\n  vec4 texelRgbaD = texture2D(textureD, vTexCoordD);\n  float texelFloatD = rgbaToFloat(texelRgbaD, littleEndian);\n  vec4 texelRgbaE = texture2D(textureE, vTexCoordE);\n  float texelFloatE = rgbaToFloat(texelRgbaE, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n  bool cIsNodata = isCloseEnough(texelFloatC, nodataValue);\n  bool dIsNodata = isCloseEnough(texelFloatD, nodataValue);\n  bool eIsNodata = isCloseEnough(texelFloatE, nodataValue);\n\n  if (aIsNodata || bIsNodata || cIsNodata || dIsNodata || eIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB ||\n      texelFloatC < filterLowC || texelFloatC > filterHighC ||\n      texelFloatD < filterLowD || texelFloatD > filterHighD ||\n      texelFloatE < filterLowE || texelFloatE > filterHighE\n      ) {\n    // TODO: Check if we need to disable filtering\n    // https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/discard.php\n    gl_FragColor = TRANSPARENT;\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB + texelFloatC * multiplierC + texelFloatD * multiplierD + texelFloatE * multiplierE;\n    gl_FragColor = computeColor(texelFloatFinal, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  }\n}\n",o.fragMacros),depth:{enable:!1},uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},filterLowC:function(e,t){var o=t.filterLowC;return o},filterHighC:function(e,t){var o=t.filterHighC;return o},filterLowD:function(e,t){var o=t.filterLowD;return o},filterHighD:function(e,t){var o=t.filterHighD;return o},filterLowE:function(e,t){var o=t.filterLowE;return o},filterHighE:function(e,t){var o=t.filterHighE;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},multiplierC:function(e,t){var o=t.multiplierC;return o},multiplierD:function(e,t){var o=t.multiplierD;return o},multiplierE:function(e,t){var o=t.multiplierE;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},textureC:function(e,t){var o=t.textureC;return o},textureD:function(e,t){var o=t.textureD;return o},textureE:function(e,t){var o=t.textureE;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)},texCoordC:function(e,t){var o=t.textureBoundsC;return ir(o)},texCoordD:function(e,t){var o=t.textureBoundsD;return ir(o)},texCoordE:function(e,t){var o=t.textureBoundsE;return ir(o)}})}))}function Cr(e,t){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\nattribute vec2 texCoordB;\nattribute vec2 texCoordC;\nattribute vec2 texCoordD;\nattribute vec2 texCoordE;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\nvarying vec2 vTexCoordE;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  vTexCoordC = texCoordC;\n  vTexCoordD = texCoordD;\n  vTexCoordE = texCoordE;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nprecision highp sampler2D;\n#define GLSLIFY 1\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\nfloat shiftRight (float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shiftLeft (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat maskLast (float v, float bits_0) {\n    return mod(v, shiftLeft(1.0, bits_0));\n}\nfloat extractBits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return maskLast(shiftRight(num, from), to - from);\n}\nvec4 floatToRgba(float texelFloat, bool littleEndian) {\n    if (texelFloat == 0.0) return vec4(0, 0, 0, 0);\n    float sign = texelFloat > 0.0 ? 0.0 : 1.0;\n    texelFloat = abs(texelFloat);\n    float exponent = floor(log2(texelFloat));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((texelFloat / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extractBits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extractBits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extractBits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return (\n      littleEndian\n      ? vec4(byte4, byte3, byte2, byte1)\n      : vec4(byte1, byte2, byte3, byte4)\n    );\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform sampler2D textureC;\nuniform sampler2D textureD;\nuniform sampler2D textureE;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float filterLowC;\nuniform float filterHighC;\nuniform float filterLowD;\nuniform float filterHighD;\nuniform float filterLowE;\nuniform float filterHighE;\nuniform float multiplierA;\nuniform float multiplierB;\nuniform float multiplierC;\nuniform float multiplierD;\nuniform float multiplierE;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\nvarying vec2 vTexCoordE;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  vec4 texelRgbaC = texture2D(textureC, vTexCoordC);\n  float texelFloatC = rgbaToFloat(texelRgbaC, littleEndian);\n  vec4 texelRgbaD = texture2D(textureD, vTexCoordD);\n  float texelFloatD = rgbaToFloat(texelRgbaD, littleEndian);\n  vec4 texelRgbaE = texture2D(textureE, vTexCoordE);\n  float texelFloatE = rgbaToFloat(texelRgbaE, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n  bool cIsNodata = isCloseEnough(texelFloatC, nodataValue);\n  bool dIsNodata = isCloseEnough(texelFloatD, nodataValue);\n  bool eIsNodata = isCloseEnough(texelFloatE, nodataValue);\n\n  if (aIsNodata || bIsNodata || cIsNodata || dIsNodata || eIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB ||\n      texelFloatC < filterLowC || texelFloatC > filterHighC ||\n      texelFloatD < filterLowD || texelFloatD > filterHighD ||\n      texelFloatE < filterLowE || texelFloatE > filterHighE\n      ) {\n    gl_FragColor = floatToRgba(nodataValue, littleEndian);\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB + texelFloatC * multiplierC + texelFloatD * multiplierD + texelFloatE * multiplierE;\n    gl_FragColor = floatToRgba(texelFloatFinal, littleEndian);\n  }\n}\n",depth:{enable:!1},uniforms:Qu({},t.uniforms,{filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},filterLowC:function(e,t){var o=t.filterLowC;return o},filterHighC:function(e,t){var o=t.filterHighC;return o},filterLowD:function(e,t){var o=t.filterLowD;return o},filterHighD:function(e,t){var o=t.filterHighD;return o},filterLowE:function(e,t){var o=t.filterLowE;return o},filterHighE:function(e,t){var o=t.filterHighE;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},multiplierC:function(e,t){var o=t.multiplierC;return o},multiplierD:function(e,t){var o=t.multiplierD;return o},multiplierE:function(e,t){var o=t.multiplierE;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},textureC:function(e,t){var o=t.textureC;return o},textureD:function(e,t){var o=t.textureD;return o},textureE:function(e,t){var o=t.textureE;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)},texCoordC:function(e,t){var o=t.textureBoundsC;return ir(o)},texCoordD:function(e,t){var o=t.textureBoundsD;return ir(o)},texCoordE:function(e,t){var o=t.textureBoundsE;return ir(o)}})}))}function Er(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\nattribute vec2 texCoordB;\nattribute vec2 texCoordC;\nattribute vec2 texCoordD;\nattribute vec2 texCoordE;\nattribute vec2 texCoordF;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\nvarying vec2 vTexCoordE;\nvarying vec2 vTexCoordF;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  vTexCoordC = texCoordC;\n  vTexCoordD = texCoordD;\n  vTexCoordE = texCoordE;\n  vTexCoordE = texCoordF;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform sampler2D textureC;\nuniform sampler2D textureD;\nuniform sampler2D textureE;\nuniform sampler2D textureF;\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float filterLowC;\nuniform float filterHighC;\nuniform float filterLowD;\nuniform float filterHighD;\nuniform float filterLowE;\nuniform float filterHighE;\nuniform float filterLowF;\nuniform float filterHighF;\nuniform float multiplierA;\nuniform float multiplierB;\nuniform float multiplierC;\nuniform float multiplierD;\nuniform float multiplierE;\nuniform float multiplierF;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\nvarying vec2 vTexCoordE;\nvarying vec2 vTexCoordF;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  vec4 texelRgbaC = texture2D(textureC, vTexCoordC);\n  float texelFloatC = rgbaToFloat(texelRgbaC, littleEndian);\n  vec4 texelRgbaD = texture2D(textureD, vTexCoordD);\n  float texelFloatD = rgbaToFloat(texelRgbaD, littleEndian);\n  vec4 texelRgbaE = texture2D(textureE, vTexCoordE);\n  float texelFloatE = rgbaToFloat(texelRgbaE, littleEndian);\n  vec4 texelRgbaF = texture2D(textureF, vTexCoordF);\n  float texelFloatF = rgbaToFloat(texelRgbaF, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n  bool cIsNodata = isCloseEnough(texelFloatC, nodataValue);\n  bool dIsNodata = isCloseEnough(texelFloatD, nodataValue);\n  bool eIsNodata = isCloseEnough(texelFloatE, nodataValue);\n  bool fIsNodata = isCloseEnough(texelFloatF, nodataValue);\n\n  if (aIsNodata || bIsNodata || cIsNodata || dIsNodata || eIsNodata || fIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB ||\n      texelFloatC < filterLowC || texelFloatC > filterHighC ||\n      texelFloatD < filterLowD || texelFloatD > filterHighD ||\n      texelFloatE < filterLowE || texelFloatE > filterHighE ||\n      texelFloatF < filterLowF || texelFloatF > filterHighF\n      ) {\n    // TODO: Check if we need to disable filtering\n    // https://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/discard.php\n    gl_FragColor = TRANSPARENT;\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB + texelFloatC * multiplierC + texelFloatD * multiplierD + texelFloatE * multiplierE + texelFloatF * multiplierF;\n    gl_FragColor = computeColor(texelFloatFinal, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  }\n}\n",o.fragMacros),depth:{enable:!1},uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},filterLowC:function(e,t){var o=t.filterLowC;return o},filterHighC:function(e,t){var o=t.filterHighC;return o},filterLowD:function(e,t){var o=t.filterLowD;return o},filterHighD:function(e,t){var o=t.filterHighD;return o},filterLowE:function(e,t){var o=t.filterLowE;return o},filterHighE:function(e,t){var o=t.filterHighE;return o},filterLowF:function(e,t){var o=t.filterLowF;return o},filterHighF:function(e,t){var o=t.filterHighF;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},multiplierC:function(e,t){var o=t.multiplierC;return o},multiplierD:function(e,t){var o=t.multiplierD;return o},multiplierE:function(e,t){var o=t.multiplierE;return o},multiplierF:function(e,t){var o=t.multiplierF;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},textureC:function(e,t){var o=t.textureC;return o},textureD:function(e,t){var o=t.textureD;return o},textureE:function(e,t){var o=t.textureE;return o},textureF:function(e,t){var o=t.textureF;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)},texCoordC:function(e,t){var o=t.textureBoundsC;return ir(o)},texCoordD:function(e,t){var o=t.textureBoundsD;return ir(o)},texCoordE:function(e,t){var o=t.textureBoundsE;return ir(o)},texCoordF:function(e,t){var o=t.textureBoundsF;return ir(o)}})}))}function Br(e,t){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\nattribute vec2 texCoordB;\nattribute vec2 texCoordC;\nattribute vec2 texCoordD;\nattribute vec2 texCoordE;\nattribute vec2 texCoordF;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\nvarying vec2 vTexCoordE;\nvarying vec2 vTexCoordF;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  vTexCoordC = texCoordC;\n  vTexCoordD = texCoordD;\n  vTexCoordE = texCoordE;\n  vTexCoordE = texCoordF;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nprecision highp sampler2D;\n#define GLSLIFY 1\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\nfloat shiftRight (float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shiftLeft (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat maskLast (float v, float bits_0) {\n    return mod(v, shiftLeft(1.0, bits_0));\n}\nfloat extractBits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return maskLast(shiftRight(num, from), to - from);\n}\nvec4 floatToRgba(float texelFloat, bool littleEndian) {\n    if (texelFloat == 0.0) return vec4(0, 0, 0, 0);\n    float sign = texelFloat > 0.0 ? 0.0 : 1.0;\n    texelFloat = abs(texelFloat);\n    float exponent = floor(log2(texelFloat));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((texelFloat / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extractBits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extractBits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extractBits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return (\n      littleEndian\n      ? vec4(byte4, byte3, byte2, byte1)\n      : vec4(byte1, byte2, byte3, byte4)\n    );\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform sampler2D textureC;\nuniform sampler2D textureD;\nuniform sampler2D textureE;\nuniform sampler2D textureF;\n\nuniform float nodataValue;\nuniform bool littleEndian;\n\nuniform float filterLowA;\nuniform float filterHighA;\nuniform float filterLowB;\nuniform float filterHighB;\nuniform float filterLowC;\nuniform float filterHighC;\nuniform float filterLowD;\nuniform float filterHighD;\nuniform float filterLowE;\nuniform float filterHighE;\nuniform float filterLowF;\nuniform float filterHighF;\nuniform float multiplierA;\nuniform float multiplierB;\nuniform float multiplierC;\nuniform float multiplierD;\nuniform float multiplierE;\nuniform float multiplierF;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\nvarying vec2 vTexCoordC;\nvarying vec2 vTexCoordD;\nvarying vec2 vTexCoordE;\nvarying vec2 vTexCoordF;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  vec4 texelRgbaC = texture2D(textureC, vTexCoordC);\n  float texelFloatC = rgbaToFloat(texelRgbaC, littleEndian);\n  vec4 texelRgbaD = texture2D(textureD, vTexCoordD);\n  float texelFloatD = rgbaToFloat(texelRgbaD, littleEndian);\n  vec4 texelRgbaE = texture2D(textureE, vTexCoordE);\n  float texelFloatE = rgbaToFloat(texelRgbaE, littleEndian);\n  vec4 texelRgbaF = texture2D(textureF, vTexCoordF);\n  float texelFloatF = rgbaToFloat(texelRgbaF, littleEndian);\n\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n  bool cIsNodata = isCloseEnough(texelFloatC, nodataValue);\n  bool dIsNodata = isCloseEnough(texelFloatD, nodataValue);\n  bool eIsNodata = isCloseEnough(texelFloatE, nodataValue);\n  bool fIsNodata = isCloseEnough(texelFloatF, nodataValue);\n\n  if (aIsNodata || bIsNodata || cIsNodata || dIsNodata || eIsNodata || fIsNodata ||\n      texelFloatA < filterLowA || texelFloatA > filterHighA ||\n      texelFloatB < filterLowB || texelFloatB > filterHighB ||\n      texelFloatC < filterLowC || texelFloatC > filterHighC ||\n      texelFloatD < filterLowD || texelFloatD > filterHighD ||\n      texelFloatE < filterLowE || texelFloatE > filterHighE ||\n      texelFloatF < filterLowF || texelFloatF > filterHighF\n      ) {\n    gl_FragColor = floatToRgba(nodataValue, littleEndian);\n  } else {\n    float texelFloatFinal = texelFloatA * multiplierA + texelFloatB * multiplierB + texelFloatC * multiplierC + texelFloatD * multiplierD + texelFloatE * multiplierE + texelFloatF * multiplierF;\n    gl_FragColor = floatToRgba(texelFloatFinal, littleEndian);\n  }\n}\n",depth:{enable:!1},uniforms:Qu({},t.uniforms,{filterLowA:function(e,t){var o=t.filterLowA;return o},filterHighA:function(e,t){var o=t.filterHighA;return o},filterLowB:function(e,t){var o=t.filterLowB;return o},filterHighB:function(e,t){var o=t.filterHighB;return o},filterLowC:function(e,t){var o=t.filterLowC;return o},filterHighC:function(e,t){var o=t.filterHighC;return o},filterLowD:function(e,t){var o=t.filterLowD;return o},filterHighD:function(e,t){var o=t.filterHighD;return o},filterLowE:function(e,t){var o=t.filterLowE;return o},filterHighE:function(e,t){var o=t.filterHighE;return o},filterLowF:function(e,t){var o=t.filterLowF;return o},filterHighF:function(e,t){var o=t.filterHighF;return o},multiplierA:function(e,t){var o=t.multiplierA;return o},multiplierB:function(e,t){var o=t.multiplierB;return o},multiplierC:function(e,t){var o=t.multiplierC;return o},multiplierD:function(e,t){var o=t.multiplierD;return o},multiplierE:function(e,t){var o=t.multiplierE;return o},multiplierF:function(e,t){var o=t.multiplierF;return o},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},textureC:function(e,t){var o=t.textureC;return o},textureD:function(e,t){var o=t.textureD;return o},textureE:function(e,t){var o=t.textureE;return o},textureF:function(e,t){var o=t.textureF;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)},texCoordC:function(e,t){var o=t.textureBoundsC;return ir(o)},texCoordD:function(e,t){var o=t.textureBoundsD;return ir(o)},texCoordE:function(e,t){var o=t.textureBoundsE;return ir(o)},texCoordF:function(e,t){var o=t.textureBoundsF;return ir(o)}})}))}function wr(e,t){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\n// use same coords for all textures?\nattribute vec2 texCoordB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nprecision highp sampler2D;\n#define GLSLIFY 1\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\nfloat shiftRight (float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shiftLeft (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat maskLast (float v, float bits_0) {\n    return mod(v, shiftLeft(1.0, bits_0));\n}\nfloat extractBits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return maskLast(shiftRight(num, from), to - from);\n}\nvec4 floatToRgba(float texelFloat, bool littleEndian) {\n    if (texelFloat == 0.0) return vec4(0, 0, 0, 0);\n    float sign = texelFloat > 0.0 ? 0.0 : 1.0;\n    texelFloat = abs(texelFloat);\n    float exponent = floor(log2(texelFloat));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((texelFloat / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extractBits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extractBits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extractBits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return (\n      littleEndian\n      ? vec4(byte4, byte3, byte2, byte1)\n      : vec4(byte1, byte2, byte3, byte4)\n    );\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nuniform float nodataValue;\nuniform bool littleEndian;\nuniform sampler2D textureA;\nuniform sampler2D textureB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  // vec4 texelRgbaA = texture2D(textureA, vec2(vTexCoordA.x, 1.0 - vTexCoordA.y));\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  // vec4 texelRgbaB = texture2D(textureB, vec2(vTexCoordB.x, 1.0 - vTexCoordB.y));\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n\n  if (aIsNodata || bIsNodata) {\n    gl_FragColor = floatToRgba(nodataValue, littleEndian);\n  } else {\n    float diff = texelFloatB - texelFloatA;\n    gl_FragColor = floatToRgba(diff, littleEndian);\n  }\n}\n",depth:{enable:!1},uniforms:Qu({},t.uniforms,{textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)}})}))}function Sr(e,t,o){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\n// use same coords for all textures?\nattribute vec2 texCoordB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength_0,\n  int sentinelValuesLength_0\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength_0 > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength_0) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength_0 > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength_0) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform ScaleStop colorScale[SCALE_MAX_LENGTH];\nuniform int colorScaleLength;\n\nuniform ScaleStop sentinelValues[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLength;\n\nuniform float nodataValue;\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform bool littleEndian;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n  float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n  vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n  float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n  bool aIsNodata = isCloseEnough(texelFloatA, nodataValue);\n  bool bIsNodata = isCloseEnough(texelFloatB, nodataValue);\n\n  if (aIsNodata || bIsNodata) {\n    gl_FragColor = TRANSPARENT;\n  } else {\n    float diff = texelFloatB - texelFloatA;\n    gl_FragColor = computeColor(diff, colorScale, sentinelValues, colorScaleLength, sentinelValuesLength);\n  }\n}\n",o.fragMacros),depth:{enable:!1},uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,{colorScaleLength:function(e,t){var o=t.colorScale;return o.length},sentinelValuesLength:function(e,t){var o=t.sentinelValues;return o.length},textureA:e.prop("textureA"),textureB:e.prop("textureB")}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)}})}))}function Lr(e,t,o,i){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoordA;\n// use same coords for all textures?\nattribute vec2 texCoordB;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  vTexCoordA = texCoordA;\n  vTexCoordB = texCoordB;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n#define TRANSPARENT vec4(0.0)\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength,\n  int sentinelValuesLength\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform sampler2D textureA;\nuniform ScaleStop colorScaleA[SCALE_MAX_LENGTH];\nuniform int colorScaleLengthA;\nuniform ScaleStop sentinelValuesA[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLengthA;\n\nuniform sampler2D textureB;\nuniform ScaleStop colorScaleB[SCALE_MAX_LENGTH];\nuniform int colorScaleLengthB;\nuniform ScaleStop sentinelValuesB[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLengthB;\n\nuniform float nodataValue;\nuniform bool littleEndian;\nuniform float interpolationFraction;\n\nvarying vec2 vTexCoordA;\nvarying vec2 vTexCoordB;\n\nvoid main() {\n  if (interpolationFraction <= 0.0) {\n    vec4 texelRgba = texture2D(textureA, vTexCoordA);\n    float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n    if (isCloseEnough(texelFloat, nodataValue)) {\n      discard;\n    }\n    gl_FragColor = computeColor(texelFloat, colorScaleA, sentinelValuesA, colorScaleLengthA, sentinelValuesLengthA);\n  } else if (interpolationFraction >= 1.0) {\n    vec4 texelRgba = texture2D(textureB, vTexCoordB);\n    float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n    if (isCloseEnough(texelFloat, nodataValue)) {\n      discard;\n    }\n    gl_FragColor = computeColor(texelFloat, colorScaleB, sentinelValuesB, colorScaleLengthB, sentinelValuesLengthB);\n  } else {\n    vec4 texelRgbaA = texture2D(textureA, vTexCoordA);\n    float texelFloatA = rgbaToFloat(texelRgbaA, littleEndian);\n    vec4 texelRgbaB = texture2D(textureB, vTexCoordB);\n    float texelFloatB = rgbaToFloat(texelRgbaB, littleEndian);\n    vec4 colorA = (\n      isCloseEnough(texelFloatA, nodataValue)\n      ? TRANSPARENT\n      : computeColor(texelFloatA, colorScaleA, sentinelValuesA, colorScaleLengthA, sentinelValuesLengthA)\n    );\n    vec4 colorB = (\n      isCloseEnough(texelFloatB, nodataValue)\n      ? TRANSPARENT\n      : computeColor(texelFloatB, colorScaleB, sentinelValuesB, colorScaleLengthB, sentinelValuesLengthB)\n    );\n    gl_FragColor = mix(colorA, colorB, interpolationFraction);\n  }\n}",o.fragMacros),uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,i.colorScaleUniforms,i.sentinelValuesUniforms,{colorScaleLengthA:function(e,t){var o=t.colorScaleA;return o.length},colorScaleLengthB:function(e,t){var o=t.colorScaleB;return o.length},sentinelValuesLengthA:function(e,t){var o=t.sentinelValuesA;return o.length},sentinelValuesLengthB:function(e,t){var o=t.sentinelValuesB;return o.length},textureA:function(e,t){var o=t.textureA;return o},textureB:function(e,t){var o=t.textureB;return o},interpolationFraction:function(e,t){var o=t.interpolationFraction;return o}}),attributes:Qu({},t.attributes,{texCoordA:function(e,t){var o=t.textureBoundsA;return ir(o)},texCoordB:function(e,t){var o=t.textureBoundsB;return ir(o)}})}))}function Dr(e,t,o,i){return e(Qu({},t,{vert:"#define GLSLIFY 1\nuniform mat4 transformMatrix;\n\nattribute vec2 position;\nattribute vec2 texCoord;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vTexCoord = texCoord;\n  gl_Position = transformMatrix * vec4(position, 0.0, 1.0);\n}\n",frag:sr("#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#endif\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nstruct ScaleStop {\n  float offset;\n  vec4 color;\n};\n\n#ifndef DEFAULT_COLOR\n#define DEFAULT_COLOR vec4(0.0)\n#endif\n\n#ifndef SCALE_MAX_LENGTH\n#define SCALE_MAX_LENGTH 16\n#endif\n\n#ifndef SENTINEL_MAX_LENGTH\n#define SENTINEL_MAX_LENGTH 16\n#endif\n\nvec4 computeColor(\n  float inputVal,\n  ScaleStop colorScale[SCALE_MAX_LENGTH],\n  ScaleStop sentinelValues[SENTINEL_MAX_LENGTH],\n  int colorScaleLength,\n  int sentinelValuesLength\n) {\n  // Compare the value against any sentinel values, if defined.\n  if (sentinelValuesLength > 0) {\n    for (int i_0 = 0; i_0 < SENTINEL_MAX_LENGTH; ++i_0) {\n      if (i_0 == sentinelValuesLength) {\n        break;\n      }\n      ScaleStop sentinel = sentinelValues[i_0];\n      if (isCloseEnough(inputVal, sentinel.offset)) {\n        return sentinel.color;\n      }\n    }\n  }\n\n  // Do linear interpolation using the color scale, if defined.\n  if (colorScaleLength > 0) {\n    // If value below color scale range, clamp to lowest color stop.\n    if (inputVal < colorScale[0].offset) {\n      return colorScale[0].color;\n    } else {\n      for (int i = 0; i < SCALE_MAX_LENGTH; ++i) {\n        // If value above color scale range, clamp to highest color stop.\n        if (i == colorScaleLength) {\n          return colorScale[i - 1].color;\n        } else if (inputVal <= colorScale[i + 1].offset) {\n          float percent = (inputVal - colorScale[i].offset)\n            / (colorScale[i + 1].offset - colorScale[i].offset);\n          return mix(colorScale[i].color, colorScale[i + 1].color, percent);\n        }\n      }\n    }\n  }\n\n  return DEFAULT_COLOR;\n}\n\nuniform sampler2D texture;\n\nuniform ScaleStop colorScaleA[SCALE_MAX_LENGTH];\nuniform int colorScaleLengthA;\nuniform ScaleStop sentinelValuesA[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLengthA;\n\nuniform ScaleStop colorScaleB[SCALE_MAX_LENGTH];\nuniform int colorScaleLengthB;\nuniform ScaleStop sentinelValuesB[SENTINEL_MAX_LENGTH];\nuniform int sentinelValuesLengthB;\n\nuniform float nodataValue;\nuniform bool littleEndian;\nuniform float interpolationFraction;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vec4 texelRgba = texture2D(texture, vTexCoord);\n  float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n\n  if (isCloseEnough(texelFloat, nodataValue)) {\n    discard;\n  }\n\n  if (interpolationFraction <= 0.0) {\n    gl_FragColor = computeColor(texelFloat, colorScaleA, sentinelValuesA, colorScaleLengthA, sentinelValuesLengthA);\n  } else if (interpolationFraction >= 1.0) {\n    gl_FragColor = computeColor(texelFloat, colorScaleB, sentinelValuesB, colorScaleLengthB, sentinelValuesLengthB);\n  } else {\n    vec4 colorA = computeColor(texelFloat, colorScaleA, sentinelValuesA, colorScaleLengthA, sentinelValuesLengthA);\n    vec4 colorB = computeColor(texelFloat, colorScaleB, sentinelValuesB, colorScaleLengthB, sentinelValuesLengthB);\n    gl_FragColor = mix(colorA, colorB, interpolationFraction);\n  }\n}",o.fragMacros),uniforms:Qu({},t.uniforms,o.colorScaleUniforms,o.sentinelValuesUniforms,i.colorScaleUniforms,i.sentinelValuesUniforms,{colorScaleLengthA:function(e,t){var o=t.colorScaleA;return o.length},colorScaleLengthB:function(e,t){var o=t.colorScaleB;return o.length},sentinelValuesLengthA:function(e,t){var o=t.sentinelValuesA;return o.length},sentinelValuesLengthB:function(e,t){var o=t.sentinelValuesB;return o.length},texture:function(e,t){var o=t.texture;return o},interpolationFraction:function(e,t){var o=t.interpolationFraction;return o}}),attributes:Qu({},t.attributes,{texCoord:function(e,t){var o=t.textureBounds;return ir(o)}})}))}function Ir(e,t){return e({vert:"#define GLSLIFY 1\nattribute vec2 position;\nattribute vec2 texCoord;\n\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vTexCoord = texCoord;\n  gl_Position = vec4(position, 0.0, 1.0);\n}\n",frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#define GLSLIFY 1\n#define GLSLIFY 1\n#endif\n\n// Denormalize 8-bit color channels to integers in the range 0 to 255.\nivec4 floatsToBytes(vec4 inputFloats, bool littleEndian) {\n  ivec4 bytes = ivec4(inputFloats * 255.0);\n  return (\n    littleEndian\n    ? bytes.abgr\n    : bytes\n  );\n}\n\n// Break the four bytes down into an array of 32 bits.\nvoid bytesToBits(const in ivec4 bytes, out bool bits[32]) {\n  for (int channelIndex = 0; channelIndex < 4; ++channelIndex) {\n    float acc = float(bytes[channelIndex]);\n    for (int indexInByte = 7; indexInByte >= 0; --indexInByte) {\n      float powerOfTwo = exp2(float(indexInByte));\n      bool bit = acc >= powerOfTwo;\n      bits[channelIndex * 8 + (7 - indexInByte)] = bit;\n      acc = mod(acc, powerOfTwo);\n    }\n  }\n}\n\n// Compute the exponent of the 32-bit float.\nfloat getExponent(bool bits[32]) {\n  const int startIndex = 1;\n  const int bitStringLength = 8;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  float acc = 0.0;\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Compute the mantissa of the 32-bit float.\nfloat getMantissa(bool bits[32], bool subnormal) {\n  const int startIndex = 9;\n  const int bitStringLength = 23;\n  const int endBeforeIndex = startIndex + bitStringLength;\n  // Leading/implicit/hidden bit convention:\n  // If the number is not subnormal (with exponent 0), we add a leading 1 digit.\n  float acc = float(!subnormal) * exp2(float(bitStringLength));\n  int pow2 = bitStringLength - 1;\n  for (int bitIndex = startIndex; bitIndex < endBeforeIndex; ++bitIndex) {\n    acc += float(bits[bitIndex]) * exp2(float(pow2--));\n  }\n  return acc;\n}\n\n// Parse the float from its 32 bits.\nfloat bitsToFloat(bool bits[32]) {\n  float signBit = float(bits[0]) * -2.0 + 1.0;\n  float exponent = getExponent(bits);\n  bool subnormal = abs(exponent - 0.0) < 0.01;\n  float mantissa = getMantissa(bits, subnormal);\n  float exponentBias = 127.0;\n  return signBit * mantissa * exp2(exponent - exponentBias - 23.0);\n}\n\n// Decode a 32-bit float from the RGBA color channels of a texel.\nfloat rgbaToFloat(vec4 texelRGBA, bool littleEndian) {\n  ivec4 rgbaBytes = floatsToBytes(texelRGBA, littleEndian);\n  bool bits[32];\n  bytesToBits(rgbaBytes, bits);\n  return bitsToFloat(bits);\n}\n\nfloat shiftRight (float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shiftLeft (float v, float amt) {\n    return floor(v * exp2(amt) + 0.5);\n}\nfloat maskLast (float v, float bits_0) {\n    return mod(v, shiftLeft(1.0, bits_0));\n}\nfloat extractBits (float num, float from, float to) {\n    from = floor(from + 0.5); to = floor(to + 0.5);\n    return maskLast(shiftRight(num, from), to - from);\n}\nvec4 floatToRgba(float texelFloat, bool littleEndian) {\n    if (texelFloat == 0.0) return vec4(0, 0, 0, 0);\n    float sign = texelFloat > 0.0 ? 0.0 : 1.0;\n    texelFloat = abs(texelFloat);\n    float exponent = floor(log2(texelFloat));\n    float biased_exponent = exponent + 127.0;\n    float fraction = ((texelFloat / exp2(exponent)) - 1.0) * 8388608.0;\n    float t = biased_exponent / 2.0;\n    float last_bit_of_biased_exponent = fract(t) * 2.0;\n    float remaining_bits_of_biased_exponent = floor(t);\n    float byte4 = extractBits(fraction, 0.0, 8.0) / 255.0;\n    float byte3 = extractBits(fraction, 8.0, 16.0) / 255.0;\n    float byte2 = (last_bit_of_biased_exponent * 128.0 + extractBits(fraction, 16.0, 23.0)) / 255.0;\n    float byte1 = (sign * 128.0 + remaining_bits_of_biased_exponent) / 255.0;\n    return (\n      littleEndian\n      ? vec4(byte4, byte3, byte2, byte1)\n      : vec4(byte1, byte2, byte3, byte4)\n    );\n}\n\n#ifndef RELATIVE_TOLERANCE\n#define RELATIVE_TOLERANCE 0.0001\n#endif\n\nbool isCloseEnough(float a, float b) {\n  return abs(a - b) <= max(abs(a), abs(b)) * RELATIVE_TOLERANCE;\n}\n\nuniform sampler2D texture;\nuniform float textureSize;\nuniform bool littleEndian;\nuniform float nodataValue;\nvarying vec2 vTexCoord;\nuniform int kernelSize;\n\nint kernelEnd = int(kernelSize/2);\nint kernelStart = kernelEnd * -1;\n\nfloat getTexelValue(vec2 pos) {\n  vec4 texelRgba = texture2D(texture, pos);\n  float texelFloat = rgbaToFloat(texelRgba, littleEndian);\n  return texelFloat;\n}\n\nfloat runConvKernel(vec2 pos, vec2 onePixel) {\n  float convKernelWeight = 0.0;\n  float sum = 0.0;\n\n  for (int i = -20; i < 20; i ++) {\n    if (i < kernelStart) continue;\n    if (i > kernelEnd) break;\n    for (int j = -20; j < 20; j ++) {\n      if (j < kernelStart) continue;\n      if (j > kernelEnd) break;\n      float texelValue = getTexelValue(pos + onePixel * vec2(i, j));\n      if (!isCloseEnough(texelValue, nodataValue)) {\n        sum = sum + texelValue;\n        convKernelWeight = convKernelWeight + 1.0;\n      }\n    }\n  }\n  return (sum / convKernelWeight);\n}\n\nvoid main() {\n  float texelFloat = getTexelValue(vTexCoord);\n  if (isCloseEnough(texelFloat, nodataValue)) {\n    // gl_FragColor = vec4(nodataValue);\n    gl_FragColor = floatToRgba(nodataValue, littleEndian);\n  } else {\n    vec2 onePixel = vec2(1.0, 1.0) / textureSize;\n    float texelFloatSmoothed = runConvKernel(vTexCoord, onePixel);\n    // gl_FragColor = vec4(texelFloatSmoothed);\n    gl_FragColor = floatToRgba(texelFloatSmoothed, littleEndian);\n  }\n}\n",uniforms:Qu({},t.uniforms,{texture:e.prop("texture"),textureSize:e.prop("textureSize"),kernelSize:e.prop("kernelSize")}),attributes:{texCoord:[0,1,1,1,0,0,1,0],position:[-1,1,1,1,-1,-1,1,-1]},depth:{enable:!1},primitive:"triangle strip",count:4})}function Fr(e){var t=e+="",o=t.indexOf(":");return 0<=o&&"xmlns"!==(t=e.slice(0,o))&&(e=e.slice(o+1)),zy.hasOwnProperty(t)?{space:zy[t],local:e}:e}function Rr(e){return function(){var t=this.ownerDocument,o=this.namespaceURI;return o==="http://www.w3.org/1999/xhtml"&&t.documentElement.namespaceURI==="http://www.w3.org/1999/xhtml"?t.createElement(e):t.createElementNS(o,e)}}function kr(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Nr(e){var t=Fr(e);return(t.local?kr:Rr)(t)}function Mr(){}function Hr(e){return null==e?Mr:function(){return this.querySelector(e)}}function Vr(e){"function"!=typeof e&&(e=Hr(e));for(var t=this._groups,o=t.length,a=Array(o),r=0;r<o;++r)for(var l=t[r],s=l.length,n=a[r]=Array(s),d=0,f,u;d<s;++d)(f=l[d])&&(u=e.call(f,f.__data__,d,l))&&("__data__"in f&&(u.__data__=f.__data__),n[d]=u);return new Ml(a,this._parents)}function Or(){return[]}function zr(e){return null==e?Or:function(){return this.querySelectorAll(e)}}function Pr(e){return function(){return this.matches(e)}}function Gr(e){return Array(e.length)}function jr(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Ur(e){return function(){return e}}function Wr(e,t,o,n,a,r){for(var l=0,s=t.length,d=r.length,f;l<d;++l)(f=t[l])?(f.__data__=r[l],n[l]=f):o[l]=new jr(e,r[l]);for(;l<s;++l)(f=t[l])&&(a[l]=f)}function Xr(e,t,o,n,a,r,l){var s={},d=t.length,f=r.length,u=Array(d),c,p,g;for(c=0;c<d;++c)(p=t[c])&&(u[c]=g="$"+l.call(p,p.__data__,c,t),g in s?a[c]=p:s[g]=p);for(c=0;c<f;++c)g="$"+l.call(e,r[c],c,r),(p=s[g])?(n[c]=p,p.__data__=r[c],s[g]=null):o[c]=new jr(e,r[c]);for(c=0;c<d;++c)(p=t[c])&&s[u[c]]===p&&(a[c]=p)}function qr(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Yr(e){return function(){this.removeAttribute(e)}}function Zr(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Kr(e,t){return function(){this.setAttribute(e,t)}}function $r(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Qr(e,t){return function(){var o=t.apply(this,arguments);null==o?this.removeAttribute(e):this.setAttribute(e,o)}}function Jr(e,t){return function(){var o=t.apply(this,arguments);null==o?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,o)}}function el(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function tl(e){return function(){this.style.removeProperty(e)}}function ol(e,t,o){return function(){this.style.setProperty(e,t,o)}}function il(e,t,o){return function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,o)}}function nl(e,t){return e.style.getPropertyValue(t)||el(e).getComputedStyle(e,null).getPropertyValue(t)}function al(e){return function(){delete this[e]}}function rl(e,t){return function(){this[e]=t}}function ll(e,t){return function(){var o=t.apply(this,arguments);null==o?delete this[e]:this[e]=o}}function sl(e){return e.trim().split(/^|\s+/)}function dl(e){return e.classList||new fl(e)}function fl(e){this._node=e,this._names=sl(e.getAttribute("class")||"")}function ul(e,t){for(var o=dl(e),a=-1,r=t.length;++a<r;)o.add(t[a])}function cl(e,t){for(var o=dl(e),a=-1,r=t.length;++a<r;)o.remove(t[a])}function pl(e){return function(){ul(this,e)}}function gl(e){return function(){cl(this,e)}}function hl(e,t){return function(){(t.apply(this,arguments)?ul:cl)(this,e)}}function ml(){this.textContent=""}function xl(e){return function(){this.textContent=e}}function bl(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function _l(){this.innerHTML=""}function yl(e){return function(){this.innerHTML=e}}function vl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Tl(){this.nextSibling&&this.parentNode.appendChild(this)}function Al(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Cl(){return null}function El(){var e=this.parentNode;e&&e.removeChild(this)}function Bl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wl(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Sl(e,t,o){return e=Ll(e,t,o),function(t){var o=t.relatedTarget;o&&(o===this||8&o.compareDocumentPosition(this))||e.call(this,t)}}function Ll(e,t,o){return function(i){var n=Gy;Gy=i;try{e.call(this,this.__data__,t,o)}finally{Gy=n}}}function Dl(e){return e.trim().split(/^|\s+/).map(function(e){var o="",n=e.indexOf(".");return 0<=n&&(o=e.slice(n+1),e=e.slice(0,n)),{type:e,name:o}})}function Il(e){return function(){var t=this.__on;if(t){for(var n=0,a=-1,r=t.length,l;n<r;++n)(l=t[n],(!e.type||l.type===e.type)&&l.name===e.name)?this.removeEventListener(l.type,l.listener,l.capture):t[++a]=l;++a?t.length=a:delete this.__on}}}function Fl(e,t,n){var a=Py.hasOwnProperty(e.type)?Sl:Ll;return function(r,l,i){var s=this.__on,d=a(t,l,i),f;if(s)for(var u=0,c=s.length;u<c;++u)if((f=s[u]).type===e.type&&f.name===e.name)return this.removeEventListener(f.type,f.listener,f.capture),this.addEventListener(f.type,f.listener=d,f.capture=n),void(f.value=t);this.addEventListener(e.type,d,n),f={type:e.type,name:e.name,value:t,listener:d,capture:n},s?s.push(f):this.__on=[f]}}function Rl(e,t,o){var i=el(e),n=i.CustomEvent;"function"==typeof n?n=new n(t,o):(n=i.document.createEvent("Event"),o?(n.initEvent(t,o.bubbles,o.cancelable),n.detail=o.detail):n.initEvent(t,!1,!1)),e.dispatchEvent(n)}function kl(e,t){return function(){return Rl(this,e,t)}}function Nl(e,t){return function(){return Rl(this,e,t.apply(this,arguments))}}function Ml(e,t){this._groups=e,this._parents=t}function Hl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Vl(e){return function(t,o){return Hl(e(t),o)}}function Ol(e,t,o){var a=-1,r,l,s,d;if(t=+t,e=+e,o=+o,e===t&&0<o)return[e];if((r=t<e)&&(l=e,e=t,t=l),0===(d=zl(e,t,o))||!isFinite(d))return[];if(0<d)for(e=Yu(e/d),t=Xu(t/d),s=Array(l=Yu(t-e+1));++a<l;)s[a]=(e+a)*d;else for(e=Xu(e*d),t=Yu(t*d),s=Array(l=Yu(e-t+1));++a<l;)s[a]=(e-a)/d;return r&&s.reverse(),s}function zl(e,t,o){var i=(t-e)/qu(0,o),n=Xu(Wu(i)/Uu),a=i/ju(10,n);return 0<=n?(a>=qy?10:a>=Yy?5:a>=Zy?2:1)*ju(10,n):-ju(10,-n)/(a>=qy?10:a>=Yy?5:a>=Zy?2:1)}function Pl(e,t,o){var i=Gu(t-e)/qu(0,o),n=ju(10,Xu(Wu(i)/Uu)),a=i/n;return a>=qy?n*=10:a>=Yy?n*=5:a>=Zy&&(n*=2),t<e?-n:n}function Gl(e,t){let o=-1,i=-1,n;if(t===void 0)for(const t of e)++i,null!=t&&(n>t||void 0===n&&t>=t)&&(n=t,o=i);else for(let a of e)null!=(a=t(a,++i,e))&&(n>a||void 0===n&&a>=a)&&(n=a,o=i);return o}function jl(e,t=Hl){if(1===t.length)return Gl(e,t);let o=-1,i=-1,n;for(const a of e)++i,(0>o?0===t(a,a):0>t(a,n))&&(n=a,o=i);return o}function Ul(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);}return this}function Wl(e,t,o){e.prototype=t.prototype=o,o.constructor=e}function Xl(e,t){var o=Object.create(e.prototype);for(var i in t)o[i]=t[i];return o}function ql(){}function Yl(){return this.rgb().formatHex()}function Zl(){return this.rgb().formatRgb()}function Kl(e){var t,o;return e=(e+"").trim().toLowerCase(),(t=tv.exec(e))?(o=t[1].length,t=parseInt(t[1],16),6===o?$l(t):3===o?new ts(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1):8===o?new ts(255&t>>24,255&t>>16,255&t>>8,(255&t)/255):4===o?new ts(15&t>>12|240&t>>8,15&t>>8|240&t>>4,15&t>>4|240&t,((15&t)<<4|15&t)/255):null):(t=ov.exec(e))?new ts(t[1],t[2],t[3],1):(t=iv.exec(e))?new ts(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=nv.exec(e))?Ql(t[1],t[2],t[3],t[4]):(t=av.exec(e))?Ql(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=rv.exec(e))?as(t[1],t[2]/100,t[3]/100,1):(t=lv.exec(e))?as(t[1],t[2]/100,t[3]/100,t[4]):sv.hasOwnProperty(e)?$l(sv[e]):"transparent"===e?new ts(NaN,NaN,NaN,0):null}function $l(e){return new ts(255&e>>16,255&e>>8,255&e,1)}function Ql(e,t,o,i){return 0>=i&&(e=t=o=NaN),new ts(e,t,o,i)}function Jl(e){return(e instanceof ql||(e=Kl(e)),!e)?new ts:(e=e.rgb(),new ts(e.r,e.g,e.b,e.opacity))}function es(e,t,o,i){return 1===arguments.length?Jl(e):new ts(e,t,o,null==i?1:i)}function ts(e,t,o,i){this.r=+e,this.g=+t,this.b=+o,this.opacity=+i}function os(){return"#"+ns(this.r)+ns(this.g)+ns(this.b)}function is(){var e=this.opacity;return e=isNaN(e)?1:qu(0,Zu(1,e)),(1===e?"rgb(":"rgba(")+qu(0,Zu(255,Pu(this.r)||0))+", "+qu(0,Zu(255,Pu(this.g)||0))+", "+qu(0,Zu(255,Pu(this.b)||0))+(1===e?")":", "+e+")")}function ns(e){return e=qu(0,Zu(255,Pu(e)||0)),(16>e?"0":"")+e.toString(16)}function as(e,t,o,i){return 0>=i?e=t=o=NaN:0>=o||1<=o?e=t=NaN:0>=t&&(e=NaN),new ls(e,t,o,i)}function rs(e){if(e instanceof ls)return new ls(e.h,e.s,e.l,e.opacity);if(e instanceof ql||(e=Kl(e)),!e)return new ls;if(e instanceof ls)return e;e=e.rgb();var t=e.r/255,i=e.g/255,n=e.b/255,a=Zu(t,i,n),r=qu(t,i,n),d=NaN,f=r-a,u=(r+a)/2;return f?(d=t===r?(i-n)/f+6*(i<n):i===r?(n-t)/f+2:(t-i)/f+4,f/=.5>u?r+a:2-r-a,d*=60):f=0<u&&1>u?0:d,new ls(d,f,u,e.opacity)}function ls(e,t,o,i){this.h=+e,this.s=+t,this.l=+o,this.opacity=+i}function ss(e,t,o){return 255*(60>e?t+(o-t)*e/60:180>e?o:240>e?t+(o-t)*(240-e)/60:t)}function ds(e){if(e instanceof fs)return new fs(e.l,e.a,e.b,e.opacity);if(e instanceof xs)return bs(e);e instanceof ts||(e=Jl(e));var t=gs(e.r),i=gs(e.g),n=gs(e.b),a=us((.2225045*t+.7168786*i+.0606169*n)/1),r,l;return t===i&&i===n?r=l=a:(r=us((.4360747*t+.3850649*i+.1430804*n)/K),l=us((.0139322*t+.0971045*i+.7141733*n)/Xn)),new fs(116*a-16,500*(r-a),200*(a-l),e.opacity)}function fs(e,t,o,i){this.l=+e,this.a=+t,this.b=+o,this.opacity=+i}function us(e){return e>gv?ju(e,1/3):e/pv+Zn}function cs(e){return e>cv?e*e*e:pv*(e-Zn)}function ps(e){return 255*(.0031308>=e?12.92*e:1.055*ju(e,1/2.4)-.055)}function gs(e){return .04045>=(e/=255)?e/12.92:ju((e+.055)/1.055,2.4)}function hs(e){if(e instanceof xs)return new xs(e.h,e.c,e.l,e.opacity);if(e instanceof fs||(e=ds(e)),0===e.a&&0===e.b)return new xs(NaN,0<e.l&&100>e.l?0:NaN,e.l,e.opacity);var t=zu(e.b,e.a)*fv;return new xs(0>t?t+360:t,Ou(e.a*e.a+e.b*e.b),e.l,e.opacity)}function ms(e,t,o,i){return 1===arguments.length?hs(e):new xs(e,t,o,null==i?1:i)}function xs(e,t,o,i){this.h=+e,this.c=+t,this.l=+o,this.opacity=+i}function bs(e){if(isNaN(e.h))return new fs(e.l,0,0,e.opacity);var t=e.h*dv;return new fs(e.l,Vu(t)*e.c,Hu(t)*e.c,e.opacity)}function _s(e){if(e instanceof ys)return new ys(e.h,e.s,e.l,e.opacity);e instanceof ts||(e=Jl(e));var t=e.r/255,i=e.g/255,n=e.b/255,a=(xv*n+E*t-mv*i)/(xv+E-mv),r=n-a,l=(D*(i-a)-B*r)/C,d=Ou(l*l+r*r)/(D*a*(1-a)),s=d?zu(l,r)*fv-120:NaN;return new ys(0>s?s+360:s,d,a,e.opacity)}function ys(e,t,o,i){this.h=+e,this.s=+t,this.l=+o,this.opacity=+i}function vs(e){return function(){return e}}function Ts(e,o){return function(i){return e+i*o}}function As(e,o,i){return e=ju(e,i),o=ju(o,i)-e,i=1/i,function(n){return ju(e+n*o,i)}}function Cs(e){return 1==(e=+e)?Es:function(t,o){return o-t?As(t,o,e):vs(isNaN(t)?o:t)}}function Es(e,t){var o=t-e;return o?Ts(e,o):vs(isNaN(e)?t:e)}function Bs(e,o){o||(o=[]);var a=e?Zu(o.length,e.length):0,n=o.slice(),r;return function(i){for(r=0;r<a;++r)n[r]=e[r]*(1-i)+o[r]*i;return n}}function ws(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ss(e,t){var o=t?t.length:0,n=e?Zu(o,e.length):0,a=Array(n),r=Array(o),l;for(l=0;l<n;++l)a[l]=Ns(e[l],t[l]);for(;l<o;++l)r[l]=t[l];return function(e){for(l=0;l<n;++l)r[l]=a[l](e);return r}}function Ls(e,o){var i=new Date;return e=+e,o=+o,function(n){return i.setTime(e*(1-n)+o*n),i}}function Ds(e,o){return e=+e,o=+o,function(i){return e*(1-i)+o*i}}function Is(e,t){var o={},i={},n;for(n in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)n in e?o[n]=Ns(e[n],t[n]):i[n]=t[n];return function(e){for(n in o)i[n]=o[n](e);return i}}function Fs(e){return function(){return e}}function Rs(e){return function(o){return e(o)+""}}function ks(e,n){var t=_v.lastIndex=yv.lastIndex=0,o=-1,r=[],l=[],s,d,f;for(e+="",n+="";(s=_v.exec(e))&&(d=yv.exec(n));)(f=d.index)>t&&(f=n.slice(t,f),r[o]?r[o]+=f:r[++o]=f),(s=s[0])===(d=d[0])?r[o]?r[o]+=d:r[++o]=d:(r[++o]=null,l.push({i:o,x:Ds(s,d)})),t=yv.lastIndex;return t<n.length&&(f=n.slice(t),r[o]?r[o]+=f:r[++o]=f),2>r.length?l[0]?Rs(l[0].x):Fs(n):(n=l.length,function(e){for(var t=0,a;t<n;++t)r[(a=l[t]).i]=a.x(e);return r.join("")})}function Ns(e,o){var i=typeof o,t;return null==o||"boolean"==i?vs(o):("number"==i?Ds:"string"==i?(t=Kl(o))?(o=t,bv):ks:o instanceof Kl?bv:o instanceof Date?Ls:ws(o)?Bs:Array.isArray(o)?Ss:"function"!=typeof o.valueOf&&"function"!=typeof o.toString||isNaN(o)?Is:Ds)(e,o)}function Ms(e,o){return e=+e,o=+o,function(i){return Pu(e*(1-i)+o*i)}}function Hs(e){return function(){return e}}function Vs(e){return+e}function Os(e){return e}function zs(e,t){return(t-=e=+e)?function(o){return(o-e)/t}:Hs(isNaN(t)?NaN:.5)}function Ps(e,o){var i;return e>o&&(i=e,e=o,o=i),function(t){return qu(e,Zu(o,t))}}function Gs(e,t,o){var i=e[0],n=e[1],a=t[0],r=t[1];return n<i?(i=zs(n,i),a=o(r,a)):(i=zs(i,n),a=o(a,r)),function(e){return a(i(e))}}function js(e,t,o){var n=Zu(e.length,t.length)-1,a=Array(n),l=Array(n),r=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++r<n;)a[r]=zs(e[r],e[r+1]),l[r]=o(t[r],t[r+1]);return function(t){var o=Xy(e,t,1,n)-1;return l[o](a[o](t))}}function Us(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Ws(){function e(){var e=Zu(o.length,i.length);return a!==Os&&(a=Ps(o[0],o[e-1])),d=2<e?js:Gs,f=u=null,t}function t(e){return isNaN(e=+e)?s:(f||(f=d(o.map(r),i,n)))(r(a(e)))}var o=Av,i=Av,n=Ns,a=Os,r,l,s,d,f,u;return t.invert=function(e){return a(l((u||(u=d(i,o.map(r),Ds)))(e)))},t.domain=function(t){return arguments.length?(o=Array.from(t,Vs),e()):o.slice()},t.range=function(t){return arguments.length?(i=Array.from(t),e()):i.slice()},t.rangeRound=function(t){return i=Array.from(t),n=Ms,e()},t.clamp=function(t){return arguments.length?(a=!!t||Os,e()):a!==Os},t.interpolate=function(t){return arguments.length?(n=t,e()):n},t.unknown=function(e){return arguments.length?(s=e,t):s},function(o,t){return r=o,l=t,e()}}function Xs(){return Ws()(Os,Os)}function qs(e,t){if(0>(n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e")))return null;var o=e.slice(0,n),n;return[1<o.length?o[0]+o.slice(2):o,+e.slice(n+1)]}function Ys(e){return e=qs(Gu(e)),e?e[1]:NaN}function Zs(e,o){return function(n,a){for(var r=n.length,l=[],t=0,s=e[0],d=0;0<r&&0<s&&(d+s+1>a&&(s=qu(1,a-d)),l.push(n.substring(r-=s,r+s)),!((d+=s+1)>a));)s=e[t=(t+1)%e.length];return l.reverse().join(o)}}function Ks(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}function $s(e){if(!(t=Cv.exec(e)))throw new Error("invalid format: "+e);var t;return new Qs({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Qs(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}function Js(e){out:for(var t=e.length,o=1,n=-1,a;o<t;++o)switch(e[o]){case".":n=a=o;break;case"0":0==n&&(n=o),a=o;break;default:if(!+e[o])break out;0<n&&(n=0);}return 0<n?e.slice(0,n)+e.slice(a+1):e}function ed(e,t){var o=qs(e,t);if(!o)return e+"";var i=o[0],n=o[1];return 0>n?"0."+Array(-n).join("0")+i:i.length>n+1?i.slice(0,n+1)+"."+i.slice(n+1):i+Array(n-i.length+2).join("0")}function td(e){return e}function od(e){function t(e){function t(e){var t=v,l=T,g,E,B;if("c"===y)l=A(e)+l,e="";else{e=+e;var w=0>e||0>1/e;if(e=isNaN(e)?d:A(Gu(e),b),_&&(e=Js(e)),w&&0==+e&&"+"!==p&&(w=!1),t=(w?"("===p?p:s:"-"===p||"("===p?"":p)+t,l=("s"===y?Bv[8+wv/3]:"")+l+(w&&"("===p?")":""),C)for(g=-1,E=e.length;++g<E;)if(B=e.charCodeAt(g),48>B||57<B){l=(46===B?a+e.slice(g+1):e.slice(g))+l,e=e.slice(0,g);break}}x&&!h&&(e=o(e,1/0));var S=t.length+e.length+l.length,D=S<m?Array(m-S+1).join(f):"";switch(x&&h&&(e=o(D+e,D.length?m-l.length:1/0),D=""),u){case"<":e=t+e+l+D;break;case"=":e=t+D+e+l;break;case"^":e=D.slice(0,S=D.length>>1)+t+e+l+D.slice(S);break;default:e=D+t+e+l;}return r(e)}e=$s(e);var f=e.fill,u=e.align,p=e.sign,g=e.symbol,h=e.zero,m=e.width,x=e.comma,b=e.precision,_=e.trim,y=e.type;"n"===y?(x=!0,y="g"):!re[y]&&(void 0===b&&(b=12),_=!0,y="g"),(h||"0"===f&&"="===u)&&(h=!0,f="0",u="=");var v="$"===g?i:"#"===g&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",T="$"===g?n:/[%p]/.test(y)?l:"",A=re[y],C=/[defgprs%]/.test(y);return b=void 0===b?6:/[gprs]/.test(y)?qu(1,Zu(21,b)):qu(0,Zu(20,b)),t.toString=function(){return e+""},t}var o=e.grouping===void 0||e.thousands===void 0?td:Zs(Ev.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",r=e.numerals===void 0?td:Ks(Ev.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"-":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";return{format:t,formatPrefix:function(o,i){var n=t((o=$s(o),o.type="f",o)),a=3*qu(-8,Zu(8,Xu(Ys(i)/3))),e=ju(10,-a),r=Bv[8+a/3];return function(t){return n(e*t)+r}}}}function id(e){return Sv=od(e),Lv=Sv.format,Dv=Sv.formatPrefix,Sv}function nd(e){return qu(0,-Ys(Gu(e)))}function ad(e,t){return qu(0,3*qu(-8,Zu(8,Xu(Ys(t)/3)))-Ys(Gu(e)))}function rd(e,t){return e=Gu(e),t=Gu(t)-e,qu(0,Ys(t)-Ys(e))+1}function ld(e,t,o,i){var n=Pl(e,t,o),a;switch(i=$s(null==i?",f":i),i.type){case"s":{var r=qu(Gu(e),Gu(t));return null!=i.precision||isNaN(a=ad(n,r))||(i.precision=a),Dv(i,r)}case"":case"e":case"g":case"p":case"r":{null!=i.precision||isNaN(a=rd(n,qu(Gu(e),Gu(t))))||(i.precision=a-("e"===i.type));break}case"f":case"%":{null!=i.precision||isNaN(a=nd(n))||(i.precision=a-2*("%"===i.type));break}}return Lv(i)}function sd(e){var t=e.domain;return e.ticks=function(e){var o=t();return Ol(o[0],o[o.length-1],null==e?10:e)},e.tickFormat=function(e,o){var i=t();return ld(i[0],i[i.length-1],null==e?10:e,o)},e.nice=function(o){null==o&&(o=10);var i=t(),n=0,a=i.length-1,r=i[n],l=i[a],s;return l<r&&(s=r,r=l,l=s,s=n,n=a,a=s),s=zl(r,l,o),0<s?(r=Xu(r/s)*s,l=Yu(l/s)*s,s=zl(r,l,o)):0>s&&(r=Yu(r*s)/s,l=Xu(l*s)/s,s=zl(r,l,o)),0<s?(i[n]=Xu(r/s)*s,i[a]=Yu(l/s)*s,t(i)):0>s&&(i[n]=Yu(r*s)/s,i[a]=Xu(l*s)/s,t(i)),e},e}function dd(){var e=Xs();return e.copy=function(){return Us(e,dd())},Ul.apply(e,arguments),sd(e)}function fd(e,t,o,i){function n(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return n.floor=function(t){return e(t=new Date(+t)),t},n.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},n.round=function(e){var t=n(e),o=n.ceil(e);return e-t<o-e?t:o},n.offset=function(e,o){return t(e=new Date(+e),null==o?1:Xu(o)),e},n.range=function(o,i,a){var r=[],l;if(o=n.ceil(o),a=null==a?1:Xu(a),!(o<i)||!(0<a))return r;do r.push(l=new Date(+o)),t(o,a),e(o);while(l<o&&o<i);return r},n.filter=function(o){return fd(function(t){if(t>=t)for(;e(t),!o(t);)t.setTime(t-1)},function(e,i){if(e>=e)if(0>i)for(;0>=++i;)for(;t(e,-1),!o(e););else for(;0<=--i;)for(;t(e,1),!o(e););})},o&&(n.count=function(t,i){return Iv.setTime(+t),Fv.setTime(+i),e(Iv),e(Fv),Xu(o(Iv,Fv))},n.every=function(e){return e=Xu(e),isFinite(e)&&0<e?1<e?n.filter(i?function(t){return 0==i(t)%e}:function(t){return 0==n.count(0,t)%e}):n:null}),n}function ud(e){return fd(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*60000)/604800000})}function cd(e){return fd(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/604800000})}function pd(e){if(0<=e.y&&100>e.y){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function gd(e){if(0<=e.y&&100>e.y){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function hd(e,t,o){return{y:e,m:t,d:o,H:0,M:0,S:0,L:0}}function md(e){function t(e,t){return function(o){var a=[],r=-1,l=0,s=e.length,n,d,f;for(o instanceof Date||(o=new Date(+o));++r<s;)37===e.charCodeAt(r)&&(a.push(e.slice(l,r)),null==(d=AT[n=e.charAt(++r)])?d="e"===n?" ":"0":n=e.charAt(++r),(f=t[n])&&(n=f(o,d)),a.push(n),l=r+1);return a.push(e.slice(l,r)),a.join("")}}function o(e,t){return function(o){var a=hd(1900,void 0,1),r=n(a,e,o+="",0),i,l;if(r!=o.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(t&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(1>a.V||53<a.V)return null;"w"in a||(a.w=1),"Z"in a?(i=gd(hd(a.y,0,1)),l=i.getUTCDay(),i=4<l||0===l?cT.ceil(i):cT(i),i=dT.offset(i,7*(a.V-1)),a.y=i.getUTCFullYear(),a.m=i.getUTCMonth(),a.d=i.getUTCDate()+(a.w+6)%7):(i=pd(hd(a.y,0,1)),l=i.getDay(),i=4<l||0===l?Yv.ceil(i):Yv(i),i=Wv.offset(i,7*(a.V-1)),a.y=i.getFullYear(),a.m=i.getMonth(),a.d=i.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),l="Z"in a?gd(hd(a.y,0,1)).getUTCDay():pd(hd(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(l+5)%7:a.w+7*a.U-(l+6)%7);return"Z"in a?(a.H+=0|a.Z/100,a.M+=a.Z%100,gd(a)):pd(a)}}function n(e,t,o,a){for(var r=0,l=t.length,n=o.length,s,d;r<l;){if(a>=n)return-1;if(s=t.charCodeAt(r++),37===s){if(s=t.charAt(r++),d=B[s in AT?t.charAt(r++):s],!d||0>(a=d(e,o,a)))return-1;}else if(s!=o.charCodeAt(a++))return-1}return a}var a=e.dateTime,r=e.date,l=e.time,s=e.periods,f=e.days,u=e.shortDays,c=e.months,p=e.shortMonths,g=_d(s),h=yd(s),m=_d(f),x=yd(f),b=_d(u),_=yd(u),y=_d(c),v=yd(c),T=_d(p),A=yd(p),C={a:function(e){return u[e.getDay()]},A:function(e){return f[e.getDay()]},b:function(e){return p[e.getMonth()]},B:function(e){return c[e.getMonth()]},c:null,d:Pd,e:Pd,f:Xd,H:Gd,I:jd,j:Ud,L:Wd,m:qd,M:Yd,p:function(e){return s[+(12<=e.getHours())]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Af,s:Cf,S:Zd,u:Kd,U:$d,V:Qd,w:Jd,W:ef,x:null,X:null,y:tf,Y:of,Z:nf,"%":Tf},E={a:function(e){return u[e.getUTCDay()]},A:function(e){return f[e.getUTCDay()]},b:function(e){return p[e.getUTCMonth()]},B:function(e){return c[e.getUTCMonth()]},c:null,d:af,e:af,f:ff,H:rf,I:lf,j:sf,L:df,m:uf,M:cf,p:function(e){return s[+(12<=e.getUTCHours())]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Af,s:Cf,S:pf,u:gf,U:hf,V:mf,w:xf,W:bf,x:null,X:null,y:_f,Y:yf,Z:vf,"%":Tf},B={a:function(e,t,o){var i=b.exec(t.slice(o));return i?(e.w=_[i[0].toLowerCase()],o+i[0].length):-1},A:function(e,t,o){var i=m.exec(t.slice(o));return i?(e.w=x[i[0].toLowerCase()],o+i[0].length):-1},b:function(e,t,o){var i=T.exec(t.slice(o));return i?(e.m=A[i[0].toLowerCase()],o+i[0].length):-1},B:function(e,t,o){var i=y.exec(t.slice(o));return i?(e.m=v[i[0].toLowerCase()],o+i[0].length):-1},c:function(e,t,o){return n(e,a,t,o)},d:Id,e:Id,f:Hd,H:Rd,I:Rd,j:Fd,L:Md,m:Dd,M:kd,p:function(e,t,o){var i=g.exec(t.slice(o));return i?(e.p=h[i[0].toLowerCase()],o+i[0].length):-1},q:Ld,Q:Od,s:zd,S:Nd,u:Td,U:Ad,V:Cd,w:vd,W:Ed,x:function(e,t,o){return n(e,r,t,o)},X:function(e,t,o){return n(e,l,t,o)},y:wd,Y:Bd,Z:Sd,"%":Vd};return C.x=t(r,C),C.X=t(l,C),C.c=t(a,C),E.x=t(r,E),E.X=t(l,E),E.c=t(a,E),{format:function(e){var o=t(e+="",C);return o.toString=function(){return e},o},parse:function(e){var t=o(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var o=t(e+="",E);return o.toString=function(){return e},o},utcParse:function(e){var t=o(e+="",!0);return t.toString=function(){return e},t}}}function xd(e,t,o){var i=0>e?"-":"",n=(i?-e:e)+"",a=n.length;return i+(a<o?Array(o-a+1).join(t)+n:n)}function bd(e){return e.replace(BT,"\\$&")}function _d(e){return new RegExp("^(?:"+e.map(bd).join("|")+")","i")}function yd(e){for(var t={},o=-1,a=e.length;++o<a;)t[e[o].toLowerCase()]=o;return t}function vd(e,t,o){var i=CT.exec(t.slice(o,o+1));return i?(e.w=+i[0],o+i[0].length):-1}function Td(e,t,o){var i=CT.exec(t.slice(o,o+1));return i?(e.u=+i[0],o+i[0].length):-1}function Ad(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.U=+i[0],o+i[0].length):-1}function Cd(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.V=+i[0],o+i[0].length):-1}function Ed(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.W=+i[0],o+i[0].length):-1}function Bd(e,t,o){var i=CT.exec(t.slice(o,o+4));return i?(e.y=+i[0],o+i[0].length):-1}function wd(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.y=+i[0]+(68<+i[0]?1900:2e3),o+i[0].length):-1}function Sd(e,t,o){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(o,o+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),o+i[0].length):-1}function Ld(e,t,o){var i=CT.exec(t.slice(o,o+1));return i?(e.q=3*i[0]-3,o+i[0].length):-1}function Dd(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.m=i[0]-1,o+i[0].length):-1}function Id(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.d=+i[0],o+i[0].length):-1}function Fd(e,t,o){var i=CT.exec(t.slice(o,o+3));return i?(e.m=0,e.d=+i[0],o+i[0].length):-1}function Rd(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.H=+i[0],o+i[0].length):-1}function kd(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.M=+i[0],o+i[0].length):-1}function Nd(e,t,o){var i=CT.exec(t.slice(o,o+2));return i?(e.S=+i[0],o+i[0].length):-1}function Md(e,t,o){var i=CT.exec(t.slice(o,o+3));return i?(e.L=+i[0],o+i[0].length):-1}function Hd(e,t,o){var i=CT.exec(t.slice(o,o+6));return i?(e.L=Xu(i[0]/1e3),o+i[0].length):-1}function Vd(e,t,o){var i=ET.exec(t.slice(o,o+1));return i?o+i[0].length:-1}function Od(e,t,o){var i=CT.exec(t.slice(o));return i?(e.Q=+i[0],o+i[0].length):-1}function zd(e,t,o){var i=CT.exec(t.slice(o));return i?(e.s=+i[0],o+i[0].length):-1}function Pd(e,t){return xd(e.getDate(),t,2)}function Gd(e,t){return xd(e.getHours(),t,2)}function jd(e,t){return xd(e.getHours()%12||12,t,2)}function Ud(e,t){return xd(1+Wv.count(iT(e),e),t,3)}function Wd(e,t){return xd(e.getMilliseconds(),t,3)}function Xd(e,t){return Wd(e,t)+"000"}function qd(e,t){return xd(e.getMonth()+1,t,2)}function Yd(e,t){return xd(e.getMinutes(),t,2)}function Zd(e,t){return xd(e.getSeconds(),t,2)}function Kd(e){var t=e.getDay();return 0===t?7:t}function $d(e,t){return xd(qv.count(iT(e)-1,e),t,2)}function Qd(e,t){var o=e.getDay();return e=4<=o||0===o?$v(e):$v.ceil(e),xd($v.count(iT(e),e)+(4===iT(e).getDay()),t,2)}function Jd(e){return e.getDay()}function ef(e,t){return xd(Yv.count(iT(e)-1,e),t,2)}function tf(e,t){return xd(e.getFullYear()%100,t,2)}function of(e,t){return xd(e.getFullYear()%1e4,t,4)}function nf(e){var t=e.getTimezoneOffset();return(0<t?"-":(t*=-1,"+"))+xd(0|t/60,"0",2)+xd(t%60,"0",2)}function af(e,t){return xd(e.getUTCDate(),t,2)}function rf(e,t){return xd(e.getUTCHours(),t,2)}function lf(e,t){return xd(e.getUTCHours()%12||12,t,2)}function sf(e,t){return xd(1+dT.count(vT(e),e),t,3)}function df(e,t){return xd(e.getUTCMilliseconds(),t,3)}function ff(e,t){return df(e,t)+"000"}function uf(e,t){return xd(e.getUTCMonth()+1,t,2)}function cf(e,t){return xd(e.getUTCMinutes(),t,2)}function pf(e,t){return xd(e.getUTCSeconds(),t,2)}function gf(e){var t=e.getUTCDay();return 0===t?7:t}function hf(e,t){return xd(uT.count(vT(e)-1,e),t,2)}function mf(e,t){var o=e.getUTCDay();return e=4<=o||0===o?hT(e):hT.ceil(e),xd(hT.count(vT(e),e)+(4===vT(e).getUTCDay()),t,2)}function xf(e){return e.getUTCDay()}function bf(e,t){return xd(cT.count(vT(e)-1,e),t,2)}function _f(e,t){return xd(e.getUTCFullYear()%100,t,2)}function yf(e,t){return xd(e.getUTCFullYear()%1e4,t,4)}function vf(){return"+0000"}function Tf(){return"%"}function Af(e){return+e}function Cf(e){return Xu(+e/1e3)}function Ef(e){return wT=md(e),ST=wT.format,LT=wT.parse,DT=wT.utcFormat,IT=wT.utcParse,wT}function Bf(){return new wf}function wf(){this.reset()}function Sf(e,t,o){var i=e.s=t+o,n=i-t;e.t=t-(i-n)+(o-n)}function Lf(){}function Df(e,t){e&&HT.hasOwnProperty(e.type)&&HT[e.type](e,t)}function If(e,t,o){var a=-1,r=e.length-o,n;for(t.lineStart();++a<r;)n=e[a],t.point(n[0],n[1],n[2]);t.lineEnd()}function Ff(e,t){var o=-1,a=e.length;for(t.polygonStart();++o<a;)If(e[o],t,1);t.polygonEnd()}function Rf(e,t){e&&MT.hasOwnProperty(e.type)?MT[e.type](e,t):Df(e,t)}function kf(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Nf(e){return function(t,o){return kf(e(t),o)}}function Mf(e){return e}function Hf(){XT.point=Vf}function Vf(e,t){XT.point=Of,sA=fA=e,dA=uA=t}function Of(e,t){WT.add(uA*e-fA*t),fA=e,uA=t}function zf(){Of(sA,dA)}function Pf(e,t){e<qT&&(qT=e),e>ZT&&(ZT=e),t<YT&&(YT=t),t>KT&&(KT=t)}function Gf(e,t){QT+=e,JT+=t,++eA}function jf(){lA.point=Uf}function Uf(e,t){lA.point=Wf,Gf(gA=e,hA=t)}function Wf(e,t){var o=e-gA,i=t-hA,n=NT(o*o+i*i);tA+=n*(gA+e)/2,oA+=n*(hA+t)/2,iA+=n,Gf(gA=e,hA=t)}function Xf(){lA.point=Gf}function qf(){lA.point=Zf}function Yf(){Kf(cA,pA)}function Zf(e,t){lA.point=Kf,Gf(cA=gA=e,pA=hA=t)}function Kf(e,t){var o=e-gA,i=t-hA,n=NT(o*o+i*i);tA+=n*(gA+e)/2,oA+=n*(hA+t)/2,iA+=n,n=hA*e-gA*t,nA+=n*(gA+e),aA+=n*(hA+t),rA+=3*n,Gf(gA=e,hA=t)}function $f(e){this._context=e}function Qf(e,t){xA.point=Jf,_A=vA=e,yA=TA=t}function Jf(e,t){vA-=e,TA-=t,mA.add(NT(vA*vA+TA*TA)),vA=e,TA=t}function eu(){this._string=[]}function tu(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function ou(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function iu(e){return function(t,o){return ou(e(t),o)}}function nu(e,t){var o=e.length,n=-1,a,r,l;if(null==t){for(;++n<o;)if(null!=(a=e[n])&&a>=a)for(r=l=a;++n<o;)null!=(a=e[n])&&(r>a&&(r=a),l<a&&(l=a));}else for(;++n<o;)if(null!=(a=t(e[n],n,e))&&a>=a)for(r=l=a;++n<o;)null!=(a=t(e[n],n,e))&&(r>a&&(r=a),l<a&&(l=a));return[r,l]}function au(e,t,o){e=+e,t=+t,o=2>(r=arguments.length)?(t=e,e=0,1):3>r?1:+o;for(var a=-1,r=0|qu(0,Yu((t-e)/o)),l=Array(r);++a<r;)l[a]=e+a*o;return l}function ru(e,t,o){var i=Gu(t-e)/qu(0,o),n=ju(10,Xu(Wu(i)/Uu)),a=i/n;return a>=CA?n*=10:a>=EA?n*=5:a>=BA&&(n*=2),t<e?-n:n}function lu(e){return Yu(Wu(e.length)/Math.LN2)+1}function su(e,t){return e-t}function du(e){for(var t=0,o=e.length,n=e[o-1][1]*e[0][0]-e[o-1][0]*e[0][1];++t<o;)n+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return n}function fu(e){return function(){return e}}function uu(e,t){for(var o=-1,a=t.length,n;++o<a;)if(n=cu(e,t[o]))return n;return 0}function cu(e,t){for(var o=t[0],a=t[1],r=-1,l=0,s=e.length,n=s-1;l<s;n=l++){var d=e[l],f=d[0],u=d[1],c=e[n],p=c[0],g=c[1];if(pu(d,c,t))return 0;u>a!=g>a&&o<(p-f)*(a-u)/(g-u)+f&&(r=-r)}return r}function pu(e,t,o){var n;return gu(e,t,o)&&hu(e[n=+(e[0]===t[0])],o[n],t[n])}function gu(e,t,o){return(t[0]-e[0])*(o[1]-e[1])==(o[0]-e[0])*(t[1]-e[1])}function hu(e,t,o){return e<=t&&t<=o||o<=t&&t<=e}function mu(){}function xu(){function e(e){var o=l(e);if(!Array.isArray(o)){var i=nu(e),n=i[0],a=i[1];o=ru(n,a,o),o=au(Xu(n/o)*o,Xu(a/o)*o,o)}else o=o.slice().sort(su);return o.map(function(o){return t(e,o)})}function t(e,t){var a=[],r=[];return o(e,t,function(o){s(o,e,t),0<du(o)?a.push([o]):r.push(o)}),r.forEach(function(e){for(var t=0,o=a.length,n;t<o;++t)if(-1!==uu((n=a[t])[0],e))return void n.push(e)}),{type:"MultiPolygon",value:t,coordinates:a}}function o(e,t,o){function n(e){var t=[e[0][0]+d,e[0][1]+u],n=[e[1][0]+d,e[1][1]+u],a=i(t),r=i(n),c,p;(c=s[a])?(p=l[r])?(delete s[c.end],delete l[p.start],c===p?(c.ring.push(n),o(c.ring)):l[c.start]=s[p.end]={start:c.start,end:p.end,ring:c.ring.concat(p.ring)}):(delete s[c.end],c.ring.push(n),s[c.end=r]=c):(c=l[r])?(p=s[a])?(delete l[c.start],delete s[p.end],c===p?(c.ring.push(n),o(c.ring)):l[p.start]=s[c.end]={start:p.start,end:c.end,ring:p.ring.concat(c.ring)}):(delete l[c.start],c.ring.unshift(t),l[c.start=a]=c):l[a]=s[r]={start:a,end:r,ring:[t,n]}}var l=[],s=[],d,u,f,c,p,g;for(d=u=-1,c=e[0]>=t,LA[c<<1].forEach(n);++d<a-1;)f=c,c=e[d+1]>=t,LA[f|c<<1].forEach(n);for(LA[c<<0].forEach(n);++u<r-1;){for(d=-1,c=e[u*a+a]>=t,p=e[u*a]>=t,LA[c<<1|p<<2].forEach(n);++d<a-1;)f=c,c=e[u*a+a+d+1]>=t,g=p,p=e[u*a+d+1]>=t,LA[f|c<<1|p<<2|g<<3].forEach(n);LA[c|p<<3].forEach(n)}for(d=-1,p=e[u*a]>=t,LA[p<<2].forEach(n);++d<a-1;)g=p,p=e[u*a+d+1]>=t,LA[p<<2|g<<3].forEach(n);LA[p<<3].forEach(n)}function i(e){return 2*e[0]+4*(e[1]*(a+1))}function n(e,t,o){e.forEach(function(e){var i=e[0],n=e[1],l=0|i,s=0|n,d=t[s*a+l],f;0<i&&i<a&&l===i&&(f=t[s*a+l-1],e[0]=i+(o-f)/(d-f)-.5),0<n&&n<r&&s===n&&(f=t[(s-1)*a+l],e[1]=n+(o-f)/(d-f)-.5)})}var a=1,r=1,l=lu,s=n;return e.contour=t,e.size=function(t){if(!arguments.length)return[a,r];var o=Yu(t[0]),i=Yu(t[1]);if(!(0<o)||!(0<i))throw new Error("invalid size");return a=o,r=i,e},e.thresholds=function(t){return arguments.length?(l="function"==typeof t?t:Array.isArray(t)?fu(SA.call(t)):fu(t),e):l},e.smooth=function(t){return arguments.length?(s=t?n:mu,e):s===n},e}function bu(){}function _u(e,t){var a=new bu;if(e instanceof bu)e.each(function(e,t){a.set(t,e)});else if(Array.isArray(e)){var r=-1,l=e.length,n;if(null==t)for(;++r<l;)a.set(r,e[r]);else for(;++r<l;)a.set(t(n=e[r],r,e),n)}else if(e)for(var s in e)a.set(s,e[s]);return a}function yu(){}function vu(){for(var e=0,o=arguments.length,n={},a;e<o;++e){if(!(a=arguments[e]+"")||a in n||/[\s.]/.test(a))throw new Error("illegal type: "+a);n[a]=[]}return new Tu(n)}function Tu(e){this._=e}function Au(e,o){return e.trim().split(/^|\s+/).map(function(e){var n="",a=e.indexOf(".");if(0<=a&&(n=e.slice(a+1),e=e.slice(0,a)),e&&!o.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}function Cu(e,t){for(var o=0,a=e.length,n;o<a;++o)if((n=e[o]).name===t)return n.value}function Eu(e,t,o){for(var a=0,r=e.length;a<r;++a)if(e[a].name===t){e[a]=FA,e=e.slice(0,a).concat(e.slice(a+1));break}return null!=o&&e.push({name:t,value:o}),e}function Bu(e,t){function i(e){var t=r.status,o;if(!t&&Su(r)||200<=t&&300>t||304===t){if(c)try{o=c.call(f,r)}catch(t){return void n.call("error",f,t)}else o=r;n.call("load",f,o)}else n.call("error",f,e)}var n=vu("beforesend","progress","load","error"),a=_u(),r=new XMLHttpRequest,l=null,s=null,d=0,f,u,c,p;if("undefined"!=typeof XDomainRequest&&!("withCredentials"in r)&&/^(http(s)?:)?\/\//.test(e)&&(r=new XDomainRequest),"onload"in r?r.onload=r.onerror=r.ontimeout=i:r.onreadystatechange=function(e){3<r.readyState&&i(e)},r.onprogress=function(t){n.call("progress",f,t)},f={header:function(e,t){return(e=(e+"").toLowerCase(),2>arguments.length)?a.get(e):(null==t?a.remove(e):a.set(e,t+""),f)},mimeType:function(e){return arguments.length?(u=null==e?null:e+"",f):u},responseType:function(e){return arguments.length?(p=e,f):p},timeout:function(e){return arguments.length?(d=+e,f):d},user:function(e){return 1>arguments.length?l:(l=null==e?null:e+"",f)},password:function(e){return 1>arguments.length?s:(s=null==e?null:e+"",f)},response:function(e){return c=e,f},get:function(e,t){return f.send("GET",e,t)},post:function(e,t){return f.send("POST",e,t)},send:function(t,o,i){return r.open(t,e,!0,l,s),null==u||a.has("accept")||a.set("accept",u+",*/*"),r.setRequestHeader&&a.each(function(e,t){r.setRequestHeader(t,e)}),null!=u&&r.overrideMimeType&&r.overrideMimeType(u),null!=p&&(r.responseType=p),0<d&&(r.timeout=d),null==i&&"function"==typeof o&&(i=o,o=null),null!=i&&1===i.length&&(i=wu(i)),null!=i&&f.on("error",i).on("load",function(e){i(null,e)}),n.call("beforesend",f,r),r.send(null==o?null:o),f},abort:function(){return r.abort(),f},on:function(){var e=n.on.apply(n,arguments);return e===n?f:e}},null!=t){if("function"!=typeof t)throw new Error("invalid callback: "+t);return f.get(t)}return f}function wu(e){return function(t,o){e(null==t?o:null)}}function Su(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function Lu(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"] || \"\""}).join(",")+"}")}function Du(e,t){var o=Lu(e);return function(n,a){return t(o(n),a,e)}}function Iu(e){var t=Object.create(null),o=[];return e.forEach(function(e){for(var i in e)i in t||o.push(t[i]=i)}),o}function Fu(e,t){var o=e+"",i=o.length;return i<t?Array(t-i+1).join(0)+o:o}function Ru(e){return 0>e?"-"+Fu(-e,6):9999<e?"+"+Fu(e,6):Fu(e,4)}function ku(e){var t=e.getUTCHours(),o=e.getUTCMinutes(),i=e.getUTCSeconds(),n=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Ru(e.getUTCFullYear(),4)+"-"+Fu(e.getUTCMonth()+1,2)+"-"+Fu(e.getUTCDate(),2)+(n?"T"+Fu(t,2)+":"+Fu(o,2)+":"+Fu(i,2)+"."+Fu(n,3)+"Z":i?"T"+Fu(t,2)+":"+Fu(o,2)+":"+Fu(i,2)+"Z":o||t?"T"+Fu(t,2)+":"+Fu(o,2)+"Z":"")}function Nu(e){function t(e,o){function i(){if(f)return NA;if(u)return u=!1,kA;var t=s,o,n;if(34===e.charCodeAt(t)){for(;s++<l&&34!==e.charCodeAt(s)||34===e.charCodeAt(++s););return(o=s)>=l?f=!0:10===(n=e.charCodeAt(s++))?u=!0:13===n&&(u=!0,10===e.charCodeAt(s)&&++s),e.slice(t+1,o-1).replace(/""/g,"\"")}for(;s<l;){if((n=e.charCodeAt(o=s++))===10)u=!0;else if(n===13)u=!0,10===e.charCodeAt(s)&&++s;else if(n!==r)continue;return e.slice(t,o)}return f=!0,e.slice(t,l)}var a=[],l=e.length,s=0,d=0,f=0>=l,u=!1,c;for(10===e.charCodeAt(l-1)&&--l,13===e.charCodeAt(l-1)&&--l;(c=i())!==NA;){for(var p=[];c!==kA&&c!==NA;)p.push(c),c=i();o&&null==(p=o(p,d++))||a.push(p)}return a}function o(t,o){return t.map(function(t){return o.map(function(e){return n(t[e])}).join(e)})}function i(t){return t.map(n).join(e)}function n(e){return null==e?"":e instanceof Date?ku(e):a.test(e+="")?"\""+e.replace(/"/g,"\"\"")+"\"":e}var a=new RegExp("[\""+e+"\n\r]"),r=e.charCodeAt(0);return{parse:function(e,o){var i=t(e,function(e,t){return n?n(e,t-1):void(a=e,n=o?Du(e,o):Lu(e))}),n,a;return i.columns=a||[],i},parseRows:t,format:function(t,i){return null==i&&(i=Iu(t)),[i.map(n).join(e)].concat(o(t,i)).join("\n")},formatBody:function(e,t){return null==t&&(t=Iu(e)),o(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:n}}var $u=function(e,t){return $u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},$u(e,t)},Qu=function(){return Qu=Object.assign||function(e){for(var t=1,o=arguments.length,n;t<o;t++)for(var a in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Qu.apply(this,arguments)},Ju="object"==typeof global&&global&&global.Object===Object&&global,ec="object"==typeof self&&self&&self.Object===Object&&self,tc=Ju||ec||Function("return this")(),oc=tc.Symbol,ic=Object.prototype,nc=ic.hasOwnProperty,ac=ic.toString,rc=oc?oc.toStringTag:void 0,lc=Object.prototype,sc=lc.toString,dc=oc?oc.toStringTag:void 0,fc=0/0,uc=Array.isArray,cc=1/0,pc=oc?oc.prototype:void 0,gc=pc?pc.toString:void 0,hc=p(function(e,t){return e+t},0),mc=0/0,xc=/^\s+|\s+$/g,bc=/^[-+]0x[0-9a-f]+$/i,_c=/^0b[01]+$/i,yc=/^0o[0-7]+$/i,vc=parseInt,Tc=1/0,Ac=tc["__core-js_shared__"],Cc=function(){var e=/[^.]+$/.exec(Ac&&Ac.keys&&Ac.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ec=Function.prototype,Bc=Ec.toString,wc=/[\\^$.*+?()[\]{}|]/g,Sc=/^\[object .+?Constructor\]$/,Lc=Function.prototype,Dc=Object.prototype,Ic=Lc.toString,Fc=Dc.hasOwnProperty,Rc=RegExp("^"+Ic.call(Fc).replace(wc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kc=S(tc,"WeakMap"),Nc=kc&&new kc,Mc=Nc?function(e,t){return Nc.set(e,t),e}:b,Hc=Object.create,Vc=function(){function e(){}return function(t){if(!g(t))return{};if(Hc)return Hc(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}(),Oc=qu,zc=qu;V.prototype=Vc(H.prototype),V.prototype.constructor=V;var Pc=Nc?function(e){return Nc.get(e)}:O,Gc={},jc=Object.prototype,Uc=jc.hasOwnProperty;P.prototype=Vc(H.prototype),P.prototype.constructor=P;var Wc=Object.prototype,Xc=Wc.hasOwnProperty;U.prototype=H.prototype,U.prototype.constructor=U;var qc=Date.now,Yc=X(Mc),Zc=/\{\n\/\* \[wrapped with (.+)\] \*/,Kc=/,? & /,$c=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qc=function(){try{var e=S(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Jc=Qc?function(e,t){return Qc(e,"toString",{configurable:!0,enumerable:!1,value:$(t),writable:!0})}:b,ep=X(Jc),tp=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],op=/^(?:0|[1-9]\d*)$/,ip=Zu,np=Zu,ap=qu,rp=Object.prototype,lp=rp.hasOwnProperty,sp=qu,dp=Object.prototype,fp=Object.prototype,up=fp.hasOwnProperty,cp=fp.propertyIsEnumerable,pp=Le(function(){return arguments}())?Le:function(e){return s(e)&&up.call(e,"callee")&&!cp.call(e,"callee")},gp="object"==typeof exports&&exports&&!exports.nodeType&&exports,hp=gp&&"object"==typeof module&&module&&!module.nodeType&&module,mp=hp&&hp.exports===gp,xp=mp?tc.Buffer:void 0,bp=xp?xp.isBuffer:void 0,_p=bp||De,yp={};yp["[object Float32Array]"]=yp["[object Float64Array]"]=yp["[object Int8Array]"]=yp["[object Int16Array]"]=yp["[object Int32Array]"]=yp["[object Uint8Array]"]=yp["[object Uint8ClampedArray]"]=yp["[object Uint16Array]"]=yp["[object Uint32Array]"]=!0,yp["[object Arguments]"]=yp["[object Array]"]=yp["[object ArrayBuffer]"]=yp["[object Boolean]"]=yp["[object DataView]"]=yp["[object Date]"]=yp["[object Error]"]=yp["[object Function]"]=yp["[object Map]"]=yp["[object Number]"]=yp["[object Object]"]=yp["[object RegExp]"]=yp["[object Set]"]=yp["[object String]"]=yp["[object WeakMap]"]=!1;var vp="object"==typeof exports&&exports&&!exports.nodeType&&exports,Tp=vp&&"object"==typeof module&&module&&!module.nodeType&&module,Ap=Tp&&Tp.exports===vp,Cp=Ap&&Ju.process,Ep=function(){try{var e=Tp&&Tp.require&&Tp.require("util").types;return e?e:Cp&&Cp.binding&&Cp.binding("util")}catch(t){}}(),Bp=Ep&&Ep.isTypedArray,wp=Bp?Ie(Bp):function(e){return s(e)&&Ae(e.length)&&!!yp[l(e)]},Sp=Object.prototype,Lp=Sp.hasOwnProperty,Dp=Re(Object.keys,Object),Ip=Object.prototype,Fp=Ip.hasOwnProperty,Rp=Object.prototype,kp=Rp.hasOwnProperty,Np=Be(function(e,t){if(we(t)||Ce(t))return void ye(t,Ne(t),e);for(var o in t)kp.call(t,o)&&i(e,o,t[o])}),Mp=Object.prototype,Hp=Mp.hasOwnProperty,Vp=Be(function(e,t){ye(t,Ve(t),e)}),Op=Be(function(e,t,o,i){ye(t,Ve(t),e,i)}),zp=Be(function(e,t,o,i){ye(t,Ne(t),e,i)}),Pp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Gp=/^\w*$/,jp=S(Object,"create"),Up=Object.prototype,Wp=Up.hasOwnProperty,Xp=Object.prototype,qp=Xp.hasOwnProperty;ze.prototype.clear=function(){this.__data__=jp?jp(null):{},this.size=0},ze.prototype["delete"]=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ze.prototype.get=function(e){var t=this.__data__;if(jp){var o=t[e];return o==="__lodash_hash_undefined__"?void 0:o}return Wp.call(t,e)?t[e]:void 0},ze.prototype.has=function(e){var t=this.__data__;return jp?t[e]!==void 0:qp.call(t,e)},ze.prototype.set=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=jp&&void 0===t?"__lodash_hash_undefined__":t,this};var Yp=Array.prototype,Zp=Yp.splice;Ge.prototype.clear=function(){this.__data__=[],this.size=0},Ge.prototype["delete"]=function(e){var t=this.__data__,o=Pe(t,e);if(0>o)return!1;var i=t.length-1;return o==i?t.pop():Zp.call(t,o,1),--this.size,!0},Ge.prototype.get=function(e){var t=this.__data__,o=Pe(t,e);return 0>o?void 0:t[o][1]},Ge.prototype.has=function(e){return-1<Pe(this.__data__,e)},Ge.prototype.set=function(e,t){var o=this.__data__,i=Pe(o,e);return 0>i?(++this.size,o.push([e,t])):o[i][1]=t,this};var Kp=S(tc,"Map");We.prototype.clear=function(){this.size=0,this.__data__={hash:new ze,map:new(Kp||Ge),string:new ze}},We.prototype["delete"]=function(e){var t=Ue(this,e)["delete"](e);return this.size-=t?1:0,t},We.prototype.get=function(e){return Ue(this,e).get(e)},We.prototype.has=function(e){return Ue(this,e).has(e)},We.prototype.set=function(e,t){var o=Ue(this,e),i=o.size;return o.set(e,t),this.size+=o.size==i?0:1,this};Xe.Cache=We;var $p=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Qp=/\\(\\)?/g,Jp=function(e){var t=Xe(e,function(e){return 500===o.size&&o.clear(),e}),o=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace($p,function(e,o,i,n){t.push(i?n.replace(Qp,"$1"):o||e)}),t}),eg=1/0,tg=oc?oc.isConcatSpreadable:void 0,og=it(Qe),at=Re(Object.getPrototypeOf,Object),ig=Function.prototype,ng=Object.prototype,ag=ig.toString,rg=ng.hasOwnProperty,lg=ag.call(Object),sg=Te(function(e,t){try{return R(e,void 0,t)}catch(t){return rt(t)?t:new Error(t)}}),dg=Te(function(e,t,o){var i=1;if(o.length){var n=ue(o,se(dg));i|=32}return me(e,i,t,o,n)});dg.placeholder={};var fg=it(function(e,t){return Q(t,function(t){t=Ze(t),be(e,t,dg(e[t],e))}),e}),ug=Te(function(e,t,o){var i=1|2;if(o.length){var n=ue(o,se(ug));i|=32}return me(t,i,e,o,n)});ug.placeholder={};var cg=RegExp("["+"\\u200d"+"\\ud800-\\udfff"+"\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff"+"\\ufe0e\\ufe0f"+"]"),pg="\\ud800-\\udfff",gg="["+("\\u0300-\\u036f"+"\\ufe20-\\ufe2f"+"\\u20d0-\\u20ff")+"]",hg="\\ud83c[\\udffb-\\udfff]",mg="[^"+pg+"]",xg="(?:\\ud83c[\\udde6-\\uddff]){2}",bg="[\\ud800-\\udbff][\\udc00-\\udfff]",_g="(?:"+gg+"|"+hg+")"+"?",yg="["+"\\ufe0e\\ufe0f"+"]?",vg="(?:"+"\\u200d"+"(?:"+[mg,xg,bg].join("|")+")"+yg+_g+")*",Tg="(?:"+[mg+gg+"?",gg,xg,bg,"["+pg+"]"].join("|")+")",Ag=RegExp(hg+"(?="+hg+")|"+Tg+(yg+_g+vg),"g"),Cg=mt("toUpperCase"),Eg=_t({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),Bg=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,wg=RegExp("["+("\\u0300-\\u036f"+"\\ufe20-\\ufe2f"+"\\u20d0-\\u20ff")+"]","g"),Sg=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Lg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Dg="\\ud800-\\udfff",Ig="\\u2700-\\u27bf",Fg="a-z\\xdf-\\xf6\\xf8-\\xff",Rg="A-Z\\xc0-\\xd6\\xd8-\\xde",kg="\\xac\\xb1\\xd7\\xf7"+"\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf"+"\\u2000-\\u206f"+" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ng="['\u2019]",Mg="["+kg+"]",Hg="\\d+",Vg="["+Fg+"]",Og="[^"+Dg+kg+Hg+Ig+Fg+Rg+"]",zg="(?:\\ud83c[\\udde6-\\uddff]){2}",Pg="[\\ud800-\\udbff][\\udc00-\\udfff]",Gg="["+Rg+"]",jg="(?:"+Vg+"|"+Og+")",Ug="(?:"+Ng+"(?:d|ll|m|re|s|t|ve))?",Wg="(?:"+Ng+"(?:D|LL|M|RE|S|T|VE))?",Xg="(?:"+("["+("\\u0300-\\u036f"+"\\ufe20-\\ufe2f"+"\\u20d0-\\u20ff")+"]")+"|"+"\\ud83c[\\udffb-\\udfff]"+")"+"?",qg="["+"\\ufe0e\\ufe0f"+"]?",Yg="(?:"+"\\u200d"+"(?:"+["[^"+Dg+"]",zg,Pg].join("|")+")"+qg+Xg+")*",Zg="(?:"+["["+Ig+"]",zg,Pg].join("|")+")"+(qg+Xg+Yg),Kg=RegExp([Gg+"?"+Vg+"+"+Ug+"(?="+[Mg,Gg,"$"].join("|")+")","(?:"+Gg+"|"+Og+")"+"+"+Wg+"(?="+[Mg,Gg+jg,"$"].join("|")+")",Gg+"?"+jg+"+"+Ug,Gg+"+"+Wg,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Hg,Zg].join("|"),"g"),$g=RegExp("['\u2019]","g"),Qg=Et(function(e,t,o){return t=t.toLowerCase(),e+(o?xt(t):t)}),Jg=tc.isFinite,eh=Zu,th=Bt("ceil"),oh=Yu,ih=qu;Dt.prototype.clear=function(){this.__data__=new Ge,this.size=0},Dt.prototype["delete"]=function(e){var t=this.__data__,o=t["delete"](e);return this.size=t.size,o},Dt.prototype.get=function(e){return this.__data__.get(e)},Dt.prototype.has=function(e){return this.__data__.has(e)},Dt.prototype.set=function(e,t){var o=this.__data__;if(o instanceof Ge){var i=o.__data__;if(!Kp||199>i.length)return i.push([e,t]),this.size=++o.size,this;o=this.__data__=new We(i)}return o.set(e,t),this.size=o.size,this};var nh="object"==typeof exports&&exports&&!exports.nodeType&&exports,ah=nh&&"object"==typeof module&&module&&!module.nodeType&&module,rh=ah&&ah.exports===nh,lh=rh?tc.Buffer:void 0,sh=lh?lh.allocUnsafe:void 0,dh=Object.prototype,fh=dh.propertyIsEnumerable,uh=Object.getOwnPropertySymbols,ch=uh?function(e){return null==e?[]:(e=Object(e),kt(uh(e),function(t){return fh.call(e,t)}))}:Nt,ph=Object.getOwnPropertySymbols,gh=ph?function(e){for(var t=[];e;)Je(t,ch(e)),e=at(e);return t}:Nt,hh=S(tc,"DataView"),mh=S(tc,"Promise"),xh=S(tc,"Set"),bh="[object Map]",_h="[object Promise]",yh="[object Set]",vh="[object WeakMap]",Th="[object DataView]",Ah=v(hh),Ch=v(Kp),Eh=v(mh),Bh=v(xh),wh=v(kc),Sh=l;(hh&&Sh(new hh(new ArrayBuffer(1)))!=Th||Kp&&Sh(new Kp)!=bh||mh&&Sh(mh.resolve())!=_h||xh&&Sh(new xh)!=yh||kc&&Sh(new kc)!=vh)&&(Sh=function(e){var t=l(e),o=t=="[object Object]"?e.constructor:void 0,i=o?v(o):"";if(i)switch(i){case Ah:return Th;case Ch:return bh;case Eh:return _h;case Bh:return yh;case wh:return vh;}return t});var Lh=Sh,Dh=Object.prototype,Ih=Dh.hasOwnProperty,Fh=tc.Uint8Array,Rh=/\w*$/,kh=oc?oc.prototype:void 0,Nh=kh?kh.valueOf:void 0,Mh=Ep&&Ep.isMap,Hh=Mh?Ie(Mh):function(e){return s(e)&&Lh(e)=="[object Map]"},Vh=Ep&&Ep.isSet,Oh=Vh?Ie(Vh):function(e){return s(e)&&Lh(e)=="[object Set]"},zh={};zh["[object Arguments]"]=zh["[object Array]"]=zh["[object ArrayBuffer]"]=zh["[object DataView]"]=zh["[object Boolean]"]=zh["[object Date]"]=zh["[object Float32Array]"]=zh["[object Float64Array]"]=zh["[object Int8Array]"]=zh["[object Int16Array]"]=zh["[object Int32Array]"]=zh["[object Map]"]=zh["[object Number]"]=zh["[object Object]"]=zh["[object RegExp]"]=zh["[object Set]"]=zh["[object String]"]=zh["[object Symbol]"]=zh["[object Uint8Array]"]=zh["[object Uint8ClampedArray]"]=zh["[object Uint16Array]"]=zh["[object Uint32Array]"]=!0,zh["[object Error]"]=zh["[object Function]"]=zh["[object WeakMap]"]=!1;Kt.prototype.add=Kt.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Kt.prototype.has=function(e){return this.__data__.has(e)};var Ph=oc?oc.prototype:void 0,Gh=Ph?Ph.valueOf:void 0,jh=Object.prototype,Uh=jh.hasOwnProperty,Wh=Object.prototype,Xh=Wh.hasOwnProperty,qh=Ao(),Yh=Eo(Co),Zh=Object.prototype,Kh=Zh.hasOwnProperty,$h=wo(function(e,t,o){Kh.call(e,o)?++e[o]:be(e,o,1)});So.placeholder={};Lo.placeholder={};var Qh=function(){return tc.Date.now()},Jh=qu,em=Zu,tm=Object.prototype,om=tm.hasOwnProperty,im=Te(function(e,t){e=Object(e);var o=-1,i=t.length,n=2<i?t[2]:void 0;for(n&&Ee(t[0],t[1],n)&&(i=1);++o<i;)for(var a=t[o],r=Ve(a),l=-1,s=r.length;++l<s;){var d=r[l],f=e[d];(void 0===f||_e(f,tm[d])&&!om.call(e,d))&&(e[d]=a[d])}return e}),nm=Be(function(e,t,o,i){Mo(e,t,o,i)}),am=Te(function(e){return e.push(void 0,Ho),R(nm,void 0,e)}),rm=Te(function(e,t){return Vo(e,1,t)}),lm=Te(function(e,t,o){return Vo(e,h(t)||0,o)}),sm=Te(function(e,t){return Fo(e)?zo(e,tt(t,1,Fo,!0)):[]}),dm=Te(function(e,t){var o=Po(t);return Fo(o)&&(o=void 0),Fo(e)?zo(e,tt(t,1,Fo,!0),_o(o,2)):[]}),fm=Te(function(e,t){var o=Po(t);return Fo(o)&&(o=void 0),Fo(e)?zo(e,tt(t,1,Fo,!0),void 0,o):[]}),um=p(function(e,t){return e/t},1),cm=Ao(!0),pm=Eo(Xo,!0),gm=Ko(Ne),hm=Ko(Ve),mm=_t({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),xm=/[&<>"']/g,bm=RegExp(xm.source),_m=/[\\^$.*+?()[\]{}|]/g,ym=RegExp(_m.source),vm=qu,Tm=ii(ni),Am=qu,Cm=Zu,Em=ii(ri),Bm=Bt("floor"),wm=ui(),Sm=ui(!0),Lm=Object.prototype,Dm=Lm.hasOwnProperty,Im=wo(function(e,t,o){Dm.call(e,o)?e[o].push(t):be(e,o,[t])}),Fm=gi(pi),gt=gi(function(e,t){return e>=t}),Rm=Object.prototype,km=Rm.hasOwnProperty,Nm=qu,Mm=Zu,Hm=Zu,Vm=Te(function(e){var t=u(e,vi);return t.length&&t[0]===e[0]?yi(t):[]}),Om=Te(function(e){var t=Po(e),o=u(e,vi);return t===Po(o)?t=void 0:o.pop(),o.length&&o[0]===e[0]?yi(o,_o(t,2)):[]}),zm=Te(function(e){var t=Po(e),o=u(e,vi);return t="function"==typeof t?t:void 0,t&&o.pop(),o.length&&o[0]===e[0]?yi(o,void 0,t):[]}),Pm=Object.prototype,Gm=Pm.toString,jm=Ai(function(e,t,o){null!=t&&"function"!=typeof t.toString&&(t=Gm.call(t)),e[t]=o},$(b)),Um=Object.prototype,Wm=Um.hasOwnProperty,Xm=Um.toString,qm=Ai(function(e,t,o){null!=t&&"function"!=typeof t.toString&&(t=Xm.call(t)),Wm.call(e,t)?e[t].push(o):e[t]=[o]},_o),Ym=Te(Ei),Zm=Te(function(e,t,o){var i=-1,n=Ce(e)?Array(e.length):[];return Yh(e,function(e){n[++i]="function"==typeof t?R(t,e,o):Ei(e,t,o)}),n}),Km=Ep&&Ep.isArrayBuffer,$m=Km?Ie(Km):function(e){return s(e)&&l(e)=="[object ArrayBuffer]"},Qm=Ep&&Ep.isDate,Jm=Qm?Ie(Qm):function(e){return s(e)&&l(e)=="[object Date]"},ex=Object.prototype,tx=ex.hasOwnProperty,ox=tc.isFinite,ix=Ac?_:De,nx=Ep&&Ep.isRegExp,ax=nx?Ie(nx):function(e){return s(e)&&l(e)=="[object RegExp]"},rx=Array.prototype,lx=rx.join,sx=Et(function(e,t,o){return e+(o?"-":"")+t.toLowerCase()}),dx=wo(function(e,t,o){be(e,o,t)}),fx=Et(function(e,t,o){return e+(o?" ":"")+t.toLowerCase()}),ux=mt("toLowerCase"),cx=gi(Ii),lt=gi(function(e,t){return e<=t}),px=0/0,gx=Be(function(e,t,o){Mo(e,t,o)}),hx=Te(function(e,t){return function(o){return Ei(o,e,t)}}),mx=Te(function(e,t){return function(o){return Ei(e,o,t)}}),xx=p(function(e,t){return e*t},1),bx=oc?oc.iterator:void 0,_x=it(function(e,t){var o={};if(null==e)return o;var i=!1;t=u(t,function(t){return t=Ye(t,e),i||(i=1<t.length),t}),ye(e,zt(e),o),i&&(o=Zt(o,1|2|4,Gi));for(var n=t.length;n--;)Pi(o,t[n]);return o}),yx=Ki(u),vx=Te(function(e,t){t=1==t.length&&uc(t[0])?u(t[0],Ie(_o)):u(tt(t,1),Ie(_o));var o=t.length;return Te(function(i){for(var n=-1,a=Zu(i.length,o);++n<a;)i[n]=t[n].call(this,i[n]);return R(e,this,i)})}),Tx=Ki(Qo),Ax=Ki($t),Cx=Xu,Ex=mo("length"),Bx="\\ud800-\\udfff",wx="["+("\\u0300-\\u036f"+"\\ufe20-\\ufe2f"+"\\u20d0-\\u20ff")+"]",Sx="\\ud83c[\\udffb-\\udfff]",Lx="[^"+Bx+"]",Dx="(?:\\ud83c[\\udde6-\\uddff]){2}",Ix="[\\ud800-\\udbff][\\udc00-\\udfff]",Fx="(?:"+wx+"|"+Sx+")"+"?",Rx="["+"\\ufe0e\\ufe0f"+"]?",kx="(?:"+"\\u200d"+"(?:"+[Lx,Dx,Ix].join("|")+")"+Rx+Fx+")*",Nx="(?:"+[Lx+wx+"?",wx,Dx,Ix,"["+Bx+"]"].join("|")+")",Mx=RegExp(Sx+"(?="+Sx+")|"+Nx+(Rx+Fx+kx),"g"),Hx=Yu,Vx=/^\s+/,Ox=tc.parseInt,zx=Te(function(e,t){var o=ue(t,se(zx));return me(e,32,void 0,t,o)});zx.placeholder={};var Px=Te(function(e,t){var o=ue(t,se(Px));return me(e,64,void 0,t,o)});Px.placeholder={};var Gx=wo(function(e,t,o){e[o?0:1].push(t)},function(){return[[],[]]}),jx=it(function(e,t){return null==e?{}:tn(e,t)}),Ux=Array.prototype,Wx=Ux.splice,Xx=Te(an),qx=Array.prototype,Yx=qx.splice,Zx=it(function(e,t){var o=null==e?0:e.length,i=Qe(e,t);return rn(e,u(t,function(e){return de(e,o)?+e:e}).sort(qi)),i}),Kx=Xu,$x=Math.random,Qx=parseFloat,Jx=Math.random,eb=Yu,tb=qu,ob=dn(),ib=dn(!0),nb=it(function(e,t){return me(e,256,void 0,void 0,void 0,t)}),ab=Array.prototype,rb=ab.reverse,lb=Bt("round"),sb=Et(function(e,t,o){return e+(o?"_":"")+t.toLowerCase()}),db=Te(function(e,t){if(null==e)return[];var o=t.length;return 1<o&&Ee(e,t[0],t[1])?t=[]:2<o&&Ee(t[0],t[1],t[2])&&(t=[t[0]]),Zi(e,tt(t,1),[])}),fb=Xu,ub=Zu,cb=Et(function(e,t,o){return e+(o?" ":"")+Cg(t)}),pb=p(function(e,t){return e-t},0),gb=Object.prototype,hb=gb.hasOwnProperty,mb={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},xb=/<%=([\s\S]+?)%>/g,bb=/<%-([\s\S]+?)%>/g,_b=/<%([\s\S]+?)%>/g,yb={escape:bb,evaluate:_b,interpolate:xb,variable:"",imports:{_:{escape:$o}}},vb=/\b__p \+= '';/g,Tb=/\b(__p \+=) '' \+/g,Ab=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Cb=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Eb=/($^)/,Bb=/['\n\r\u2028\u2029\\]/g,wb=Object.prototype,Sb=wb.hasOwnProperty,Lb=/^\s+|\s+$/g,Db=/\s+$/,Ib=/^\s+/,Fb=/\w*$/,Rb=_t({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":"\"","&#39;":"'"}),kb=/&(?:amp|lt|gt|quot|#39);/g,Nb=RegExp(kb.source),Mb=xh&&1/to(new xh([,-0]))[1]==1/0?function(e){return new xh(e)}:O,Hb=Te(function(e){return Rn(tt(e,1,Fo,!0))}),Vb=Te(function(e){var t=Po(e);return Fo(t)&&(t=void 0),Rn(tt(e,1,Fo,!0),_o(t,2))}),Ob=Te(function(e){var t=Po(e);return t="function"==typeof t?t:void 0,Rn(tt(e,1,Fo,!0),void 0,t)}),zb=0,Pb=qu,Gb=Et(function(e,t,o){return e+(o?" ":"")+t.toUpperCase()}),jb=Te(function(e,t){return Fo(e)?zo(e,t):[]}),Ub=it(function(e){var t=e.length,o=t?e[0]:0,i=this.__wrapped__,n=function(t){return Qe(t,e)};return 1<t||this.__actions__.length||!(i instanceof V)||!de(o)?this.thru(n):(i=i.slice(o,+o+(t?1:0)),i.__actions__.push({func:wn,args:[n],thisArg:void 0}),new P(i,this.__chain__).thru(function(e){return t&&!e.length&&e.push(void 0),e}))}),Wb=Te(function(e){return Vn(kt(e,Fo))}),Xb=Te(function(e){var t=Po(e);return Fo(t)&&(t=void 0),Vn(kt(e,Fo),_o(t,2))}),qb=Te(function(e){var t=Po(e);return t="function"==typeof t?t:void 0,Vn(kt(e,Fo),void 0,t)}),Yb=Te(Nn),Zb=Te(function(e){var t=e.length,o=1<t?e[t-1]:void 0;return o="function"==typeof o?(e.pop(),o):void 0,Mn(e,o)}),Kb={chunk:St,compact:function(e){for(var t=-1,o=null==e?0:e.length,i=0,n=[];++t<o;){var a=e[t];a&&(n[i++]=a)}return n},concat:function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),o=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Je(uc(o)?G(o):[o],tt(t,1))},difference:sm,differenceBy:dm,differenceWith:fm,drop:function(e,t,o){var i=null==e?0:e.length;return i?(t=o||void 0===t?1:x(t),dt(e,0>t?0:t,i)):[]},dropRight:function(e,t,o){var i=null==e?0:e.length;return i?(t=o||void 0===t?1:x(t),t=i-t,dt(e,0,0>t?0:t)):[]},dropRightWhile:function(e,t){return e&&e.length?Go(e,_o(t,3),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?Go(e,_o(t,3),!0):[]},fill:function(e,t,o,i){var n=null==e?0:e.length;return n?(o&&"number"!=typeof o&&Ee(e,t,o)&&(o=0,i=n),ti(e,t,o,i)):[]},findIndex:ni,findLastIndex:ri,first:li,flatten:ot,flattenDeep:function(e){var t=null==e?0:e.length;return t?tt(e,1/0):[]},flattenDepth:function(e,t){var o=null==e?0:e.length;return o?(t=void 0===t?1:x(t),tt(e,t)):[]},fromPairs:function(e){for(var t=-1,o=null==e?0:e.length,i={};++t<o;){var n=e[t];i[n[0]]=n[1]}return i},head:li,indexOf:function(e,t,o){var i=null==e?0:e.length;if(!i)return-1;var n=null==o?0:x(o);return 0>n&&(n=qu(i+n,0)),oe(e,t,n)},initial:function(e){var t=null==e?0:e.length;return t?dt(e,0,-1):[]},intersection:Vm,intersectionBy:Om,intersectionWith:zm,join:function(e,t){return null==e?"":lx.call(e,t)},last:Po,lastIndexOf:function(e,t,o){var i=null==e?0:e.length;if(!i)return-1;var n=i;return void 0!==o&&(n=x(o),n=0>n?qu(i+n,0):Zu(n,i-1)),t===t?Di(e,t,n):J(e,ee,n,!0)},nth:function(e,t){return e&&e.length?zi(e,x(t)):void 0},pull:Xx,pullAll:an,pullAllBy:function(e,t,o){return e&&e.length&&t&&t.length?nn(e,t,_o(o,2)):e},pullAllWith:function(e,t,o){return e&&e.length&&t&&t.length?nn(e,t,void 0,o):e},pullAt:Zx,remove:function(e,t){var o=[];if(!(e&&e.length))return o;var i=-1,n=[],a=e.length;for(t=_o(t,3);++i<a;){var r=e[i];t(r,i,e)&&(o.push(r),n.push(i))}return rn(e,n),o},reverse:cn,slice:function(e,t,o){var i=null==e?0:e.length;return i?(o&&"number"!=typeof o&&Ee(e,t,o)?(t=0,o=i):(t=null==t?0:x(t),o=void 0===o?i:x(o)),dt(e,t,o)):[]},sortedIndex:function(e,t){return Tn(e,t)},sortedIndexBy:function(e,t,o){return vn(e,t,_o(o,2))},sortedIndexOf:function(e,t){var o=null==e?0:e.length;if(o){var i=Tn(e,t);if(i<o&&_e(e[i],t))return i}return-1},sortedLastIndex:function(e,t){return Tn(e,t,!0)},sortedLastIndexBy:function(e,t,o){return vn(e,t,_o(o,2),!0)},sortedLastIndexOf:function(e,t){var o=null==e?0:e.length;if(o){var i=Tn(e,t,!0)-1;if(_e(e[i],t))return i}return-1},sortedUniq:function(e){return e&&e.length?An(e):[]},sortedUniqBy:function(e,t){return e&&e.length?An(e,_o(t,2)):[]},tail:function(e){var t=null==e?0:e.length;return t?dt(e,1,t):[]},take:function(e,t,o){return e&&e.length?(t=o||void 0===t?1:x(t),dt(e,0,0>t?0:t)):[]},takeRight:function(e,t,o){var i=null==e?0:e.length;return i?(t=o||void 0===t?1:x(t),t=i-t,dt(e,0>t?0:t,i)):[]},takeRightWhile:function(e,t){return e&&e.length?Go(e,_o(t,3),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?Go(e,_o(t,3)):[]},union:Hb,unionBy:Vb,unionWith:Ob,uniq:function(e){return e&&e.length?Rn(e):[]},uniqBy:function(e,t){return e&&e.length?Rn(e,_o(t,2)):[]},uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Rn(e,void 0,t):[]},unzip:Nn,unzipWith:Mn,without:jb,xor:Wb,xorBy:Xb,xorWith:qb,zip:Yb,zipObject:function(e,t){return On(e||[],t||[],i)},zipObjectDeep:function(e,t){return On(e||[],t||[],ji)},zipWith:Zb},$b={countBy:$h,each:Uo,eachRight:qo,every:function(e,t,o){var i=uc(e)?Qo:Jo;return o&&Ee(e,t,o)&&(t=void 0),i(e,_o(t,3))},filter:function(e,t){var o=uc(e)?kt:oi;return o(e,_o(t,3))},find:Tm,findLast:Em,flatMap:fi,flatMapDeep:function(e,t){return tt(di(e,t),1/0)},flatMapDepth:function(e,t,o){return o=void 0===o?1:x(o),tt(di(e,t),o)},forEach:Uo,forEachRight:qo,groupBy:Im,includes:function(e,t,o,i){e=Ce(e)?e:_i(e),o=o&&!i?x(o):0;var n=e.length;return 0>o&&(o=qu(n+o,0)),xi(e)?o<=n&&-1<e.indexOf(t,o):!!n&&-1<oe(e,t,o)},invokeMap:Zm,keyBy:dx,map:di,orderBy:function(e,t,o,i){return null==e?[]:(uc(t)||(t=null==t?[]:[t]),o=i?void 0:o,uc(o)||(o=null==o?[]:[o]),Zi(e,t,o))},partition:Gx,reduce:function(e,t,o){var i=uc(e)?bt:fn,n=3>arguments.length;return i(e,_o(t,4),o,n,Yh)},reduceRight:function(e,t,o){var i=uc(e)?un:fn,n=3>arguments.length;return i(e,_o(t,4),o,n,pm)},reject:function(e,t){var o=uc(e)?kt:oi;return o(e,Hi(_o(t,3)))},sample:function(e){var t=uc(e)?pn:gn;return t(e)},sampleSize:function(e,t,o){t=(o?Ee(e,t,o):void 0===t)?1:x(t);var i=uc(e)?mn:xn;return i(e,t)},shuffle:function(e){var t=uc(e)?bn:_n;return t(e)},size:function(e){if(null==e)return 0;if(Ce(e))return xi(e)?Ji(e):e.length;var t=Lh(e);return"[object Map]"==t||"[object Set]"==t?e.size:ke(e).length},some:function(e,t,o){var i=uc(e)?$t:yn;return o&&Ee(e,t,o)&&(t=void 0),i(e,_o(t,3))},sortBy:db},Qb={after:function(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=x(e),function(){if(1>--e)return t.apply(this,arguments)}},ary:xe,before:st,bind:dg,bindKey:ug,curry:So,curryRight:Lo,debounce:Do,defer:rm,delay:lm,flip:function(e){return me(e,512)},memoize:Xe,negate:Hi,once:function(e){return st(2,e)},overArgs:vx,partial:zx,partialRight:Px,rearg:nb,rest:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=void 0===t?t:x(t),Te(e,t)},spread:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:qu(x(t),0),Te(function(o){var i=o[t],n=ft(o,0,t);return i&&Je(n,i),R(e,this,n)})},throttle:Bn,unary:function(e){return xe(e,1)},wrap:function(e,t){return zx(jo(t),e)}},Jb={castArray:function(){if(!arguments.length)return[];var e=arguments[0];return uc(e)?e:[e]},clone:function(e){return Zt(e,4)},cloneDeep:function(e){return Zt(e,5)},cloneDeepWith:function(e,t){return t="function"==typeof t?t:void 0,Zt(e,5,t)},cloneWith:function(e,t){return t="function"==typeof t?t:void 0,Zt(e,4,t)},conformsTo:function(e,t){return null==t||yo(e,t,Ne(t))},eq:_e,gt:Fm,gte:gt,isArguments:pp,isArray:uc,isArrayBuffer:$m,isArrayLike:Ce,isArrayLikeObject:Fo,isBoolean:function(e){return!0===e||!1===e||s(e)&&l(e)=="[object Boolean]"},isBuffer:_p,isDate:Jm,isElement:function(e){return s(e)&&1===e.nodeType&&!nt(e)},isEmpty:Bi,isEqual:function(e,t){return ao(e,t)},isEqualWith:function(e,t,o){o="function"==typeof o?o:void 0;var i=o?o(e,t):void 0;return i===void 0?ao(e,t,void 0,o):!!i},isError:rt,isFinite:function(e){return"number"==typeof e&&ox(e)},isFunction:_,isInteger:wi,isLength:Ae,isMap:Hh,isMatch:function(e,t){return e===t||ro(e,t,so(t))},isMatchWith:function(e,t,o){return o="function"==typeof o?o:void 0,ro(e,t,so(t),o)},isNaN:function(e){return Si(e)&&e!=+e},isNative:function(e){if(ix(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return T(e)},isNil:function(e){return null==e},isNull:function(e){return null===e},isNumber:Si,isObject:g,isObjectLike:s,isPlainObject:nt,isRegExp:ax,isSafeInteger:function(e){return wi(e)&&e>=-9007199254740991&&e<=9007199254740991},isSet:Oh,isString:xi,isSymbol:d,isTypedArray:wp,isUndefined:Li,isWeakMap:function(e){return s(e)&&Lh(e)=="[object WeakMap]"},isWeakSet:function(e){return s(e)&&l(e)=="[object WeakSet]"},lt:cx,lte:lt,toArray:Oi,toFinite:m,toInteger:x,toLength:ei,toNumber:h,toPlainObject:ko,toSafeInteger:function(e){return e?Lt(x(e),-9007199254740991,9007199254740991):0===e?e:0},toString:qe},e_={add:hc,ceil:th,divide:um,floor:Bm,max:function(e){return e&&e.length?Ri(e,b,pi):void 0},maxBy:function(e,t){return e&&e.length?Ri(e,_o(t,2),pi):void 0},mean:function(e){return Ni(e,b)},meanBy:function(e,t){return Ni(e,_o(t,2))},min:function(e){return e&&e.length?Ri(e,b,Ii):void 0},minBy:function(e,t){return e&&e.length?Ri(e,_o(t,2),Ii):void 0},multiply:xx,round:lb,subtract:pb,sum:function(e){return e&&e.length?ki(e,b):0},sumBy:function(e,t){return e&&e.length?ki(e,_o(t,2)):0}},t_={clamp:function(e,t,o){return void 0===o&&(o=t,t=void 0),void 0!==o&&(o=h(o),o=o===o?o:0),void 0!==t&&(t=h(t),t=t===t?t:0),Lt(h(e),t,o)},inRange:function(e,t,o){return t=m(t),void 0===o?(o=t,t=0):o=m(o),e=h(e),mi(e,t,o)},random:function(e,t,o){if(o&&"boolean"!=typeof o&&Ee(e,t,o)&&(t=o=void 0),void 0===o&&("boolean"==typeof t?(o=t,t=void 0):"boolean"==typeof e&&(o=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=m(e),void 0===t?(t=e,e=0):t=m(t)),e>t){var i=e;e=t,t=i}if(o||e%1||t%1){var n=Jx();return Zu(e+n*(t-e+Qx("1e-"+((n+"").length-1))),t)}return ln(e,t)}},o_={assign:Np,assignIn:Vp,assignInWith:Op,assignWith:zp,at:og,create:function(e,t){var o=Vc(e);return null==t?o:It(o,t)},defaults:im,defaultsDeep:am,entries:gm,entriesIn:hm,extend:Vp,extendWith:Op,findKey:function(e,t){return ai(e,_o(t,3),Co)},findLastKey:function(e,t){return ai(e,_o(t,3),Xo)},forIn:function(e,t){return null==e?e:qh(e,jo(t),Ve)},forInRight:function(e,t){return null==e?e:cm(e,jo(t),Ve)},forOwn:function(e,t){return e&&Co(e,jo(t))},forOwnRight:function(e,t){return e&&Xo(e,jo(t))},functions:function(e){return null==e?[]:ci(e,Ne(e))},functionsIn:function(e){return null==e?[]:ci(e,Ve(e))},get:$e,has:function(e,t){return null!=e&&po(e,t,hi)},hasIn:go,invert:jm,invertBy:qm,invoke:Ym,keys:Ne,keysIn:Ve,mapKeys:function(e,t){var o={};return t=_o(t,3),Co(e,function(e,i,n){be(o,t(e,i,n),e)}),o},mapValues:Fi,merge:gx,mergeWith:nm,omit:_x,omitBy:function(e,t){return Wi(e,Hi(_o(t)))},pick:jx,pickBy:Wi,result:function(e,t,o){t=Ye(t,e);var i=-1,n=t.length;for(n||(n=1,e=void 0);++i<n;){var a=null==e?void 0:e[Ze(t[i])];a===void 0&&(i=n,a=o),e=_(a)?a.call(e):a}return e},set:function(e,t,o){return null==e?e:ji(e,t,o)},setWith:function(e,t,o,i){return i="function"==typeof i?i:void 0,null==e?e:ji(e,t,o,i)},toPairs:gm,toPairsIn:hm,transform:function(e,t,o){var i=uc(e),n=i||_p(e)||wp(e);if(t=_o(t,4),null==o){var a=e&&e.constructor;o=n?i?new a:[]:g(e)?_(a)?Vc(at(e)):{}:{}}return(n?Q:Co)(e,function(e,i,n){return t(o,e,i,n)}),o},unset:function(e,t){return!(null!=e)||Pi(e,t)},update:function(e,t,o){return null==e?e:Hn(e,t,jo(o))},updateWith:function(e,t,o,i){return i="function"==typeof i?i:void 0,null==e?e:Hn(e,t,jo(o),i)},values:_i,valuesIn:function(e){return null==e?[]:bi(e,Ve(e))}},i_={at:Ub,chain:wt,commit:function(){return new P(this.value(),this.__chain__)},lodash:U,next:function(){this.__values__===void 0&&(this.__values__=Oi(this.value()));var e=this.__index__>=this.__values__.length,t=e?void 0:this.__values__[this.__index__++];return{done:e,value:t}},plant:function(e){for(var t=this,o,i;t instanceof H;){i=j(t),i.__index__=0,i.__values__=void 0,o?n.__wrapped__=i:o=i;var n=i;t=t.__wrapped__}return n.__wrapped__=e,o},reverse:function(){var e=this.__wrapped__;if(e instanceof V){var t=e;return this.__actions__.length&&(t=new V(this)),t=t.reverse(),t.__actions__.push({func:wn,args:[cn],thisArg:void 0}),new P(t,this.__chain__)}return this.thru(cn)},tap:function(e,t){return t(e),e},thru:wn,toIterator:function(){return this},toJSON:Ln,value:Ln,valueOf:Ln,wrapperChain:function(){return wt(this)}},n_={camelCase:Qg,capitalize:xt,deburr:yt,endsWith:function(e,t,o){e=qe(e),t=c(t);var i=e.length;o=void 0===o?i:Lt(x(o),0,i);var n=o;return o-=t.length,0<=o&&e.slice(o,n)==t},escape:$o,escapeRegExp:function(e){return e=qe(e),e&&ym.test(e)?e.replace(_m,"\\$&"):e},kebabCase:sx,lowerCase:fx,lowerFirst:ux,pad:function(e,t,o){e=qe(e),t=x(t);var i=t?Ji(e):0;if(!t||i>=t)return e;var n=(t-i)/2;return en(Xu(n),o)+e+en(Yu(n),o)},padEnd:function(e,t,o){e=qe(e),t=x(t);var i=t?Ji(e):0;return t&&i<t?e+en(t-i,o):e},padStart:function(e,t,o){e=qe(e),t=x(t);var i=t?Ji(e):0;return t&&i<t?en(t-i,o)+e:e},parseInt:function(e,t,o){return o||null==t?t=0:t&&(t=+t),Ox(qe(e).replace(Vx,""),t||0)},repeat:function(e,t,o){return t=(o?Ee(e,t,o):void 0===t)?1:x(t),$i(qe(e),t)},replace:function(){var e=arguments,t=qe(e[0]);return 3>e.length?t:t.replace(e[1],e[2])},snakeCase:sb,split:function(e,t,o){return(o&&"number"!=typeof o&&Ee(e,t,o)&&(t=o=void 0),o=void 0===o?4294967295:o>>>0,!o)?[]:(e=qe(e),e&&("string"==typeof t||null!=t&&!ax(t))&&(t=c(t),!t&&ut(e))?ft(ht(e),0,o):e.split(t,o))},startCase:cb,startsWith:function(e,t,o){return e=qe(e),o=null==o?0:Lt(x(o),0,e.length),t=c(t),e.slice(o,o+t.length)==t},template:function(e,t,o){var i=yb.imports._.templateSettings||yb;o&&Ee(e,t,o)&&(t=void 0),e=qe(e),t=Op({},t,i,Cn);var n=Op({},t.imports,i.imports,Cn),a=Ne(n),r=bi(n,a),l=0,s=t.interpolate||Eb,d="__p += '",f=RegExp((t.escape||Eb).source+"|"+s.source+"|"+(s===xb?Cb:Eb).source+"|"+(t.evaluate||Eb).source+"|$","g"),u=Sb.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/[\r\n]/g," ")+"\n":"",c,p;e.replace(f,function(t,o,i,n,a,r){return i||(i=n),d+=e.slice(l,r).replace(Bb,En),o&&(c=!0,d+="' +\n__e("+o+") +\n'"),a&&(p=!0,d+="';\n"+a+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),l=r+t.length,t}),d+="';\n";var g=Sb.call(t,"variable")&&t.variable;g||(d="with (obj) {\n"+d+"\n}\n"),d=(p?d.replace(vb,""):d).replace(Tb,"$1").replace(Ab,"$1;"),d="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(c?", __e = _.escape":"")+(p?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var h=sg(function(){return Function(a,u+"return "+d).apply(void 0,r)});if(h.source=d,rt(h))throw h;return h},templateSettings:yb,toLower:function(e){return qe(e).toLowerCase()},toUpper:function(e){return qe(e).toUpperCase()},trim:function(e,t,o){if(e=qe(e),e&&(o||void 0===t))return e.replace(Lb,"");if(!e||!(t=c(t)))return e;var i=ht(e),n=ht(t),a=In(i,n),r=Dn(i,n)+1;return ft(i,a,r).join("")},trimEnd:function(e,t,o){if(e=qe(e),e&&(o||void 0===t))return e.replace(Db,"");if(!e||!(t=c(t)))return e;var i=ht(e),n=Dn(i,ht(t))+1;return ft(i,0,n).join("")},trimStart:function(e,t,o){if(e=qe(e),e&&(o||void 0===t))return e.replace(Ib,"");if(!e||!(t=c(t)))return e;var i=ht(e),n=In(i,ht(t));return ft(i,n).join("")},truncate:Fn,unescape:function(e){return e=qe(e),e&&Nb.test(e)?e.replace(kb,Rb):e},upperCase:Gb,upperFirst:Cg,words:Ct},a_={attempt:sg,bindAll:fg,cond:function(e){var t=null==e?0:e.length;return e=t?u(e,function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return[_o(e[0]),e[1]]}):[],Te(function(o){for(var i=-1,n;++i<t;)if(n=e[i],R(n[0],this,o))return R(n[1],this,o)})},conforms:function(e){return vo(Zt(e,1))},constant:$,defaultTo:function(e,t){return null==e||e!==e?t:e},flow:wm,flowRight:Sm,identity:b,iteratee:function(e){return _o("function"==typeof e?e:Zt(e,1))},matches:function(e){return uo(Zt(e,1))},matchesProperty:function(e,t){return ho(e,Zt(t,1))},method:hx,methodOf:mx,mixin:Mi,noop:O,nthArg:function(e){return e=x(e),Te(function(t){return zi(t,e)})},over:yx,overEvery:Tx,overSome:Ax,property:bo,propertyOf:function(e){return function(t){return null==e?void 0:Ke(e,t)}},range:ob,rangeRight:ib,stubArray:Nt,stubFalse:De,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(e,t){if(e=x(e),1>e||9007199254740991<e)return[];var o=4294967295,i=Zu(e,4294967295);t=jo(t),e-=4294967295;for(var a=Se(i,t);++o<e;)t(o);return a},toPath:function(e){return uc(e)?u(e,Ze):d(e)?[e]:G(Jp(qe(e)))},uniqueId:kn},r_=qu,l_=Zu,s_=4294967295,d_=Array.prototype,f_=Object.prototype,u_=f_.hasOwnProperty,c_=oc?oc.iterator:void 0,p_=Zu,g_=function(e){return function(t,o,i){if(null==i){var n=g(o),a=n&&Ne(o),r=a&&a.length&&ci(o,a);(r?r.length:n)||(i=o,o=t,t=this)}return e(t,o,i)}}(Mi);U.after=Qb.after,U.ary=Qb.ary,U.assign=o_.assign,U.assignIn=o_.assignIn,U.assignInWith=o_.assignInWith,U.assignWith=o_.assignWith,U.at=o_.at,U.before=Qb.before,U.bind=Qb.bind,U.bindAll=a_.bindAll,U.bindKey=Qb.bindKey,U.castArray=Jb.castArray,U.chain=i_.chain,U.chunk=Kb.chunk,U.compact=Kb.compact,U.concat=Kb.concat,U.cond=a_.cond,U.conforms=a_.conforms,U.constant=a_.constant,U.countBy=$b.countBy,U.create=o_.create,U.curry=Qb.curry,U.curryRight=Qb.curryRight,U.debounce=Qb.debounce,U.defaults=o_.defaults,U.defaultsDeep=o_.defaultsDeep,U.defer=Qb.defer,U.delay=Qb.delay,U.difference=Kb.difference,U.differenceBy=Kb.differenceBy,U.differenceWith=Kb.differenceWith,U.drop=Kb.drop,U.dropRight=Kb.dropRight,U.dropRightWhile=Kb.dropRightWhile,U.dropWhile=Kb.dropWhile,U.fill=Kb.fill,U.filter=$b.filter,U.flatMap=$b.flatMap,U.flatMapDeep=$b.flatMapDeep,U.flatMapDepth=$b.flatMapDepth,U.flatten=Kb.flatten,U.flattenDeep=Kb.flattenDeep,U.flattenDepth=Kb.flattenDepth,U.flip=Qb.flip,U.flow=a_.flow,U.flowRight=a_.flowRight,U.fromPairs=Kb.fromPairs,U.functions=o_.functions,U.functionsIn=o_.functionsIn,U.groupBy=$b.groupBy,U.initial=Kb.initial,U.intersection=Kb.intersection,U.intersectionBy=Kb.intersectionBy,U.intersectionWith=Kb.intersectionWith,U.invert=o_.invert,U.invertBy=o_.invertBy,U.invokeMap=$b.invokeMap,U.iteratee=a_.iteratee,U.keyBy=$b.keyBy,U.keys=Ne,U.keysIn=o_.keysIn,U.map=$b.map,U.mapKeys=o_.mapKeys,U.mapValues=o_.mapValues,U.matches=a_.matches,U.matchesProperty=a_.matchesProperty,U.memoize=Qb.memoize,U.merge=o_.merge,U.mergeWith=o_.mergeWith,U.method=a_.method,U.methodOf=a_.methodOf,U.mixin=g_,U.negate=Hi,U.nthArg=a_.nthArg,U.omit=o_.omit,U.omitBy=o_.omitBy,U.once=Qb.once,U.orderBy=$b.orderBy,U.over=a_.over,U.overArgs=Qb.overArgs,U.overEvery=a_.overEvery,U.overSome=a_.overSome,U.partial=Qb.partial,U.partialRight=Qb.partialRight,U.partition=$b.partition,U.pick=o_.pick,U.pickBy=o_.pickBy,U.property=a_.property,U.propertyOf=a_.propertyOf,U.pull=Kb.pull,U.pullAll=Kb.pullAll,U.pullAllBy=Kb.pullAllBy,U.pullAllWith=Kb.pullAllWith,U.pullAt=Kb.pullAt,U.range=a_.range,U.rangeRight=a_.rangeRight,U.rearg=Qb.rearg,U.reject=$b.reject,U.remove=Kb.remove,U.rest=Qb.rest,U.reverse=Kb.reverse,U.sampleSize=$b.sampleSize,U.set=o_.set,U.setWith=o_.setWith,U.shuffle=$b.shuffle,U.slice=Kb.slice,U.sortBy=$b.sortBy,U.sortedUniq=Kb.sortedUniq,U.sortedUniqBy=Kb.sortedUniqBy,U.split=n_.split,U.spread=Qb.spread,U.tail=Kb.tail,U.take=Kb.take,U.takeRight=Kb.takeRight,U.takeRightWhile=Kb.takeRightWhile,U.takeWhile=Kb.takeWhile,U.tap=i_.tap,U.throttle=Qb.throttle,U.thru=wn,U.toArray=Jb.toArray,U.toPairs=o_.toPairs,U.toPairsIn=o_.toPairsIn,U.toPath=a_.toPath,U.toPlainObject=Jb.toPlainObject,U.transform=o_.transform,U.unary=Qb.unary,U.union=Kb.union,U.unionBy=Kb.unionBy,U.unionWith=Kb.unionWith,U.uniq=Kb.uniq,U.uniqBy=Kb.uniqBy,U.uniqWith=Kb.uniqWith,U.unset=o_.unset,U.unzip=Kb.unzip,U.unzipWith=Kb.unzipWith,U.update=o_.update,U.updateWith=o_.updateWith,U.values=o_.values,U.valuesIn=o_.valuesIn,U.without=Kb.without,U.words=n_.words,U.wrap=Qb.wrap,U.xor=Kb.xor,U.xorBy=Kb.xorBy,U.xorWith=Kb.xorWith,U.zip=Kb.zip,U.zipObject=Kb.zipObject,U.zipObjectDeep=Kb.zipObjectDeep,U.zipWith=Kb.zipWith,U.entries=o_.toPairs,U.entriesIn=o_.toPairsIn,U.extend=o_.assignIn,U.extendWith=o_.assignInWith,g_(U,U),U.add=e_.add,U.attempt=a_.attempt,U.camelCase=n_.camelCase,U.capitalize=n_.capitalize,U.ceil=e_.ceil,U.clamp=t_.clamp,U.clone=Jb.clone,U.cloneDeep=Jb.cloneDeep,U.cloneDeepWith=Jb.cloneDeepWith,U.cloneWith=Jb.cloneWith,U.conformsTo=Jb.conformsTo,U.deburr=n_.deburr,U.defaultTo=a_.defaultTo,U.divide=e_.divide,U.endsWith=n_.endsWith,U.eq=Jb.eq,U.escape=n_.escape,U.escapeRegExp=n_.escapeRegExp,U.every=$b.every,U.find=$b.find,U.findIndex=Kb.findIndex,U.findKey=o_.findKey,U.findLast=$b.findLast,U.findLastIndex=Kb.findLastIndex,U.findLastKey=o_.findLastKey,U.floor=e_.floor,U.forEach=$b.forEach,U.forEachRight=$b.forEachRight,U.forIn=o_.forIn,U.forInRight=o_.forInRight,U.forOwn=o_.forOwn,U.forOwnRight=o_.forOwnRight,U.get=o_.get,U.gt=Jb.gt,U.gte=Jb.gte,U.has=o_.has,U.hasIn=o_.hasIn,U.head=Kb.head,U.identity=b,U.includes=$b.includes,U.indexOf=Kb.indexOf,U.inRange=t_.inRange,U.invoke=o_.invoke,U.isArguments=Jb.isArguments,U.isArray=uc,U.isArrayBuffer=Jb.isArrayBuffer,U.isArrayLike=Jb.isArrayLike,U.isArrayLikeObject=Jb.isArrayLikeObject,U.isBoolean=Jb.isBoolean,U.isBuffer=Jb.isBuffer,U.isDate=Jb.isDate,U.isElement=Jb.isElement,U.isEmpty=Jb.isEmpty,U.isEqual=Jb.isEqual,U.isEqualWith=Jb.isEqualWith,U.isError=Jb.isError,U.isFinite=Jb.isFinite,U.isFunction=Jb.isFunction,U.isInteger=Jb.isInteger,U.isLength=Jb.isLength,U.isMap=Jb.isMap,U.isMatch=Jb.isMatch,U.isMatchWith=Jb.isMatchWith,U.isNaN=Jb.isNaN,U.isNative=Jb.isNative,U.isNil=Jb.isNil,U.isNull=Jb.isNull,U.isNumber=Jb.isNumber,U.isObject=g,U.isObjectLike=Jb.isObjectLike,U.isPlainObject=Jb.isPlainObject,U.isRegExp=Jb.isRegExp,U.isSafeInteger=Jb.isSafeInteger,U.isSet=Jb.isSet,U.isString=Jb.isString,U.isSymbol=Jb.isSymbol,U.isTypedArray=Jb.isTypedArray,U.isUndefined=Jb.isUndefined,U.isWeakMap=Jb.isWeakMap,U.isWeakSet=Jb.isWeakSet,U.join=Kb.join,U.kebabCase=n_.kebabCase,U.last=Po,U.lastIndexOf=Kb.lastIndexOf,U.lowerCase=n_.lowerCase,U.lowerFirst=n_.lowerFirst,U.lt=Jb.lt,U.lte=Jb.lte,U.max=e_.max,U.maxBy=e_.maxBy,U.mean=e_.mean,U.meanBy=e_.meanBy,U.min=e_.min,U.minBy=e_.minBy,U.stubArray=a_.stubArray,U.stubFalse=a_.stubFalse,U.stubObject=a_.stubObject,U.stubString=a_.stubString,U.stubTrue=a_.stubTrue,U.multiply=e_.multiply,U.nth=Kb.nth,U.noop=a_.noop,U.now={now:Qh}.now,U.pad=n_.pad,U.padEnd=n_.padEnd,U.padStart=n_.padStart,U.parseInt=n_.parseInt,U.random=t_.random,U.reduce=$b.reduce,U.reduceRight=$b.reduceRight,U.repeat=n_.repeat,U.replace=n_.replace,U.result=o_.result,U.round=e_.round,U.sample=$b.sample,U.size=$b.size,U.snakeCase=n_.snakeCase,U.some=$b.some,U.sortedIndex=Kb.sortedIndex,U.sortedIndexBy=Kb.sortedIndexBy,U.sortedIndexOf=Kb.sortedIndexOf,U.sortedLastIndex=Kb.sortedLastIndex,U.sortedLastIndexBy=Kb.sortedLastIndexBy,U.sortedLastIndexOf=Kb.sortedLastIndexOf,U.startCase=n_.startCase,U.startsWith=n_.startsWith,U.subtract=e_.subtract,U.sum=e_.sum,U.sumBy=e_.sumBy,U.template=n_.template,U.times=a_.times,U.toFinite=Jb.toFinite,U.toInteger=x,U.toLength=Jb.toLength,U.toLower=n_.toLower,U.toNumber=Jb.toNumber,U.toSafeInteger=Jb.toSafeInteger,U.toString=Jb.toString,U.toUpper=n_.toUpper,U.trim=n_.trim,U.trimEnd=n_.trimEnd,U.trimStart=n_.trimStart,U.truncate=n_.truncate,U.unescape=n_.unescape,U.uniqueId=a_.uniqueId,U.upperCase=n_.upperCase,U.upperFirst=n_.upperFirst,U.each=$b.forEach,U.eachRight=$b.forEachRight,U.first=Kb.head,g_(U,function(){var e={};return Co(U,function(t,o){u_.call(U.prototype,o)||(e[o]=t)}),e}(),{chain:!1}),U.VERSION="4.17.14",(U.templateSettings=n_.templateSettings).imports._=U,Q(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){U[e].placeholder=U}),Q(["drop","take"],function(e,t){V.prototype[e]=function(o){o=void 0===o?1:qu(x(o),0);var i=this.__filtered__&&!t?new V(this):this.clone();return i.__filtered__?i.__takeCount__=p_(o,i.__takeCount__):i.__views__.push({size:p_(o,s_),type:e+(0>i.__dir__?"Right":"")}),i},V.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Q(["filter","map","takeWhile"],function(e,t){var o=t+1;V.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:_o(e,3),type:o}),t.__filtered__=t.__filtered__||o==1||o==3,t}}),Q(["head","last"],function(e,t){var o="take"+(t?"Right":"");V.prototype[e]=function(){return this[o](1).value()[0]}}),Q(["initial","tail"],function(e,t){var o="drop"+(t?"":"Right");V.prototype[e]=function(){return this.__filtered__?new V(this):this[o](1)}}),V.prototype.compact=function(){return this.filter(b)},V.prototype.find=function(e){return this.filter(e).head()},V.prototype.findLast=function(e){return this.reverse().find(e)},V.prototype.invokeMap=Te(function(e,t){return"function"==typeof e?new V(this):this.map(function(o){return Ei(o,e,t)})}),V.prototype.reject=function(e){return this.filter(Hi(_o(e)))},V.prototype.slice=function(e,t){e=x(e);var o=this;return o.__filtered__&&(0<e||0>t)?new V(o):(0>e?o=o.takeRight(-e):e&&(o=o.drop(e)),void 0!==t&&(t=x(t),o=0>t?o.dropRight(-t):o.take(t-e)),o)},V.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},V.prototype.toArray=function(){return this.take(s_)},Co(V.prototype,function(e,t){var o=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),n=U[i?"take"+("last"==t?"Right":""):t],a=i||/^find/.test(t);n&&(U.prototype[t]=function(){var t=this.__wrapped__,r=i?[1]:arguments,l=t instanceof V,s=r[0],d=l||uc(t),f=function(e){var t=n.apply(U,Je([e],r));return i&&u?t[0]:t};d&&o&&"function"==typeof s&&1!=s.length&&(l=d=!1);var u=this.__chain__,c=!!this.__actions__.length,p=a&&!u,g=l&&!c;if(!a&&d){t=g?t:new V(this);var h=e.apply(t,r);return h.__actions__.push({func:wn,args:[f],thisArg:void 0}),new P(h,u)}return p&&g?e.apply(this,r):(h=this.thru(f),p?i?h.value()[0]:h.value():h)})}),Q(["pop","push","shift","sort","splice","unshift"],function(e){var t=d_[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);U.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var n=this.value();return t.apply(uc(n)?n:[],e)}return this[o](function(o){return t.apply(uc(o)?o:[],e)})}}),Co(V.prototype,function(e,t){var o=U[t];if(o){var i=o.name+"";u_.call(Gc,i)||(Gc[i]=[]),Gc[i].push({name:t,func:o})}}),Gc[ce(void 0,2).name]=[{name:"wrapper",func:void 0}],V.prototype.clone=function(){var e=new V(this.__wrapped__);return e.__actions__=G(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=G(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=G(this.__views__),e},V.prototype.reverse=function(){if(this.__filtered__){var e=new V(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e},V.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,o=uc(e),i=0>t,n=o?e.length:0,a=zn(0,n,this.__views__),r=a.start,l=a.end,s=l-r,d=i?l:r-1,f=this.__iteratees__,u=f.length,c=0,p=Zu(s,this.__takeCount__);if(!o||!i&&n==s&&p==s)return Sn(e,this.__actions__);var g=[];outer:for(;s--&&c<p;){d+=t;for(var h=-1,m=e[d];++h<u;){var x=f[h],b=x.iteratee,_=x.type,y=b(m);if(_==2)m=y;else if(!y)if(1==_)continue outer;else break outer}g[c++]=m}return g},U.prototype.at=i_.at,U.prototype.chain=i_.wrapperChain,U.prototype.commit=i_.commit,U.prototype.next=i_.next,U.prototype.plant=i_.plant,U.prototype.reverse=i_.reverse,U.prototype.toJSON=U.prototype.valueOf=U.prototype.value=i_.value,U.prototype.first=U.prototype.head,c_&&(U.prototype[c_]=i_.toIterator);(function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o?i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}})(".gl-tilelayer-tile {\n  -ms-interpolation-mode: nearest-neighbor;\n      image-rendering: -moz-crisp-edges;\n      image-rendering: pixelated;\n  image-rendering: crisp-edges;\n}\n");var h_="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window,m_=Gn(function(e){(function(t,o){e.exports=o()})(h_,function(){function e(e){return"undefined"==typeof atob?"base64:"+e:atob(e)}function t(e){var t=new Error("(regl) "+e);throw console.error(t),t}function o(e,o){e||t(o)}function i(e){return e?": "+e:""}function n(e,o,n){e in o||t("unknown parameter ("+e+")"+i(n)+". possible values: "+Object.keys(o).join())}function a(e,t){return"number"===t?"number"==typeof e:"object"===t?"object"==typeof e:"string"===t?"string"==typeof e:"boolean"===t?"boolean"==typeof e:"function"===t?"function"==typeof e:"undefined"===t?"undefined"==typeof e:"symbol"===t?"symbol"==typeof e:void 0}function r(e,o,n){0>o.indexOf(e)&&t("invalid value"+i(n)+". must be one of: "+o)}function l(e,t){for(e+="";e.length<t;)e=" "+e;return e}function s(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function d(e,t){this.number=e,this.line=t,this.errors=[]}function f(e,t,o){this.file=e,this.line=t,this.message=o}function u(){var e=new Error,t=(e.stack||e).toString(),o=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(o)return o[1];var i=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return i?i[1]:"unknown"}function c(){var e=new Error,t=(e.stack||e).toString(),o=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(o)return o[1];var i=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return i?i[1]:"unknown"}function p(t,o){var n=t.split("\n"),a=1,r=0,l={unknown:new s,0:new s};l.unknown.name=l[0].name=o||u(),l.unknown.lines.push(new d(0,""));for(var f=0;f<n.length;++f){var c=n[f],p=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(c);if(p)switch(p[1]){case"line":var g=/(\d+)(\s+\d+)?/.exec(p[2]);g&&(a=0|g[1],g[2]&&(r=0|g[2],!(r in l)&&(l[r]=new s)));break;case"define":var h=/SHADER_NAME(_B64)?\s+(.*)$/.exec(p[2]);h&&(l[r].name=h[1]?e(h[2]):h[2]);}l[r].lines.push(new d(a++,c))}return Object.keys(l).forEach(function(e){var t=l[e];t.lines.forEach(function(e){t.index[e.number]=e})}),l}function g(e){var t=[];return e.split("\n").forEach(function(e){if(!(5>e.length)){var o=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);o?t.push(new f(0|o[1],0|o[2],o[3].trim())):0<e.length&&t.push(new f("unknown",0,e))}}),t}function h(e,t){t.forEach(function(t){var o=e[t.file];if(o){var i=o.index[t.line];if(i)return i.errors.push(t),void(o.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)})}function m(e){e._commandRef=u()}function x(e,t,o,i){function n(e){return e?i.id(e):0}function a(e,t){Object.keys(t).forEach(function(t){e[i.id(t)]=!0})}m(e),e._fragId=n(e.static.frag),e._vertId=n(e.static.vert);var r=e._uniformSet={};a(r,t.static),a(r,t.dynamic);var l=e._attributeSet={};a(l,o.static),a(l,o.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic}function b(e,o){var i=c();t(e+" in command "+(o||u())+("unknown"===i?"":" called from "+i))}function _(e,t,o,n){e in t||b("unknown parameter ("+e+")"+i(o)+". possible values: "+Object.keys(t).join(),n||u())}function y(e,t,o,n){a(e,t)||b("invalid parameter type"+i(o)+". expected "+t+", got "+typeof e,n||u())}function v(e,t){return 32820===e||32819===e||33635===e?2:34042===e?4:Ve[e]*t}function T(e){return!(e&e-1)&&!!e}function A(e,t){this.id=ze++,this.type=e,this.data=t}function C(e){return e.replace(/\\/g,"\\\\").replace(/"/g,"\\\"")}function E(e){if(0===e.length)return[];var t=e.charAt(0),o=e.charAt(e.length-1);if(1<e.length&&t===o&&("\""===t||"'"===t))return["\""+C(e.substr(1,e.length-2))+"\""];var n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(n)return E(e.substr(0,n.index)).concat(E(n[1])).concat(E(e.substr(n.index+n[0].length)));var a=e.split(".");if(1===a.length)return["\""+C(e)+"\""];for(var r=[],l=0;l<a.length;++l)r=r.concat(E(a[l]));return r}function B(e){return"["+E(e).join("][")+"]"}function w(){var e={"":0},t=[""];return{id:function(o){var i=e[o];return i?i:(i=e[o]=t.length,t.push(o),i)},str:function(e){return t[e]}}}function S(e,t,o){function i(){var t=window.innerWidth,i=window.innerHeight;if(e!==document.body){var n=e.getBoundingClientRect();t=n.right-n.left,i=n.bottom-n.top}a.width=o*t,a.height=o*i,Me(a.style,{width:t+"px",height:i+"px"})}function n(){r?r.disconnect():window.removeEventListener("resize",i),e.removeChild(a)}var a=document.createElement("canvas");Me(a.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(a),e===document.body&&(a.style.position="absolute",Me(e.style,{margin:0,padding:0}));var r;return e!==document.body&&"function"==typeof ResizeObserver?(r=new ResizeObserver(function(){setTimeout(i)}),r.observe(e)):window.addEventListener("resize",i,!1),i(),{canvas:a,onDestroy:n}}function D(e,t){function o(o){try{return e.getContext(o,t)}catch(t){return null}}return o("webgl")||o("experimental-webgl")||o("webgl-experimental")}function I(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}function F(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}function R(e){return"string"==typeof e?e.split():(Oe(Array.isArray(e),"invalid extension array"),e)}function k(e){return"string"==typeof e?(Oe("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function N(e){var t=e||{},o={},i=[],n=[],a="undefined"==typeof window?1:window.devicePixelRatio,r=!1,l=function(e){e&&Oe.raise(e)},s=function(){},d,f,u,c;if("string"==typeof t?(Oe("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),d=document.querySelector(t),Oe(d,"invalid query string for element")):"object"==typeof t?I(t)?d=t:F(t)?(c=t,u=c.canvas):(Oe.constructor(t),"gl"in t?c=t.gl:"canvas"in t?u=k(t.canvas):"container"in t&&(f=k(t.container)),"attributes"in t&&(o=t.attributes,Oe.type(o,"object","invalid context attributes")),"extensions"in t&&(i=R(t.extensions)),"optionalExtensions"in t&&(n=R(t.optionalExtensions)),"onDone"in t&&(Oe.type(t.onDone,"function","invalid or missing onDone callback"),l=t.onDone),"profile"in t&&(r=!!t.profile),"pixelRatio"in t&&(a=+t.pixelRatio,Oe(0<a,"invalid pixel ratio"))):Oe.raise("invalid arguments to regl"),d&&("canvas"===d.nodeName.toLowerCase()?u=d:f=d),!c){if(!u){Oe("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var p=S(f||document.body,l,a);if(!p)return null;u=p.canvas,s=p.onDestroy}o.premultipliedAlpha=o.premultipliedAlpha||!1,c=D(u,o)}return c?{gl:c,canvas:u,container:f,extensions:i,optionalExtensions:n,pixelRatio:a,profile:r,onDone:l,onDestroy:s}:(s(),l("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function M(e,t){function o(t){Oe.type(t,"string","extension name must be string");var o=t.toLowerCase(),i;try{i=n[o]=e.getExtension(o)}catch(t){}return!!i}for(var n={},a=0,r;a<t.extensions.length;++a)if(r=t.extensions[a],!o(r))return t.onDestroy(),t.onDone("\""+r+"\" extension is not supported by the current WebGL context, try upgrading your system or a different browser"),null;return t.optionalExtensions.forEach(o),{extensions:n,restore:function(){Object.keys(n).forEach(function(e){if(n[e]&&!o(e))throw new Error("(regl): error restoring extension "+e)})}}}function H(e,t){for(var o=Array(e),n=0;n<e;++n)o[n]=t(n);return o}function V(e){for(var t=16;t<=268435456;t*=16)if(e<=t)return t;return 0}function O(e){var t,o;return t=(65535<e)<<4,e>>>=t,o=(255<e)<<3,e>>>=o,t|=o,o=(15<e)<<2,e>>>=o,t|=o,o=(3<e)<<1,e>>>=o,t|=o,t|e>>1}function z(){function e(e){var t=V(e),i=o[O(t)>>2];return 0<i.length?i.pop():new ArrayBuffer(t)}function t(e){o[O(e.byteLength)>>2].push(e)}var o=H(8,function(){return[]});return{alloc:e,free:t,allocType:function(t,o){var i=null;switch(t){case 5120:i=new Int8Array(e(o),0,o);break;case 5121:i=new Uint8Array(e(o),0,o);break;case 5122:i=new Int16Array(e(2*o),0,o);break;case 5123:i=new Uint16Array(e(2*o),0,o);break;case 5124:i=new Int32Array(e(4*o),0,o);break;case 5125:i=new Uint32Array(e(4*o),0,o);break;case 5126:i=new Float32Array(e(4*o),0,o);break;default:return null;}return i.length===o?i:i.subarray(0,o)},freeType:function(e){t(e.buffer)}}}function P(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||Ne(e.data))}function G(e,t,o){for(var n=0;n<t;++n)o[n]=e[n]}function j(e,t,o,n){for(var a=0,r=0,l;r<t;++r){l=e[r];for(var s=0;s<o;++s)n[a++]=l[s]}}function U(e,t,o,n,a,r){for(var l=r,s=0,d;s<t;++s){d=e[s];for(var f=0,u;f<o;++f){u=d[f];for(var c=0;c<n;++c)a[l++]=u[c]}}}function W(e,t,o,a,r){for(var l=1,s=o+1;s<t.length;++s)l*=t[s];var d=t[o];if(4==t.length-o){var n=t[o+1],f=t[o+2],u=t[o+3];for(s=0;s<d;++s)U(e[s],n,f,u,a,r),r+=l}else for(s=0;s<d;++s)W(e[s],t,o+1,a,r),r+=l}function X(e){return 0|et[Object.prototype.toString.call(e)]}function q(e,t){for(var o=0;o<t.length;++o)e[o]=t[o]}function Y(e,t,o,n,a,r,l){for(var s=0,d=0;d<o;++d)for(var f=0;f<n;++f)e[s++]=t[a*d+r*f+l]}function Z(e,t,o,i){function n(t){this.id=s++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,o.profile&&(this.stats={size:0})}function a(t,o,i){t.byteLength=o.byteLength,e.bufferData(t.type,o,i)}function r(e,t,o,n,r,l){var s;if(e.usage=o,Array.isArray(t)){if(e.dtype=n||5126,0<t.length){var d;if(Array.isArray(t[0])){s=nt(t);for(var f=1,u=1;u<s.length;++u)f*=s[u];e.dimension=f,d=it(t,s,e.dtype),a(e,d,o),l?e.persistentData=d:Ue.freeType(d)}else if("number"==typeof t[0]){e.dimension=r;var c=Ue.allocType(e.dtype,t.length);q(c,t),a(e,c,o),l?e.persistentData=c:Ue.freeType(c)}else Ne(t[0])?(e.dimension=t[0].length,e.dtype=n||X(t[0])||5126,d=it(t,[t.length,t[0].length],e.dtype),a(e,d,o),l?e.persistentData=d:Ue.freeType(d)):Oe.raise("invalid buffer data")}}else if(Ne(t))e.dtype=n||X(t),e.dimension=r,a(e,t,o),l&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(P(t)){s=t.shape;var p=t.stride,g=t.offset,h=0,m=0,x=0,b=0;1===s.length?(h=s[0],m=1,x=p[0],b=0):2===s.length?(h=s[0],m=s[1],x=p[0],b=p[1]):Oe.raise("invalid shape"),e.dtype=n||X(t.data)||5126,e.dimension=m;var _=Ue.allocType(e.dtype,h*m);Y(_,t.data,h,m,x,b,g),a(e,_,o),l?e.persistentData=_:Ue.freeType(_)}else t instanceof ArrayBuffer?(e.dtype=5121,e.dimension=r,a(e,t,o),l&&(e.persistentData=new Uint8Array(new Uint8Array(t)))):Oe.raise("invalid buffer data")}function l(o){t.bufferCount--,i(o);var n=o.buffer;Oe(n,"buffer must not be deleted already"),e.deleteBuffer(n),o.buffer=null,delete d[o.id]}var s=0,d={};n.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},n.prototype.destroy=function(){l(this)};var f=[];return o.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(d).forEach(function(t){e+=d[t].stats.size}),e}),{create:function(i,a,s,f){function u(t){var i=35044,n=null,a=0,l=0,s=1;return Array.isArray(t)||Ne(t)||P(t)||t instanceof ArrayBuffer?n=t:"number"==typeof t?a=0|t:t&&(Oe.type(t,"object","buffer arguments must be an object, a number or an array"),"data"in t&&(Oe(null===n||Array.isArray(n)||Ne(n)||P(n),"invalid data for buffer"),n=t.data),"usage"in t&&(Oe.parameter(t.usage,ot,"invalid buffer usage"),i=ot[t.usage]),"type"in t&&(Oe.parameter(t.type,tt,"invalid buffer type"),l=tt[t.type]),"dimension"in t&&(Oe.type(t.dimension,"number","invalid dimension"),s=0|t.dimension),"length"in t&&(Oe.nni(a,"buffer length must be a nonnegative integer"),a=0|t.length)),p.bind(),n?r(p,n,i,l,s,f):(a&&e.bufferData(p.type,a,i),p.dtype=l||5121,p.usage=i,p.dimension=s,p.byteLength=a),o.profile&&(p.stats.size=p.byteLength*at[p.dtype]),u}function c(t,o){Oe(o+t.byteLength<=p.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+o+" to a buffer of size "+p.byteLength),e.bufferSubData(p.type,o,t)}t.bufferCount++;var p=new n(a);return d[p.id]=p,s||u(i),u._reglType="buffer",u._buffer=p,u.subdata=function(e,t){var o=0|(t||0),i;if(p.bind(),Ne(e)||e instanceof ArrayBuffer)c(e,o);else if(Array.isArray(e)){if(0<e.length)if("number"==typeof e[0]){var n=Ue.allocType(p.dtype,e.length);q(n,e),c(n,o),Ue.freeType(n)}else if(Array.isArray(e[0])||Ne(e[0])){i=nt(e);var a=it(e,i,p.dtype);c(a,o),Ue.freeType(a)}else Oe.raise("invalid buffer data");}else if(P(e)){i=e.shape;var r=e.stride,l=0,s=0,d=0,f=0;1===i.length?(l=i[0],s=1,d=r[0],f=0):2===i.length?(l=i[0],s=i[1],d=r[0],f=r[1]):Oe.raise("invalid shape");var g=Array.isArray(e.data)?p.dtype:X(e.data),h=Ue.allocType(g,l*s);Y(h,e.data,l,s,d,f,e.offset),c(h,o),Ue.freeType(h)}else Oe.raise("invalid data for buffer subdata");return u},o.profile&&(u.stats=p.stats),u.destroy=function(){l(p)},u},createStream:function(e,t){var o=f.pop();return o||(o=new n(e)),o.bind(),r(o,t,35040,0,1,!1),o},destroyStream:function(e){f.push(e)},clear:function(){Qe(d).forEach(l),f.forEach(l)},getBuffer:function(e){return e&&e._buffer instanceof n?e._buffer:null},restore:function(){Qe(d).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:r}}function K(e,t,o,i){function n(e){this.id=s++,l[this.id]=this,this.buffer=e,this.primType=4,this.vertCount=0,this.type=0}function a(i,n,a,r,l,s,d){i.buffer.bind();var f;if(n){var u=d;d||Ne(n)&&(!P(n)||Ne(n.data))||(u=t.oes_element_index_uint?5125:5123),o._initBuffer(i.buffer,n,a,u,3)}else e.bufferData(34963,s,a),i.buffer.dtype=f||5121,i.buffer.usage=a,i.buffer.dimension=3,i.buffer.byteLength=s;if(f=d,!d){switch(i.buffer.dtype){case 5121:case 5120:f=5121;break;case 5123:case 5122:f=5123;break;case 5125:case 5124:f=5125;break;default:Oe.raise("unsupported type for element array");}i.buffer.dtype=f}i.type=f,Oe(5125!==f||!!t.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var c=l;0>c&&(c=i.buffer.byteLength,5123===f?c>>=1:5125===f&&(c>>=2)),i.vertCount=c;var p=r;if(0>r){p=4;var g=i.buffer.dimension;1===g&&(p=0),2===g&&(p=1),3===g&&(p=4)}i.primType=p}function r(e){i.elementsCount--,Oe(null!==e.buffer,"must not double destroy elements"),delete l[e.id],e.buffer.destroy(),e.buffer=null}var l={},s=0,d={uint8:5121,uint16:5123};t.oes_element_index_uint&&(d.uint32=5125),n.prototype.bind=function(){this.buffer.bind()};var f=[];return{create:function(e){function t(e){if(!e)l(),s.primType=4,s.vertCount=0,s.type=5121;else if("number"==typeof e)l(e),s.primType=4,s.vertCount=0|e,s.type=5121;else{var o=null,i=35044,n=-1,r=-1,f=0,u=0;Array.isArray(e)||Ne(e)||P(e)?o=e:(Oe.type(e,"object","invalid arguments for elements"),"data"in e&&(o=e.data,Oe(Array.isArray(o)||Ne(o)||P(o),"invalid data for element buffer")),"usage"in e&&(Oe.parameter(e.usage,ot,"invalid element buffer usage"),i=ot[e.usage]),"primitive"in e&&(Oe.parameter(e.primitive,rt,"invalid element buffer primitive"),n=rt[e.primitive]),"count"in e&&(Oe("number"==typeof e.count&&0<=e.count,"invalid vertex count for elements"),r=0|e.count),"type"in e&&(Oe.parameter(e.type,d,"invalid buffer type"),u=d[e.type]),"length"in e?f=0|e.length:(f=r,5123===u||5122===u?f*=2:(5125===u||5124===u)&&(f*=4))),a(s,o,i,n,r,f,u)}return t}var l=o.create(null,34963,!0),s=new n(l._buffer);return i.elementsCount++,t(e),t._reglType="elements",t._elements=s,t.subdata=function(e,o){return l.subdata(e,o),t},t.destroy=function(){r(s)},t},createStream:function(e){var t=f.pop();return t||(t=new n(o.create(null,34963,!0,!1)._buffer)),a(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){f.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof n?e._elements:null},clear:function(){Qe(l).forEach(r)}}}function $(e){for(var t=Ue.allocType(5123,e.length),o=0;o<e.length;++o)if(isNaN(e[o]))t[o]=65535;else if(e[o]===1/0)t[o]=31744;else if(e[o]===-Infinity)t[o]=64512;else{lt[0]=e[o];var n=st[0],a=n>>>31<<15,r=(n<<1>>>24)-127,l=n>>13&1023;if(-24>r)t[o]=a;else if(-14>r){t[o]=a+(l+1024>>-14-r)}else t[o]=15<r?a+31744:a+(r+15<<10)+l}return t}function Q(e){return Array.isArray(e)||Ne(e)}function J(e){return"[object "+e+"]"}function ee(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function te(e){if(!Array.isArray(e))return!1;var t=e.length;return!!(0!==t&&Q(e[0]))}function oe(e){return Object.prototype.toString.call(e)}function ie(e){return oe(e)===bt}function ne(e){return oe(e)===_t}function ae(e){return oe(e)===yt}function re(e){return oe(e)===vt}function le(e){return oe(e)===Tt}function se(e){return oe(e)===At}function de(e){if(!e)return!1;var t=oe(e);return!!(0<=Ct.indexOf(t))||ee(e)||te(e)||P(e)}function fe(e){return 0|et[Object.prototype.toString.call(e)]}function ue(e,t){var o=t.length;switch(e.type){case 5121:case 5123:case 5125:case 5126:var i=Ue.allocType(e.type,o);i.set(t),e.data=i;break;case 36193:e.data=$(t);break;default:Oe.raise("unsupported texture type, must specify a typed array");}}function ce(e,t){return Ue.allocType(e.type===36193?5126:e.type,t)}function pe(e,t){e.type===36193?(e.data=$(t),Ue.freeType(t)):e.data=t}function ge(e,t,o,n,a,r){for(var l=e.width,s=e.height,d=e.channels,f=ce(e,l*s*d),u=0,c=0;c<s;++c)for(var g=0;g<l;++g)for(var h=0;h<d;++h)f[u++]=t[o*g+n*c+a*h+r];pe(e,f)}function he(e,t,o,i,n,a){var r;if(r="undefined"==typeof Bt[e]?xt[e]*Et[t]:Bt[e],a&&(r*=6),n){for(var l=0,d=o;1<=d;)l+=r*d*d,d/=2;return l}return r*o*i}function me(e,t,o,i,n,r,l){function s(){this.internalformat=6408,this.format=6408,this.type=5121,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function d(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function f(e,i){if("object"==typeof i&&i){if("premultiplyAlpha"in i&&(Oe.type(i.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=i.premultiplyAlpha),"flipY"in i&&(Oe.type(i.flipY,"boolean","invalid texture flip"),e.flipY=i.flipY),"alignment"in i&&(Oe.oneOf(i.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=i.alignment),"colorSpace"in i&&(Oe.parameter(i.colorSpace,H,"invalid colorSpace"),e.colorSpace=H[i.colorSpace]),"type"in i){var n=i.type;Oe(t.oes_texture_float||"float"!==n&&"float32"!==n,"you must enable the OES_texture_float extension in order to use floating point textures."),Oe(t.oes_texture_half_float||"half float"!==n&&"float16"!==n,"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Oe(t.webgl_depth_texture||"uint16"!==n&&"uint32"!==n&&"depth stencil"!==n,"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Oe.parameter(n,V,"invalid texture type"),e.type=V[n]}var a=e.width,r=e.height,l=e.channels,s=!1;"shape"in i?(Oe(Array.isArray(i.shape)&&2<=i.shape.length,"shape must be an array"),a=i.shape[0],r=i.shape[1],3===i.shape.length&&(l=i.shape[2],Oe(0<l&&4>=l,"invalid number of channels"),s=!0),Oe(0<=a&&a<=o.maxTextureSize,"invalid width"),Oe(0<=r&&r<=o.maxTextureSize,"invalid height")):("radius"in i&&(a=r=i.radius,Oe(0<=a&&a<=o.maxTextureSize,"invalid radius")),"width"in i&&(a=i.width,Oe(0<=a&&a<=o.maxTextureSize,"invalid width")),"height"in i&&(r=i.height,Oe(0<=r&&r<=o.maxTextureSize,"invalid height")),"channels"in i&&(l=i.channels,Oe(0<l&&4>=l,"invalid number of channels"),s=!0)),e.width=0|a,e.height=0|r,e.channels=0|l;var d=!1;if("format"in i){var f=i.format;Oe(t.webgl_depth_texture||"depth"!==f&&"depth stencil"!==f,"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Oe.parameter(f,O,"invalid texture format");var u=e.internalformat=O[f];e.format=Z[u],f in V&&!("type"in i)&&(e.type=V[f]),f in z&&(e.compressed=!0),d=!0}!s&&d?e.channels=xt[e.format]:s&&!d?e.channels!==mt[e.format]&&(e.format=e.internalformat=mt[e.channels]):d&&s&&Oe(e.channels===xt[e.format],"number of channels inconsistent with specified format")}}function u(t){e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(37443,t.colorSpace),e.pixelStorei(3317,t.unpackAlignment)}function c(){s.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function p(e,t){var i=null;if(de(t)?i=t:t&&(Oe.type(t,"object","invalid pixel data type"),f(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),de(t.data)&&(i=t.data)),Oe(!e.compressed||i instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),t.copy){Oe(!i,"can not specify copy and data field for the same texture");var a=n.viewportWidth,r=n.viewportHeight;e.width=e.width||a-e.xOffset,e.height=e.height||r-e.yOffset,e.needsCopy=!0,Oe(0<=e.xOffset&&e.xOffset<a&&0<=e.yOffset&&e.yOffset<r&&0<e.width&&e.width<=a&&0<e.height&&e.height<=r,"copy texture read out of bounds")}else if(!i)e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;else if(Ne(i))e.channels=e.channels||4,e.data=i,"type"in t||5121!==e.type||(e.type=fe(i));else if(ee(i))e.channels=e.channels||4,ue(e,i),e.alignment=1,e.needsFree=!0;else if(P(i)){var l=i.data;Array.isArray(l)||5121!==e.type||(e.type=fe(l));var s=i.shape,d=i.stride,u,p,g,m,x,b;3===s.length?(g=s[2],b=d[2]):(Oe(2===s.length,"invalid ndarray pixel data, must be 2 or 3D"),g=1,b=1),u=s[0],p=s[1],m=d[0],x=d[1],e.alignment=1,e.width=u,e.height=p,e.channels=g,e.format=e.internalformat=mt[g],e.needsFree=!0,ge(e,l,m,x,b,i.offset)}else if(ie(i)||ne(i)||ae(i))e.element=ie(i)||ne(i)?i:i.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(re(i))e.element=i,e.width=i.width,e.height=i.height,e.channels=4;else if(le(i))e.element=i,e.width=i.naturalWidth,e.height=i.naturalHeight,e.channels=4;else if(se(i))e.element=i,e.width=i.videoWidth,e.height=i.videoHeight,e.channels=4;else if(te(i)){var _=e.width||i[0].length,y=e.height||i.length,h=e.channels;h=Q(i[0][0])?h||i[0][0].length:h||1;for(var v=Je.shape(i),T=1,A=0;A<v.length;++A)T*=v[A];var C=ce(e,T);Je.flatten(i,v,"",C),pe(e,C),e.alignment=1,e.width=_,e.height=y,e.channels=h,e.format=e.internalformat=mt[h],e.needsFree=!0}5126===e.type?Oe(0<=o.extensions.indexOf("oes_texture_float"),"oes_texture_float extension not enabled"):36193===e.type&&Oe(0<=o.extensions.indexOf("oes_texture_half_float"),"oes_texture_half_float extension not enabled")}function g(t,o,n){var a=t.element,r=t.data,l=t.internalformat,s=t.format,d=t.type,f=t.width,c=t.height;u(t),a?e.texImage2D(o,n,s,s,d,a):t.compressed?e.compressedTexImage2D(o,n,l,f,c,0,r):t.needsCopy?(i(),e.copyTexImage2D(o,n,s,t.xOffset,t.yOffset,f,c,0)):e.texImage2D(o,n,s,f,c,0,s,d,r||null)}function h(t,o,n,a,r){var l=t.element,s=t.data,d=t.internalformat,f=t.format,c=t.type,p=t.width,g=t.height;u(t),l?e.texSubImage2D(o,r,n,a,f,c,l):t.compressed?e.compressedTexSubImage2D(o,r,n,a,d,p,g,s):t.needsCopy?(i(),e.copyTexSubImage2D(o,r,n,a,t.xOffset,t.yOffset,p,g)):e.texSubImage2D(o,r,n,a,p,g,f,c,s)}function m(){return K.pop()||new c}function b(e){e.needsFree&&Ue.freeType(e.data),c.call(e),K.push(e)}function _(){s.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function y(e,t,o){var i=e.images[0]=m();e.mipmask=1,i.width=e.width=t,i.height=e.height=o,i.channels=e.channels=4}function v(e,t){var o=null;if(de(t))o=e.images[0]=m(),d(o,e),p(o,t),e.mipmask=1;else if(f(e,t),Array.isArray(t.mipmap))for(var n=t.mipmap,a=0;a<n.length;++a)o=e.images[a]=m(),d(o,e),o.width>>=a,o.height>>=a,p(o,n[a]),e.mipmask|=1<<a;else o=e.images[0]=m(),d(o,e),p(o,t),e.mipmask=1;d(e,e.images[0]),e.compressed&&(33776===e.internalformat||33777===e.internalformat||33778===e.internalformat||33779===e.internalformat)&&Oe(0==e.width%4&&0==e.height%4,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function T(e,t){for(var o=e.images,n=0;n<o.length;++n){if(!o[n])return;g(o[n],t,n)}}function A(){var e=$.pop()||new _;s.call(e),e.mipmask=0;for(var t=0;16>t;++t)e.images[t]=null;return e}function C(e){for(var t=e.images,o=0;o<t.length;++o)t[o]&&b(t[o]),t[o]=null;$.push(e)}function E(){this.minFilter=9728,this.magFilter=9728,this.wrapS=33071,this.wrapT=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function B(e,t){if("min"in t){var i=t.min;Oe.parameter(i,M),e.minFilter=M[i],0<=ht.indexOf(e.minFilter)&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var n=t.mag;Oe.parameter(n,N),e.magFilter=N[n]}var a=e.wrapS,r=e.wrapT;if("wrap"in t){var l=t.wrap;"string"==typeof l?(Oe.parameter(l,k),a=r=k[l]):Array.isArray(l)&&(Oe.parameter(l[0],k),Oe.parameter(l[1],k),a=k[l[0]],r=k[l[1]])}else{if("wrapS"in t){var s=t.wrapS;Oe.parameter(s,k),a=k[s]}if("wrapT"in t){var d=t.wrapT;Oe.parameter(d,k),r=k[d]}}if(e.wrapS=a,e.wrapT=r,"anisotropic"in t){var f=t.anisotropic;Oe("number"==typeof f&&1<=f&&f<=o.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var u=!1;switch(typeof t.mipmap){case"string":Oe.parameter(t.mipmap,R,"invalid mipmap hint"),e.mipmapHint=R[t.mipmap],e.genMipmaps=!0,u=!0;break;case"boolean":u=e.genMipmaps=t.mipmap;break;case"object":Oe(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,u=!0;break;default:Oe.raise("invalid mipmap type");}u&&!("min"in t)&&(e.minFilter=9984)}}function w(o,i){e.texParameteri(i,10241,o.minFilter),e.texParameteri(i,10240,o.magFilter),e.texParameteri(i,10242,o.wrapS),e.texParameteri(i,10243,o.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(i,34046,o.anisotropic),o.genMipmaps&&(e.hint(33170,o.mipmapHint),e.generateMipmap(i))}function S(t){s.call(this),this.mipmask=0,this.internalformat=6408,this.id=J++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new E,l.profile&&(this.stats={size:0})}function D(t){e.activeTexture(33984),e.bindTexture(t.target,t.texture)}function I(){var t=xe[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function F(t){var o=t.texture;Oe(o,"must not double destroy texture");var i=t.unit,n=t.target;0<=i&&(e.activeTexture(33984+i),e.bindTexture(n,null),xe[i]=null),e.deleteTexture(o),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete oe[t.id],r.textureCount--}var R={"don't care":4352,"dont care":4352,nice:4354,fast:4353},k={repeat:10497,clamp:33071,mirror:33648},N={nearest:9728,linear:9729},M=Me({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},N),H={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},O={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},z={};t.ext_srgb&&(O.srgb=35904,O.srgba=35906),t.oes_texture_float&&(V.float32=V.float=5126),t.oes_texture_half_float&&(V.float16=V["half float"]=36193),t.webgl_depth_texture&&(Me(O,{depth:6402,"depth stencil":34041}),Me(V,{uint16:5123,uint32:5125,"depth stencil":34042})),t.webgl_compressed_texture_s3tc&&Me(z,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),t.webgl_compressed_texture_atc&&Me(z,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),t.webgl_compressed_texture_pvrtc&&Me(z,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),t.webgl_compressed_texture_etc1&&(z["rgb etc1"]=36196);var G=Array.prototype.slice.call(e.getParameter(34467));Object.keys(z).forEach(function(e){var t=z[e];0<=G.indexOf(t)&&(O[e]=t)});var j=Object.keys(O);o.textureFormats=j;var U=[];Object.keys(O).forEach(function(e){var t=O[e];U[t]=e});var W=[];Object.keys(V).forEach(function(e){var t=V[e];W[t]=e});var X=[];Object.keys(N).forEach(function(e){var t=N[e];X[t]=e});var q=[];Object.keys(M).forEach(function(e){var t=M[e];q[t]=e});var Y=[];Object.keys(k).forEach(function(e){var t=k[e];Y[t]=e});var Z=j.reduce(function(e,o){var i=O[o];return e[i]=6409===i||6406===i||6409===i||6410===i||6402===i||34041===i||t.ext_srgb&&(35904===i||35906===i)?i:32855===i||0<=o.indexOf("rgba")?6408:6407,e},{}),K=[],$=[],J=0,oe={},me=o.maxTextureUnits,xe=Array(me).map(function(){return null});return Me(S.prototype,{bind:function(){var t=this;t.bindCount+=1;var o=t.unit;if(0>o){for(var n=0,a;n<me;++n){if(a=xe[n],a){if(0<a.bindCount)continue;a.unit=-1}xe[n]=t,o=n;break}o>=me&&Oe.raise("insufficient number of texture units"),l.profile&&r.maxTextureUnits<o+1&&(r.maxTextureUnits=o+1),t.unit=o,e.activeTexture(33984+o),e.bindTexture(t.target,t.texture)}return o},unbind:function(){this.bindCount-=1},decRef:function(){0>=--this.refCount&&F(this)}}),l.profile&&(r.getTotalTextureSize=function(){var e=0;return Object.keys(oe).forEach(function(t){e+=oe[t].stats.size}),e}),{create2D:function(t,i){function n(e,t){var i=s.texInfo;E.call(i);var a=A();return"number"==typeof e?"number"==typeof t?y(a,0|e,0|t):y(a,0|e,0|e):e?(Oe.type(e,"object","invalid arguments to regl.texture"),B(i,e),v(a,e)):y(a,1,1),i.genMipmaps&&(a.mipmask=(a.width<<1)-1),s.mipmask=a.mipmask,d(s,a),Oe.texture2D(i,a,o),s.internalformat=a.internalformat,n.width=a.width,n.height=a.height,D(s),T(a,3553),w(i,3553),I(),C(a),l.profile&&(s.stats.size=he(s.internalformat,s.type,a.width,a.height,i.genMipmaps,!1)),n.format=U[s.internalformat],n.type=W[s.type],n.mag=X[i.magFilter],n.min=q[i.minFilter],n.wrapS=Y[i.wrapS],n.wrapT=Y[i.wrapT],n}var s=new S(3553);return oe[s.id]=s,r.textureCount++,n(t,i),n.subimage=function(e,t,o,i){Oe(!!e,"must specify image data");var a=0|t,r=0|o,l=0|i,f=m();return d(f,s),f.width=0,f.height=0,p(f,e),f.width=f.width||(s.width>>l)-a,f.height=f.height||(s.height>>l)-r,Oe(s.type===f.type&&s.format===f.format&&s.internalformat===f.internalformat,"incompatible format for texture.subimage"),Oe(0<=a&&0<=r&&a+f.width<=s.width&&r+f.height<=s.height,"texture.subimage write out of bounds"),Oe(s.mipmask&1<<l,"missing mipmap data"),Oe(f.data||f.element||f.needsCopy,"missing image data"),D(s),h(f,3553,a,r,l),I(),b(f),n},n.resize=function(t,o){var a=0|t,r=0|o||a;if(a===s.width&&r===s.height)return n;n.width=s.width=a,n.height=s.height=r,D(s);for(var d=0;s.mipmask>>d;++d){var f=a>>d,u=r>>d;if(!f||!u)break;e.texImage2D(3553,d,s.format,f,u,0,s.format,s.type,null)}return I(),l.profile&&(s.stats.size=he(s.internalformat,s.type,a,r,!1,!1)),n},n._reglType="texture2d",n._texture=s,l.profile&&(n.stats=s.stats),n.destroy=function(){s.decRef()},n},createCube:function(t,i,n,a,s,u){function c(e,t,n,a,r,u){var p=g.texInfo,h;for(E.call(p),h=0;6>h;++h)x[h]=A();if("number"==typeof e||!e){var m=0|e||1;for(h=0;6>h;++h)y(x[h],m,m)}else if("object"!=typeof e)Oe.raise("invalid arguments to cube map");else if(t)v(x[0],e),v(x[1],t),v(x[2],n),v(x[3],a),v(x[4],r),v(x[5],u);else if(B(p,e),f(g,e),"faces"in e){var s=e.faces;for(Oe(Array.isArray(s)&&6===s.length,"cube faces must be a length 6 array"),h=0;6>h;++h)Oe("object"==typeof s[h]&&!!s[h],"invalid input for cube map face"),d(x[h],g),v(x[h],s[h])}else for(h=0;6>h;++h)v(x[h],e);for(d(g,x[0]),o.npotTextureCube||Oe(dt(g.width)&&dt(g.height),"your browser does not support non power or two texture dimensions"),g.mipmask=p.genMipmaps?(x[0].width<<1)-1:x[0].mipmask,Oe.textureCube(g,p,x,o),g.internalformat=x[0].internalformat,c.width=x[0].width,c.height=x[0].height,D(g),h=0;6>h;++h)T(x[h],34069+h);for(w(p,34067),I(),l.profile&&(g.stats.size=he(g.internalformat,g.type,c.width,c.height,p.genMipmaps,!0)),c.format=U[g.internalformat],c.type=W[g.type],c.mag=X[p.magFilter],c.min=q[p.minFilter],c.wrapS=Y[p.wrapS],c.wrapT=Y[p.wrapT],h=0;6>h;++h)C(x[h]);return c}var g=new S(34067);oe[g.id]=g,r.cubeCount++;var x=[,,,,,,];return c(t,i,n,a,s,u),c.subimage=function(e,t,o,i,n){Oe(!!t,"must specify image data"),Oe("number"==typeof e&&e===(0|e)&&0<=e&&6>e,"invalid face");var a=0|o,r=0|i,l=0|n,s=m();return d(s,g),s.width=0,s.height=0,p(s,t),s.width=s.width||(g.width>>l)-a,s.height=s.height||(g.height>>l)-r,Oe(g.type===s.type&&g.format===s.format&&g.internalformat===s.internalformat,"incompatible format for texture.subimage"),Oe(0<=a&&0<=r&&a+s.width<=g.width&&r+s.height<=g.height,"texture.subimage write out of bounds"),Oe(g.mipmask&1<<l,"missing mipmap data"),Oe(s.data||s.element||s.needsCopy,"missing image data"),D(g),h(s,34069+e,a,r,l),I(),b(s),c},c.resize=function(t){var o=0|t;if(o!==g.width){c.width=g.width=o,c.height=g.height=o,D(g);for(var n=0;6>n;++n)for(var a=0;g.mipmask>>a;++a)e.texImage2D(34069+n,a,g.format,o>>a,o>>a,0,g.format,g.type,null);return I(),l.profile&&(g.stats.size=he(g.internalformat,g.type,c.width,c.height,!1,!0)),c}},c._reglType="textureCube",c._texture=g,l.profile&&(c.stats=g.stats),c.destroy=function(){g.decRef()},c},clear:function(){for(var t=0;t<me;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),xe[t]=null;Qe(oe).forEach(F),r.cubeCount=0,r.textureCount=0},getTexture:function(){return null},restore:function(){for(var t=0,o;t<me;++t)o=xe[t],o&&(o.bindCount=0,o.unit=-1,xe[t]=null);Qe(oe).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var o=0;32>o;++o)if(0!=(t.mipmask&1<<o))if(3553===t.target)e.texImage2D(3553,o,t.internalformat,t.width>>o,t.height>>o,0,t.internalformat,t.type,null);else for(var n=0;6>n;++n)e.texImage2D(34069+n,o,t.internalformat,t.width>>o,t.height>>o,0,t.internalformat,t.type,null);w(t.texInfo,t.target)})}}}function xe(e,t,o){return Ht[e]*t*o}function be(e,t,o,n,a,r){function l(e,t,o){this.target=e,this.texture=t,this.renderbuffer=o;var i=0,n=0;t?(i=t.width,n=t.height):o&&(i=o.width,n=o.height),this.width=i,this.height=n}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function d(e,t,o){if(e)if(e.texture){var i=e.texture._texture,n=qu(1,i.width),a=qu(1,i.height);Oe(n===t&&a===o,"inconsistent width/height for supplied texture"),i.refCount+=1}else{var r=e.renderbuffer._renderbuffer;Oe(r.width===t&&r.height===o,"inconsistent width/height for renderbuffer"),r.refCount+=1}}function f(t,o){o&&(o.texture?e.framebufferTexture2D(36160,t,o.target,o.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,o.renderbuffer._renderbuffer.renderbuffer))}function u(e){var t=3553,o=null,i=null,n=e;"object"==typeof e&&(n=e.data,"target"in e&&(t=0|e.target)),Oe.type(n,"function","invalid attachment data");var a=n._reglType;return"texture2d"===a?(o=n,Oe(3553===t)):"textureCube"===a?(o=n,Oe(34069<=t&&34075>t,"invalid cube map target")):"renderbuffer"===a?(i=n,t=36161):Oe.raise("invalid regl object for attachment"),new l(t,o,i)}function c(e,t,o,i,r){if(o){var s=n.create2D({width:e,height:t,format:i,type:r});return s._texture.refCount=0,new l(3553,s,null)}var d=a.create({width:e,height:t,format:i});return d._renderbuffer.refCount=0,new l(36161,null,d)}function p(e){return e&&(e.texture||e.renderbuffer)}function g(e,t,o){e&&(e.texture?e.texture.resize(t,o):e.renderbuffer&&e.renderbuffer.resize(t,o),e.width=t,e.height=o)}function h(){this.id=E++,B[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function m(e){e.colorAttachments.forEach(s),s(e.depthAttachment),s(e.stencilAttachment),s(e.depthStencilAttachment)}function x(t){var o=t.framebuffer;Oe(o,"must not double destroy framebuffer"),e.deleteFramebuffer(o),t.framebuffer=null,r.framebufferCount--,delete B[t.id]}function _(t){var n;e.bindFramebuffer(36160,t.framebuffer);var a=t.colorAttachments;for(n=0;n<a.length;++n)f(36064+n,a[n]);for(n=a.length;n<o.maxColorAttachments;++n)e.framebufferTexture2D(36160,36064+n,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0),e.framebufferTexture2D(36160,36096,3553,null,0),e.framebufferTexture2D(36160,36128,3553,null,0),f(36096,t.depthAttachment),f(36128,t.stencilAttachment),f(33306,t.depthStencilAttachment);var r=e.checkFramebufferStatus(36160);e.isContextLost()||r===36053||Oe.raise("framebuffer configuration not supported, status = "+Wt[r]),e.bindFramebuffer(36160,v.next?v.next.framebuffer:null),v.cur=v.next,e.getError()}function y(e,i){function n(e,a){var r;Oe(v.next!==l,"can not update framebuffer which is currently in use");var s=0,f=0,g=!0,h=!0,x=null,b=!0,y="rgba",E="uint8",B=1,w=null,S=null,D=null,I=!1;if("number"==typeof e)s=0|e,f=0|a||s;else if(!e)s=f=1;else{Oe.type(e,"object","invalid arguments for framebuffer");var F=e;if("shape"in F){var R=F.shape;Oe(Array.isArray(R)&&2<=R.length,"invalid shape for framebuffer"),s=R[0],f=R[1]}else"radius"in F&&(s=f=F.radius),"width"in F&&(s=F.width),"height"in F&&(f=F.height);("color"in F||"colors"in F)&&(x=F.color||F.colors,Array.isArray(x)&&Oe(1===x.length||t.webgl_draw_buffers,"multiple render targets not supported")),x||("colorCount"in F&&(B=0|F.colorCount,Oe(0<B,"invalid color buffer count")),"colorTexture"in F&&(b=!!F.colorTexture,y="rgba4"),"colorType"in F&&(E=F.colorType,b?(Oe(t.oes_texture_float||"float"!==E&&"float32"!==E,"you must enable OES_texture_float in order to use floating point framebuffer objects"),Oe(t.oes_texture_half_float||"half float"!==E&&"float16"!==E,"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===E||"float16"===E?(Oe(t.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),y="rgba16f"):("float"===E||"float32"===E)&&(Oe(t.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),y="rgba32f"),Oe.oneOf(E,C,"invalid color type")),"colorFormat"in F&&(y=F.colorFormat,0<=T.indexOf(y)?b=!0:0<=A.indexOf(y)?b=!1:b?Oe.oneOf(F.colorFormat,T,"invalid color format for texture"):Oe.oneOf(F.colorFormat,A,"invalid color format for renderbuffer"))),("depthTexture"in F||"depthStencilTexture"in F)&&(I=!!(F.depthTexture||F.depthStencilTexture),Oe(!I||t.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in F&&("boolean"==typeof F.depth?g=F.depth:(w=F.depth,h=!1)),"stencil"in F&&("boolean"==typeof F.stencil?h=F.stencil:(S=F.stencil,g=!1)),"depthStencil"in F&&("boolean"==typeof F.depthStencil?g=h=F.depthStencil:(D=F.depthStencil,g=!1,h=!1))}var k=null,N=null,M=null,H=null;if(Array.isArray(x))k=x.map(u);else if(x)k=[u(x)];else for(k=Array(B),r=0;r<B;++r)k[r]=c(s,f,b,y,E);Oe(t.webgl_draw_buffers||1>=k.length,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Oe(k.length<=o.maxColorAttachments,"too many color attachments, not supported"),s=s||k[0].width,f=f||k[0].height,w?N=u(w):g&&!h&&(N=c(s,f,I,"depth","uint32")),S?M=u(S):h&&!g&&(M=c(s,f,!1,"stencil","uint8")),D?H=u(D):!w&&!S&&h&&g&&(H=c(s,f,I,"depth stencil","depth stencil")),Oe(1>=!!w+!!S+!!D,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var V=null;for(r=0;r<k.length;++r)if(d(k[r],s,f),Oe(!k[r]||k[r].texture&&0<=Pt.indexOf(k[r].texture._texture.format)||k[r].renderbuffer&&0<=Ut.indexOf(k[r].renderbuffer._renderbuffer.format),"framebuffer color attachment "+r+" is invalid"),k[r]&&k[r].texture){var O=Gt[k[r].texture._texture.format]*jt[k[r].texture._texture.type];null===V?V=O:Oe(V===O,"all color attachments much have the same number of bits per pixel.")}return d(N,s,f),Oe(!N||N.texture&&6402===N.texture._texture.format||N.renderbuffer&&33189===N.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),d(M,s,f),Oe(!M||M.renderbuffer&&36168===M.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),d(H,s,f),Oe(!H||H.texture&&34041===H.texture._texture.format||H.renderbuffer&&34041===H.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),m(l),l.width=s,l.height=f,l.colorAttachments=k,l.depthAttachment=N,l.stencilAttachment=M,l.depthStencilAttachment=H,n.color=k.map(p),n.depth=p(N),n.stencil=p(M),n.depthStencil=p(H),n.width=l.width,n.height=l.height,_(l),n}var l=new h;return r.framebufferCount++,n(e,i),Me(n,{resize:function(e,t){Oe(v.next!==l,"can not resize a framebuffer which is currently in use");var o=qu(0|e,1),a=qu(0|t||o,1);if(o===l.width&&a===l.height)return n;for(var r=l.colorAttachments,s=0;s<r.length;++s)g(r[s],o,a);return g(l.depthAttachment,o,a),g(l.stencilAttachment,o,a),g(l.depthStencilAttachment,o,a),l.width=n.width=o,l.height=n.height=a,_(l),n},_reglType:"framebuffer",_framebuffer:l,destroy:function(){x(l),m(l)},use:function(e){v.setFBO({framebuffer:n},e)}})}var v={cur:null,next:null,dirty:!1,setFBO:null},T=["rgba"],A=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&A.push("srgba"),t.ext_color_buffer_half_float&&A.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&A.push("rgba32f");var C=["uint8"];t.oes_texture_half_float&&C.push("half float","float16"),t.oes_texture_float&&C.push("float","float32");var E=0,B={};return Me(v,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof h)return t}return null},create:y,createCube:function(e){function r(e){var o;Oe(0>l.indexOf(v.next),"can not update framebuffer which is currently in use");var a={color:null},s=0,d=null,f="rgba",u="uint8",c=1;if("number"==typeof e)s=0|e;else if(!e)s=1;else{Oe.type(e,"object","invalid arguments for framebuffer");var p=e;if("shape"in p){var g=p.shape;Oe(Array.isArray(g)&&2<=g.length,"invalid shape for framebuffer"),Oe(g[0]===g[1],"cube framebuffer must be square"),s=g[0]}else"radius"in p&&(s=0|p.radius),"width"in p?(s=0|p.width,"height"in p&&Oe(p.height===s,"must be square")):"height"in p&&(s=0|p.height);("color"in p||"colors"in p)&&(d=p.color||p.colors,Array.isArray(d)&&Oe(1===d.length||t.webgl_draw_buffers,"multiple render targets not supported")),d||("colorCount"in p&&(c=0|p.colorCount,Oe(0<c,"invalid color buffer count")),"colorType"in p&&(Oe.oneOf(p.colorType,C,"invalid color type"),u=p.colorType),"colorFormat"in p&&(f=p.colorFormat,Oe.oneOf(p.colorFormat,T,"invalid color format for texture"))),"depth"in p&&(a.depth=p.depth),"stencil"in p&&(a.stencil=p.stencil),"depthStencil"in p&&(a.depthStencil=p.depthStencil)}var h;if(!d){h=Array(c);var m={radius:s,format:f,type:u};for(o=0;o<c;++o)h[o]=n.createCube(m)}else if(Array.isArray(d))for(h=[],o=0;o<d.length;++o)h[o]=d[o];else h=[d];for(a.color=Array(h.length),o=0;o<h.length;++o){var x=h[o];Oe("function"==typeof x&&"textureCube"===x._reglType,"invalid cube map"),s=s||x.width,Oe(x.width===s&&x.height===s,"invalid cube map shape"),a.color[o]={target:34069,data:h[o]}}for(o=0;6>o;++o){for(var b=0;b<h.length;++b)a.color[b].target=34069+o;0<o&&(a.depth=l[0].depth,a.stencil=l[0].stencil,a.depthStencil=l[0].depthStencil),l[o]?l[o](a):l[o]=y(a)}return Me(r,{width:s,height:s,color:h})}var l=[,,,,,,];return r(e),Me(r,{faces:l,resize:function(e){var t=0|e,n;if(Oe(0<t&&t<=o.maxCubeMapSize,"invalid radius for cube fbo"),t===r.width)return r;var a=r.color;for(n=0;n<a.length;++n)a[n].resize(t);for(n=0;6>n;++n)l[n].resize(t);return r.width=r.height=t,r},_reglType:"framebufferCube",destroy:function(){l.forEach(function(e){e.destroy()})}})},clear:function(){Qe(B).forEach(x)},restore:function(){v.cur=null,v.next=null,v.dirty=!0,Qe(B).forEach(function(t){t.framebuffer=e.createFramebuffer(),_(t)})}})}function _e(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}function ye(e,t,o,n,a){function r(t){for(var o=0,n;o<c.length;++o)n=c[o],n.buffer===t&&(e.disableVertexAttribArray(o),n.buffer=null)}function l(){return t.oes_vertex_array_object}function s(){return t.angle_instanced_arrays}function d(t){if(t!==m.currentVAO){if(t)t.bindAttrs();else{var o=s();for(let t=0;t<c.length;++t){var n=c[t];n.buffer?(e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.size,n.type,n.normalized,n.stride,n.offfset),o&&o.vertexAttribDivisorANGLE(t,n.divisor)):(e.disableVertexAttribArray(t),e.vertexAttrib4f(t,n.x,n.y,n.z,n.w))}}m.currentVAO=t}}function f(){this.id=++g,this.attributes=[];var e=l();this.vao=e?e.createVertexArrayOES():null,h[this.id]=this,this.buffers=[]}for(var u=o.maxAttributes,c=Array(u),p=0;p<u;++p)c[p]=new _e;var g=0,h={},m={Record:_e,scope:{},state:c,currentVAO:null,targetVAO:null,restore:l()?function(){var e=l();e&&Qe(h).forEach(function(e){e.refresh()})}:function(){},createVAO:function(e){function o(e){Oe(Array.isArray(e),"arguments to vertex array constructor must be an array"),Oe(e.length<u,"too many attributes"),Oe(0<e.length,"must specify at least one attribute");for(var n=0;n<r.buffers.length;++n)r.buffers[n].destroy();r.buffers.length=0;var l=r.attributes;l.length=e.length;for(var s=0;s<e.length;++s){var d=e[s],f=l[s]=new _e;if(Array.isArray(d)||Ne(d)||P(d)){var c=a.create(d,34962,!1,!0);f.buffer=a.getBuffer(c),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1,r.buffers.push(c)}else a.getBuffer(d)?(f.buffer=a.getBuffer(d),f.size=0|f.buffer.dimension,f.normalized=!1,f.type=f.buffer.dtype,f.offset=0,f.stride=0,f.divisor=0,f.state=1):a.getBuffer(d.buffer)?(f.buffer=a.getBuffer(d.buffer),f.size=0|(+d.size||f.buffer.dimension),f.normalized=!!d.normalized||!1,"type"in d?(Oe.parameter(d.type,tt,"invalid buffer type"),f.type=tt[d.type]):f.type=f.buffer.dtype,f.offset=0|(d.offset||0),f.stride=0|(d.stride||0),f.divisor=0|(d.divisor||0),f.state=1,Oe(1<=f.size&&4>=f.size,"size must be between 1 and 4"),Oe(0<=f.offset,"invalid offset"),Oe(0<=f.stride&&255>=f.stride,"stride must be between 0 and 255"),Oe(0<=f.divisor,"divisor must be positive"),Oe(!f.divisor||!!t.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in d?(Oe(0<s,"first attribute must not be a constant"),f.x=+d.x||0,f.y=+d.y||0,f.z=+d.z||0,f.w=+d.w||0,f.state=2):Oe(!1,"invalid attribute spec for location "+s)}return r.refresh(),o}var r=new f;return n.vaoCount+=1,o.destroy=function(){r.destroy()},o._vao=r,o._reglType="vao",o(e)},getVAO:function(e){return"function"==typeof e&&e._vao?e._vao:null},destroyBuffer:r,setVAO:l()?function(e){if(e!==m.currentVAO){var t=l();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),m.currentVAO=e}}:d,clear:l()?function(){Qe(h).forEach(e=>{e.destroy()})}:function(){}};return f.prototype.bindAttrs=function(){for(var t=s(),o=this.attributes,n=0,a;n<o.length;++n)a=o[n],a.buffer?(e.enableVertexAttribArray(n),e.bindBuffer(34962,a.buffer.buffer),e.vertexAttribPointer(n,a.size,a.type,a.normalized,a.stride,a.offset),t&&t.vertexAttribDivisorANGLE(n,a.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,a.x,a.y,a.z,a.w));for(var r=o.length;r<u;++r)e.disableVertexAttribArray(r)},f.prototype.refresh=function(){var e=l();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),m.currentVAO=this)},f.prototype.destroy=function(){if(this.vao){var e=l();this===m.currentVAO&&(m.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}h[this.id]&&(delete h[this.id],n.vaoCount-=1)},m}function ve(e,t,o,n){function a(e,t,o,i){this.name=e,this.id=t,this.location=o,this.info=i}function r(e,t){for(var o=0;o<e.length;++o)if(e[o].id===t.id)return void(e[o].location=t.location);e.push(t)}function l(o,i,n){var a=35632===o?f:u,r=a[i];if(!r){var l=t.str(i);r=e.createShader(o),e.shaderSource(r,l),e.compileShader(r),Oe.shaderError(e,r,l,o,n),a[i]=r}return r}function s(e,t){this.id=g++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],n.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function d(o,s,d){var f=l(35632,o.fragId),u=l(35633,o.vertId),c=o.program=e.createProgram(),p,g;if(e.attachShader(c,f),e.attachShader(c,u),d)for(let t=0;t<d.length;++t){var h=d[t];e.bindAttribLocation(c,h[0],h[1])}e.linkProgram(c),Oe.linkError(e,c,t.str(o.fragId),t.str(o.vertId),s);var m=e.getProgramParameter(c,35718);n.profile&&(o.stats.uniformsCount=m);var x=o.uniforms;for(p=0;p<m;++p)if(g=e.getActiveUniform(c,p),g)if(1<g.size)for(var b=0,_;b<g.size;++b)_=g.name.replace("[0]","["+b+"]"),r(x,new a(_,t.id(_),e.getUniformLocation(c,_),g));else r(x,new a(g.name,t.id(g.name),e.getUniformLocation(c,g.name),g));var y=e.getProgramParameter(c,35721);n.profile&&(o.stats.attributesCount=y);var v=o.attributes;for(p=0;p<y;++p)g=e.getActiveAttrib(c,p),g&&r(v,new a(g.name,t.id(g.name),e.getAttribLocation(c,g.name),g))}var f={},u={},c={},p=[],g=0;return n.profile&&(o.getMaxUniformsCount=function(){var e=0;return p.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},o.getMaxAttributesCount=function(){var e=0;return p.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);Qe(f).forEach(t),f={},Qe(u).forEach(t),u={},p.forEach(function(t){e.deleteProgram(t.program)}),p.length=0,c={},o.shaderCount=0},program:function(e,t,i,n){Oe.command(0<=e,"missing vertex shader",i),Oe.command(0<=t,"missing fragment shader",i);var a=c[t];a||(a=c[t]={});var r=a[e];if(r&&!n)return r;var l=new s(t,e);return o.shaderCount++,d(l,i,n),r||(a[e]=l),p.push(l),l},restore:function(){f={},u={};for(var e=0;e<p.length;++e)d(p[e],null,p[e].attributes.map(function(e){return[e.location,e.name]}))},shader:l,frag:-1,vert:-1}}function Te(e,t,o,i,n,a,r){function l(l){var s;null===t.next?(Oe(n.preserveDrawingBuffer,"you must create a webgl context with \"preserveDrawingBuffer\":true in order to read pixels from the drawing buffer"),s=5121):(Oe(null!==t.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),s=t.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(Oe(5121===s||5126===s,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),5126===s&&Oe(r.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Oe(5121===s,"Reading from a framebuffer is only allowed for the type 'uint8'"));var d=0,f=0,u=i.framebufferWidth,c=i.framebufferHeight,p=null;Ne(l)?p=l:l&&(Oe.type(l,"object","invalid arguments to regl.read()"),d=0|l.x,f=0|l.y,Oe(0<=d&&d<i.framebufferWidth,"invalid x offset for regl.read"),Oe(0<=f&&f<i.framebufferHeight,"invalid y offset for regl.read"),u=0|(l.width||i.framebufferWidth-d),c=0|(l.height||i.framebufferHeight-f),p=l.data||null),p&&(5121===s?Oe(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):5126===s&&Oe(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Oe(0<u&&u+d<=i.framebufferWidth,"invalid width for read pixels"),Oe(0<c&&c+f<=i.framebufferHeight,"invalid height for read pixels"),o();var g=4*(u*c);return p||(5121===s?p=new Uint8Array(g):5126===s&&(p=p||new Float32Array(g))),Oe.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),Oe(p.byteLength>=g,"data buffer for regl.read() too small"),e.pixelStorei(3333,4),e.readPixels(d,f,u,c,6408,s,p),p}function s(e){var o;return t.setFBO({framebuffer:e.framebuffer},function(){o=l(e)}),o}function d(e){return e&&"framebuffer"in e?s(e):l(e)}return d}function Ae(e){return Array.prototype.slice.call(e)}function Ce(e){return Ae(e).join("")}function Ee(){function e(e){for(var t=0;t<r.length;++t)if(r[t]===e)return a[t];var o="g"+n++;return a.push(o),r.push(e),o}function t(){function e(){var e="v"+n++;return o.push(e),0<arguments.length&&(t.push(e,"="),t.push.apply(t,Ae(arguments)),t.push(";")),e}var t=[],o=[];return Me(function(){t.push.apply(t,Ae(arguments))},{def:e,toString:function(){return Ce([0<o.length?"var "+o.join(",")+";":"",Ce(t)])}})}function o(){function e(e,t){i(e,t,"=",o.def(e,t),";")}var o=t(),i=t(),n=o.toString,a=i.toString;return Me(function(){o.apply(o,Ae(arguments))},{def:o.def,entry:o,exit:i,save:e,set:function(t,i,n){e(t,i),o(t,i,"=",n,";")},toString:function(){return n()+a()}})}var n=0,a=[],r=[],l=t(),s={};return{global:l,link:e,block:t,proc:function(e,t){function n(){var e="a"+a.length;return a.push(e),e}var a=[];t=t||0;for(var r=0;r<t;++r)n();var l=o(),d=l.toString,f=s[e]=Me(l,{arg:n,toString:function(){return Ce(["function(",a.join(),"){",d(),"}"])}});return f},scope:o,cond:function(){var e=Ce(arguments),t=o(),i=o(),n=t.toString,a=i.toString;return Me(t,{then:function(){return t.apply(t,Ae(arguments)),this},else:function(){return i.apply(i,Ae(arguments)),this},toString:function(){var t=a();return t&&(t="else{"+t+"}"),Ce(["if(",e,"){",n(),"}",t])}})},compile:function(){var e=["\"use strict\";",l,"return {"];Object.keys(s).forEach(function(t){e.push("\"",t,"\":",s[t].toString(),",")}),e.push("}");var t=Ce(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n"),o=Function.apply(null,a.concat(t));return o.apply(null,r)}}}function Be(e){return Array.isArray(e)||Ne(e)||P(e)}function we(e){return e.sort(function(e,t){if(e==="viewport")return-1;return"viewport"===t?1:e<t?-1:1})}function Se(e,t,o,i){this.thisDep=e,this.contextDep=t,this.propDep=o,this.append=i}function Le(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function De(e){return new Se(!1,!1,!1,e)}function Ie(e,t){var o=e.type;if(o===0){var i=e.data.length;return new Se(!0,1<=i,2<=i,t)}if(4===o){var n=e.data;return new Se(n.thisDep,n.contextDep,n.propDep,t)}return new Se(3===o,2===o,1===o,t)}function Fe(e,t,o,n,a,r,l,s,d,f,u,c,p,g,h){function m(e){return e.replace(".","_")}function x(e,t,o){var i=m(e);ae.push(e),ne[i]=ie[i]=!!o,re[i]=t}function b(e,t,o){var i=m(e);ae.push(e),Array.isArray(o)?(ie[i]=o.slice(),ne[i]=o.slice()):ie[i]=ne[i]=o,le[i]=t}function _(){var e=Ee(),o=e.link,i=e.global;e.id=fe++,e.batchId="0";var n=o(se),a=e.shared={props:"a0"};Object.keys(se).forEach(function(e){a[e]=i.def(n,".",e)}),Oe.optional(function(){e.CHECK=o(Oe),e.commandStr=Oe.guessCommand(),e.command=o(e.commandStr),e.assert=function(e,t,i){e("if(!(",t,"))",this.CHECK,".commandRaise(",o(i),",",this.command,");")},de.invalidBlendCombinations=eo});var r=e.next={},l=e.current={};Object.keys(le).forEach(function(e){Array.isArray(ie[e])&&(r[e]=i.def(a.next,".",e),l[e]=i.def(a.current,".",e))});var s=e.constants={};Object.keys(de).forEach(function(e){s[e]=i.def(JSON.stringify(de[e]))}),e.invoke=function(t,i){switch(i.type){case 0:var n=["this",a.context,a.props,e.batchId];return t.def(o(i.data),".call(",n.slice(0,qu(i.data.length+1,4)),")");case 1:return t.def(a.props,i.data);case 2:return t.def(a.context,i.data);case 3:return t.def("this",i.data);case 4:return i.data.append(e,t),i.data.ref;}},e.attribCache={};var d={};return e.scopeAttrib=function(e){var i=t.id(e);if(i in d)return d[i];var n=f.scope[i];n||(n=f.scope[i]=new J);var a=d[i]=o(n);return a},e}function y(e){var t=e.static,o=e.dynamic,i;if("profile"in t){var n=!!t.profile;i=De(function(){return n}),i.enable=n}else if("profile"in o){var a=o.profile;i=Ie(a,function(e,t){return e.invoke(t,a)})}return i}function v(e){var t=e.static,o=e.dynamic;if("framebuffer"in t){var i=t.framebuffer;return i?(i=s.getFramebuffer(i),Oe.command(i,"invalid framebuffer object"),De(function(e,t){var o=e.link(i),n=e.shared;t.set(n.framebuffer,".next",o);var a=n.context;return t.set(a,".framebufferWidth",o+".width"),t.set(a,".framebufferHeight",o+".height"),o})):De(function(e,t){var o=e.shared;t.set(o.framebuffer,".next","null");var i=o.context;return t.set(i,".framebufferWidth",i+".drawingBufferWidth"),t.set(i,".framebufferHeight",i+".drawingBufferHeight"),"null"})}if("framebuffer"in o){var n=o.framebuffer;return Ie(n,function(e,t){var o=e.invoke(t,n),i=e.shared,a=i.framebuffer,r=t.def(a,".getFramebuffer(",o,")");Oe.optional(function(){e.assert(t,"!"+o+"||"+r,"invalid framebuffer object")}),t.set(a,".next",r);var l=i.context;return t.set(l,".framebufferWidth",r+"?"+r+".width:"+l+".drawingBufferWidth"),t.set(l,".framebufferHeight",r+"?"+r+".height:"+l+".drawingBufferHeight"),r})}return null}function T(e,t,o){function i(e){if(e in n){var i=n[e];Oe.commandType(i,"object","invalid "+e,o.commandStr);var r=!0,l=0|i.x,s=0|i.y,d,f;return"width"in i?(d=0|i.width,Oe.command(0<=d,"invalid "+e,o.commandStr)):r=!1,"height"in i?(f=0|i.height,Oe.command(0<=f,"invalid "+e,o.commandStr)):r=!1,new Se(!r&&t&&t.thisDep,!r&&t&&t.contextDep,!r&&t&&t.propDep,function(e,t){var o=e.shared.context,n=d;"width"in i||(n=t.def(o,".","framebufferWidth","-",l));var a=f;return"height"in i||(a=t.def(o,".","framebufferHeight","-",s)),[l,s,n,a]})}if(e in a){var u=a[e],c=Ie(u,function(t,o){var i=t.invoke(o,u);Oe.optional(function(){t.assert(o,i+"&&typeof "+i+"===\"object\"","invalid "+e)});var n=t.shared.context,a=o.def(i,".x|0"),r=o.def(i,".y|0"),l=o.def("\"width\" in ",i,"?",i,".width|0:","(",n,".","framebufferWidth","-",a,")"),s=o.def("\"height\" in ",i,"?",i,".height|0:","(",n,".","framebufferHeight","-",r,")");return Oe.optional(function(){t.assert(o,l+">=0&&"+s+">=0","invalid "+e)}),[a,r,l,s]});return t&&(c.thisDep=c.thisDep||t.thisDep,c.contextDep=c.contextDep||t.contextDep,c.propDep=c.propDep||t.propDep),c}return t?new Se(t.thisDep,t.contextDep,t.propDep,function(e,t){var o=e.shared.context;return[0,0,t.def(o,".","framebufferWidth"),t.def(o,".","framebufferHeight")]}):null}var n=e.static,a=e.dynamic,r=i("viewport");if(r){var l=r;r=new Se(r.thisDep,r.contextDep,r.propDep,function(e,t){var o=l.append(e,t),i=e.shared.context;return t.set(i,".viewportWidth",o[2]),t.set(i,".viewportHeight",o[3]),o})}return{viewport:r,scissor_box:i("scissor.box")}}function A(e,t){var o=e.static,n="string"==typeof o.frag&&"string"==typeof o.vert;if(n){if(0<Object.keys(t.dynamic).length)return null;var a=t.static,r=Object.keys(a);if(0<r.length&&"number"==typeof a[r[0]]){for(var l=[],s=0;s<r.length;++s)Oe("number"==typeof a[r[s]],"must specify all vertex attribute locations when using vaos"),l.push([0|a[r[s]],r[s]]);return l}}return null}function C(e,o,i){function n(e){if(e in a){var o=t.id(a[e]);Oe.optional(function(){u.shader(io[e],o,Oe.guessCommand())});var i=De(function(){return o});return i.id=o,i}if(e in r){var n=r[e];return Ie(n,function(t,o){var i=t.invoke(o,n),a=o.def(t.shared.strings,".id(",i,")");return Oe.optional(function(){o(t.shared.shader,".shader(",io[e],",",a,",",t.command,");")}),a})}return null}var a=e.static,r=e.dynamic,l=n("frag"),s=n("vert"),d=null,f;return Le(l)&&Le(s)?(d=u.program(s.id,l.id,null,i),f=De(function(e){return e.link(d)})):f=new Se(l&&l.thisDep||s&&s.thisDep,l&&l.contextDep||s&&s.contextDep,l&&l.propDep||s&&s.propDep,function(e,t){var o=e.shared.shader,i;i=l?l.append(e,t):t.def(o,".","frag");var n=s?s.append(e,t):t.def(o,".","vert");var a=o+".program("+n+","+i;return Oe.optional(function(){a+=","+e.command}),t.def(a+")")}),{frag:l,vert:s,progVar:f,program:d}}function E(e,t){function o(){if("elements"in l){var e=l.elements;Be(e)?e=r.getElements(r.create(e,!0)):e&&(e=r.getElements(e),Oe.command(e,"invalid elements",t.commandStr));var o=De(function(t){if(e){var o=t.link(e);return t.ELEMENTS=o,o}return t.ELEMENTS=null,null});return o.value=e,o}if("elements"in s){var i=s.elements;return Ie(i,function(e,t){var o=e.shared,n=o.isBufferArgs,a=o.elements,r=e.invoke(t,i),l=t.def("null"),s=t.def(n,"(",r,")"),d=e.cond(s).then(l,"=",a,".createStream(",r,");").else(l,"=",a,".getElements(",r,");");return Oe.optional(function(){e.assert(d.else,"!"+r+"||"+l,"invalid elements")}),t.entry(d),t.exit(e.cond(s).then(a,".destroyStream(",l,");")),e.ELEMENTS=l,l})}return null}function i(){if("primitive"in l){var e=l.primitive;return Oe.commandParameter(e,rt,"invalid primitve",t.commandStr),De(function(){return rt[e]})}if("primitive"in s){var o=s.primitive;return Ie(o,function(e,t){var i=e.constants.primTypes,n=e.invoke(t,o);return Oe.optional(function(){e.assert(t,n+" in "+i,"invalid primitive, must be one of "+Object.keys(rt))}),t.def(i,"[",n,"]")})}return d?Le(d)?d.value?De(function(e,t){return t.def(e.ELEMENTS,".primType")}):De(function(){return 4}):new Se(d.thisDep,d.contextDep,d.propDep,function(e,t){var o=e.ELEMENTS;return t.def(o,"?",o,".primType:",4)}):null}function n(e,o){if(e in l){var i=0|l[e];return Oe.command(!o||0<=i,"invalid "+e,t.commandStr),De(function(e){return o&&(e.OFFSET=i),i})}if(e in s){var n=s[e];return Ie(n,function(t,i){var a=t.invoke(i,n);return o&&(t.OFFSET=a,Oe.optional(function(){t.assert(i,a+">=0","invalid "+e)})),a})}return o&&d?De(function(e){return e.OFFSET="0",0}):null}function a(){if("count"in l){var e=0|l.count;return Oe.command("number"==typeof e&&0<=e,"invalid vertex count",t.commandStr),De(function(){return e})}if("count"in s){var o=s.count;return Ie(o,function(e,t){var i=e.invoke(t,o);return Oe.optional(function(){e.assert(t,"typeof "+i+"===\"number\"&&"+i+">=0&&"+i+"===("+i+"|0)","invalid vertex count")}),i})}if(d){if(Le(d)){if(d)return f?new Se(f.thisDep,f.contextDep,f.propDep,function(e,t){var o=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return Oe.optional(function(){e.assert(t,o+">=0","invalid vertex offset/element buffer too small")}),o}):De(function(e,t){return t.def(e.ELEMENTS,".vertCount")});var i=De(function(){return-1});return Oe.optional(function(){i.MISSING=!0}),i}var n=new Se(d.thisDep||f.thisDep,d.contextDep||f.contextDep,d.propDep||f.propDep,function(e,t){var o=e.ELEMENTS;return e.OFFSET?t.def(o,"?",o,".vertCount-",e.OFFSET,":-1"):t.def(o,"?",o,".vertCount:-1")});return Oe.optional(function(){n.DYNAMIC=!0}),n}return null}var l=e.static,s=e.dynamic,d=o(),f=n("offset",!0);return{elements:d,primitive:i(),count:a(),instances:n("instances",!1),offset:f}}function B(e,t){var o=e.static,i=e.dynamic,a={};return ae.forEach(function(e){function r(t,n){if(e in o){var r=t(o[e]);a[l]=De(function(){return r})}else if(e in i){var s=i[e];a[l]=Ie(s,function(e,t){return n(e,t,e.invoke(t,s))})}}var l=m(e);return"cull.enable"===e||"blend.enable"===e||"dither"===e||"stencil.enable"===e||"depth.enable"===e||"scissor.enable"===e||"polygonOffset.enable"===e||"sample.alpha"===e||"sample.enable"===e||"depth.mask"===e?r(function(o){return Oe.commandType(o,"boolean",e,t.commandStr),o},function(t,o,i){return Oe.optional(function(){t.assert(o,"typeof "+i+"===\"boolean\"","invalid flag "+e,t.commandStr)}),i}):"depth.func"===e?r(function(o){return Oe.commandParameter(o,to,"invalid "+e,t.commandStr),to[o]},function(t,o,i){var n=t.constants.compareFuncs;return Oe.optional(function(){t.assert(o,i+" in "+n,"invalid "+e+", must be one of "+Object.keys(to))}),o.def(n,"[",i,"]")}):"depth.range"===e?r(function(e){return Oe.command(Q(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e},function(e,t,o){Oe.optional(function(){e.assert(t,e.shared.isArrayLike+"("+o+")&&"+o+".length===2&&typeof "+o+"[0]===\"number\"&&typeof "+o+"[1]===\"number\"&&"+o+"[0]<="+o+"[1]","depth range must be a 2d array")});var i=t.def("+",o,"[0]"),n=t.def("+",o,"[1]");return[i,n]}):"blend.func"===e?r(function(e){Oe.commandType(e,"object","blend.func",t.commandStr);var o="srcRGB"in e?e.srcRGB:e.src,i="srcAlpha"in e?e.srcAlpha:e.src,n="dstRGB"in e?e.dstRGB:e.dst,a="dstAlpha"in e?e.dstAlpha:e.dst;return Oe.commandParameter(o,Jt,l+".srcRGB",t.commandStr),Oe.commandParameter(i,Jt,l+".srcAlpha",t.commandStr),Oe.commandParameter(n,Jt,l+".dstRGB",t.commandStr),Oe.commandParameter(a,Jt,l+".dstAlpha",t.commandStr),Oe.command(-1===eo.indexOf(o+", "+n),"unallowed blending combination (srcRGB, dstRGB) = ("+o+", "+n+")",t.commandStr),[Jt[o],Jt[n],Jt[i],Jt[a]]},function(t,o,i){function n(n,r){var l=o.def("\"",n,r,"\" in ",i,"?",i,".",n,r,":",i,".",n);return Oe.optional(function(){t.assert(o,l+" in "+a,"invalid "+e+"."+n+r+", must be one of "+Object.keys(Jt))}),l}var a=t.constants.blendFuncs;Oe.optional(function(){t.assert(o,i+"&&typeof "+i+"===\"object\"","invalid blend func, must be an object")});var r=n("src","RGB"),l=n("dst","RGB");Oe.optional(function(){var e=t.constants.invalidBlendCombinations;t.assert(o,e+".indexOf("+r+"+\", \"+"+l+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var s=o.def(a,"[",r,"]"),d=o.def(a,"[",n("src","Alpha"),"]"),f=o.def(a,"[",l,"]"),u=o.def(a,"[",n("dst","Alpha"),"]");return[s,f,d,u]}):"blend.equation"===e?r(function(o){return"string"==typeof o?(Oe.commandParameter(o,ee,"invalid "+e,t.commandStr),[ee[o],ee[o]]):"object"==typeof o?(Oe.commandParameter(o.rgb,ee,e+".rgb",t.commandStr),Oe.commandParameter(o.alpha,ee,e+".alpha",t.commandStr),[ee[o.rgb],ee[o.alpha]]):void Oe.commandRaise("invalid blend.equation",t.commandStr)},function(t,o,i){var n=t.constants.blendEquations,a=o.def(),r=o.def(),l=t.cond("typeof ",i,"===\"string\"");return Oe.optional(function(){function o(e,o,i){t.assert(e,i+" in "+n,"invalid "+o+", must be one of "+Object.keys(ee))}o(l.then,e,i),t.assert(l.else,i+"&&typeof "+i+"===\"object\"","invalid "+e),o(l.else,e+".rgb",i+".rgb"),o(l.else,e+".alpha",i+".alpha")}),l.then(a,"=",r,"=",n,"[",i,"];"),l.else(a,"=",n,"[",i,".rgb];",r,"=",n,"[",i,".alpha];"),o(l),[a,r]}):"blend.color"===e?r(function(e){return Oe.command(Q(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),H(4,function(t){return+e[t]})},function(e,t,o){return Oe.optional(function(){e.assert(t,e.shared.isArrayLike+"("+o+")&&"+o+".length===4","blend.color must be a 4d array")}),H(4,function(e){return t.def("+",o,"[",e,"]")})}):"stencil.mask"===e?r(function(e){return Oe.commandType(e,"number",l,t.commandStr),0|e},function(e,t,o){return Oe.optional(function(){e.assert(t,"typeof "+o+"===\"number\"","invalid stencil.mask")}),t.def(o,"|0")}):"stencil.func"===e?r(function(o){Oe.commandType(o,"object",l,t.commandStr);var i=o.cmp||"keep",n=o.ref||0,a="mask"in o?o.mask:-1;return Oe.commandParameter(i,to,e+".cmp",t.commandStr),Oe.commandType(n,"number",e+".ref",t.commandStr),Oe.commandType(a,"number",e+".mask",t.commandStr),[to[i],n,a]},function(e,t,o){var i=e.constants.compareFuncs;Oe.optional(function(){function n(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}n(o+"&&typeof ",o,"===\"object\""),n("!(\"cmp\" in ",o,")||(",o,".cmp in ",i,")")});var n=t.def("\"cmp\" in ",o,"?",i,"[",o,".cmp]",":",7680),a=t.def(o,".ref|0"),r=t.def("\"mask\" in ",o,"?",o,".mask|0:-1");return[n,a,r]}):"stencil.opFront"===e||"stencil.opBack"===e?r(function(o){Oe.commandType(o,"object",l,t.commandStr);var i=o.fail||"keep",n=o.zfail||"keep",a=o.zpass||"keep";return Oe.commandParameter(i,oo,e+".fail",t.commandStr),Oe.commandParameter(n,oo,e+".zfail",t.commandStr),Oe.commandParameter(a,oo,e+".zpass",t.commandStr),["stencil.opBack"===e?1029:1028,oo[i],oo[n],oo[a]]},function(t,o,i){function n(n){return Oe.optional(function(){t.assert(o,"!(\""+n+"\" in "+i+")||("+i+"."+n+" in "+a+")","invalid "+e+"."+n+", must be one of "+Object.keys(oo))}),o.def("\"",n,"\" in ",i,"?",a,"[",i,".",n,"]:",7680)}var a=t.constants.stencilOps;return Oe.optional(function(){t.assert(o,i+"&&typeof "+i+"===\"object\"","invalid "+e)}),["stencil.opBack"===e?1029:1028,n("fail"),n("zfail"),n("zpass")]}):"polygonOffset.offset"===e?r(function(e){Oe.commandType(e,"object",l,t.commandStr);var o=0|e.factor,i=0|e.units;return Oe.commandType(o,"number",l+".factor",t.commandStr),Oe.commandType(i,"number",l+".units",t.commandStr),[o,i]},function(t,o,i){Oe.optional(function(){t.assert(o,i+"&&typeof "+i+"===\"object\"","invalid "+e)});var n=o.def(i,".factor|0"),a=o.def(i,".units|0");return[n,a]}):"cull.face"===e?r(function(e){var o=0;return"front"===e?o=1028:"back"==e&&(o=1029),Oe.command(!!o,l,t.commandStr),o},function(e,t,o){return Oe.optional(function(){e.assert(t,o+"===\"front\"||"+o+"===\"back\"","invalid cull.face")}),t.def(o,"===\"front\"?",1028,":",1029)}):"lineWidth"===e?r(function(e){return Oe.command("number"==typeof e&&e>=n.lineWidthDims[0]&&e<=n.lineWidthDims[1],"invalid line width, must be a positive number between "+n.lineWidthDims[0]+" and "+n.lineWidthDims[1],t.commandStr),e},function(e,t,o){return Oe.optional(function(){e.assert(t,"typeof "+o+"===\"number\"&&"+o+">="+n.lineWidthDims[0]+"&&"+o+"<="+n.lineWidthDims[1],"invalid line width")}),o}):"frontFace"===e?r(function(e){return Oe.commandParameter(e,no,l,t.commandStr),no[e]},function(e,t,o){return Oe.optional(function(){e.assert(t,o+"===\"cw\"||"+o+"===\"ccw\"","invalid frontFace, must be one of cw,ccw")}),t.def(o+"===\"cw\"?"+2304+":"+2305)}):"colorMask"===e?r(function(e){return Oe.command(Q(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map(function(e){return!!e})},function(e,t,o){return Oe.optional(function(){e.assert(t,e.shared.isArrayLike+"("+o+")&&"+o+".length===4","invalid color.mask")}),H(4,function(e){return"!!"+o+"["+e+"]"})}):"sample.coverage"===e?r(function(e){Oe.command("object"==typeof e&&e,l,t.commandStr);var o="value"in e?e.value:1,i=!!e.invert;return Oe.command("number"==typeof o&&0<=o&&1>=o,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[o,i]},function(e,t,o){Oe.optional(function(){e.assert(t,o+"&&typeof "+o+"===\"object\"","invalid sample.coverage")});var i=t.def("\"value\" in ",o,"?+",o,".value:1"),n=t.def("!!",o,".invert");return[i,n]}):void 0}),a}function w(e,t){var o=e.static,i=e.dynamic,n={};return Object.keys(o).forEach(function(e){var a=o[e],r;if("number"==typeof a||"boolean"==typeof a)r=De(function(){return a});else if("function"==typeof a){var l=a._reglType;"texture2d"===l||"textureCube"===l?r=De(function(e){return e.link(a)}):"framebuffer"===l||"framebufferCube"===l?(Oe.command(0<a.color.length,"missing color attachment for framebuffer sent to uniform \""+e+"\"",t.commandStr),r=De(function(e){return e.link(a.color[0])})):Oe.commandRaise("invalid data for uniform \""+e+"\"",t.commandStr)}else Q(a)?r=De(function(t){var o=t.global.def("[",H(a.length,function(o){return Oe.command("number"==typeof a[o]||"boolean"==typeof a[o],"invalid uniform "+e,t.commandStr),a[o]}),"]");return o}):Oe.commandRaise("invalid or missing data for uniform \""+e+"\"",t.commandStr);r.value=a,n[e]=r}),Object.keys(i).forEach(function(e){var t=i[e];n[e]=Ie(t,function(e,o){return e.invoke(o,t)})}),n}function S(e,o){var i=e.static,n=e.dynamic,r={};return Object.keys(i).forEach(function(e){var n=i[e],l=t.id(e),s=new J;if(Be(n))s.state=1,s.buffer=a.getBuffer(a.create(n,34962,!1,!0)),s.type=0;else{var d=a.getBuffer(n);if(d)s.state=1,s.buffer=d,s.type=0;else if(Oe.command("object"==typeof n&&n,"invalid data for attribute "+e,o.commandStr),"constant"in n){var f=n.constant;s.buffer="null",s.state=2,"number"==typeof f?s.x=f:(Oe.command(Q(f)&&0<f.length&&4>=f.length,"invalid constant for attribute "+e,o.commandStr),Xt.forEach(function(e,t){t<f.length&&(s[e]=f[t])}))}else{d=Be(n.buffer)?a.getBuffer(a.create(n.buffer,34962,!1,!0)):a.getBuffer(n.buffer),Oe.command(!!d,"missing buffer for attribute \""+e+"\"",o.commandStr);var u=0|n.offset;Oe.command(0<=u,"invalid offset for attribute \""+e+"\"",o.commandStr);var c=0|n.stride;Oe.command(0<=c&&256>c,"invalid stride for attribute \""+e+"\", must be integer betweeen [0, 255]",o.commandStr);var p=0|n.size;Oe.command(!("size"in n)||0<p&&4>=p,"invalid size for attribute \""+e+"\", must be 1,2,3,4",o.commandStr);var g=!!n.normalized,h=0;"type"in n&&(Oe.commandParameter(n.type,tt,"invalid type for attribute "+e,o.commandStr),h=tt[n.type]);var m=0|n.divisor;"divisor"in n&&(Oe.command(0==m||te,"cannot specify divisor for attribute \""+e+"\", instancing not supported",o.commandStr),Oe.command(0<=m,"invalid divisor for attribute \""+e+"\"",o.commandStr)),Oe.optional(function(){var t=o.commandStr,i=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(n).forEach(function(o){Oe.command(0<=i.indexOf(o),"unknown parameter \""+o+"\" for attribute pointer \""+e+"\" (valid parameters are "+i+")",t)})}),s.buffer=d,s.state=1,s.size=p,s.normalized=g,s.type=h||d.dtype,s.offset=u,s.stride=c,s.divisor=m}}r[e]=De(function(e){var t=e.attribCache;if(l in t)return t[l];var o={isStream:!1};return Object.keys(s).forEach(function(e){o[e]=s[e]}),s.buffer&&(o.buffer=e.link(s.buffer),o.type=o.type||o.buffer+".dtype"),t[l]=o,o})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=Ie(t,function(o,i){function n(e){i(f[e],"=",a,".",e,"|0;")}var a=o.invoke(i,t),r=o.shared,l=o.constants,s=r.isBufferArgs,d=r.buffer;Oe.optional(function(){o.assert(i,a+"&&(typeof "+a+"===\"object\"||typeof "+a+"===\"function\")&&("+s+"("+a+")||"+d+".getBuffer("+a+")||"+d+".getBuffer("+a+".buffer)||"+s+"("+a+".buffer)||(\"constant\" in "+a+"&&(typeof "+a+".constant===\"number\"||"+r.isArrayLike+"("+a+".constant))))","invalid dynamic attribute \""+e+"\"")});var f={isStream:i.def(!1)},u=new J;u.state=1,Object.keys(u).forEach(function(e){f[e]=i.def(""+u[e])});var c=f.buffer,p=f.type;return i("if(",s,"(",a,")){",f.isStream,"=true;",c,"=",d,".createStream(",34962,",",a,");",p,"=",c,".dtype;","}else{",c,"=",d,".getBuffer(",a,");","if(",c,"){",p,"=",c,".dtype;","}else if(\"constant\" in ",a,"){",f.state,"=",2,";","if(typeof "+a+".constant === \"number\"){",f[Xt[0]],"=",a,".constant;",Xt.slice(1).map(function(e){return f[e]}).join("="),"=0;","}else{",Xt.map(function(e,t){return f[e]+"="+a+".constant.length>"+t+"?"+a+".constant["+t+"]:0;"}).join(""),"}}else{","if(",s,"(",a,".buffer)){",c,"=",d,".createStream(",34962,",",a,".buffer);","}else{",c,"=",d,".getBuffer(",a,".buffer);","}",p,"=\"type\" in ",a,"?",l.glTypes,"[",a,".type]:",c,".dtype;",f.normalized,"=!!",a,".normalized;"),n("size"),n("offset"),n("stride"),n("divisor"),i("}}"),i.exit("if(",f.isStream,"){",d,".destroyStream(",c,");","}"),f})}),r}function D(e){var t=e.static,o=e.dynamic;if("vao"in t){var i=t.vao;return null!==i&&null===f.getVAO(i)&&(i=f.createVAO(i)),De(function(e){return e.link(f.getVAO(i))})}if("vao"in o){var n=o.vao;return Ie(n,function(e,t){var o=e.invoke(t,n);return t.def(e.shared.vao+".getVAO("+o+")")})}return null}function I(e){var t=e.static,o=e.dynamic,i={};return Object.keys(t).forEach(function(e){var o=t[e];i[e]=De(function(e){return"number"==typeof o||"boolean"==typeof o?""+o:e.link(o)})}),Object.keys(o).forEach(function(e){var t=o[e];i[e]=Ie(t,function(e,o){return e.invoke(o,t)})}),i}function F(e,t,i,n,a){function r(e){var t=c[e];t&&(g[e]=t)}var l=e.static,s=e.dynamic;Oe.optional(function(){function e(e){Object.keys(e).forEach(function(e){Oe.command(0<=t.indexOf(e),"unknown parameter \""+e+"\"",a.commandStr)})}var t=["framebuffer","vert","frag","elements","primitive","offset","count","instances","profile","vao"].concat(ae);e(l),e(s)});var d=A(e,t),u=v(e,a),c=T(e,u,a),p=E(e,a),g=B(e,a),h=C(e,a,d);r("viewport"),r(m("scissor.box"));var x=0<Object.keys(g).length,b={framebuffer:u,draw:p,shader:h,state:g,dirty:x,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(b.profile=y(e,a),b.uniforms=w(i,a),b.drawVAO=b.scopeVAO=D(e,a),!b.drawVAO&&h.program&&!d&&o.angle_instanced_arrays){var _=!0,F=h.program.attributes.map(function(e){var o=t.static[e];return _=_&&!!o,o});if(_&&0<F.length){var R=f.getVAO(f.createVAO(F));b.drawVAO=new Se(null,null,null,function(e){return e.link(R)}),b.useVAO=!0}}return d?b.useVAO=!0:b.attributes=S(t,a),b.context=I(n,a),b}function R(e,t,o){var i=e.shared,n=i.context,a=e.scope();Object.keys(o).forEach(function(i){t.save(n,"."+i);var r=o[i];a(n,".",i,"=",r.append(e,t),";")}),t(a)}function k(e,t,o,i){var n=e.shared,a=n.gl,r=n.framebuffer,l;oe&&(l=t.def(n.extensions,".webgl_draw_buffers"));var s=e.constants,d=s.drawBuffer,f=s.backBuffer,u;u=o?o.append(e,t):t.def(r,".next"),i||t("if(",u,"!==",r,".cur){"),t("if(",u,"){",a,".bindFramebuffer(",36160,",",u,".framebuffer);"),oe&&t(l,".drawBuffersWEBGL(",d,"[",u,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",36160,",null);"),oe&&t(l,".drawBuffersWEBGL(",f,");"),t("}",r,".cur=",u,";"),i||t("}")}function N(e,t,o){var i=e.shared,n=i.gl,a=e.current,r=e.next,l=i.current,s=i.next,d=e.cond(l,".dirty");ae.forEach(function(t){var i=m(t);if(!(i in o.state)){var f,u;if(i in r){f=r[i],u=a[i];var c=H(ie[i].length,function(e){return d.def(f,"[",e,"]")});d(e.cond(c.map(function(e,t){return e+"!=="+u+"["+t+"]"}).join("||")).then(n,".",le[i],"(",c,");",c.map(function(e,t){return u+"["+t+"]="+e}).join(";"),";"))}else{f=d.def(s,".",i);var p=e.cond(f,"!==",l,".",i);d(p),i in re?p(e.cond(f).then(n,".enable(",re[i],");").else(n,".disable(",re[i],");"),l,".",i,"=",f,";"):p(n,".",le[i],"(",f,");",l,".",i,"=",f,";")}}}),0===Object.keys(o.state).length&&d(l,".dirty=false;"),t(d)}function M(e,t,o,i){var n=e.shared,a=e.current,r=n.current,l=n.gl;we(Object.keys(o)).forEach(function(n){var s=o[n];if(!i||i(s)){var d=s.append(e,t);if(re[n]){var f=re[n];Le(s)?d?t(l,".enable(",f,");"):t(l,".disable(",f,");"):t(e.cond(d).then(l,".enable(",f,");").else(l,".disable(",f,");")),t(r,".",n,"=",d,";")}else if(Q(d)){var u=a[n];t(l,".",le[n],"(",d,");",d.map(function(e,t){return u+"["+t+"]="+e}).join(";"),";")}else t(l,".",le[n],"(",d,");",r,".",n,"=",d,";")}})}function V(e,t){te&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function O(e,t,o,i,n){function a(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function r(e){h=t.def(),e(h,"=",a(),";"),"string"==typeof n?e(f,".count+=",n,";"):e(f,".count++;"),g&&(i?(m=t.def(),e(m,"=",c,".getNumPendingQueries();")):e(c,".beginQuery(",f,");"))}function l(e){e(f,".cpuTime+=",a(),"-",h,";"),g&&(i?e(c,".pushScopeStats(",m,",",c,".getNumPendingQueries(),",f,");"):e(c,".endQuery();"))}function s(e){var o=t.def(u,".profile");t(u,".profile=",e,";"),t.exit(u,".profile=",o,";")}var d=e.shared,f=e.stats,u=d.current,c=d.timer,p=o.profile,h,m,x;if(p){if(Le(p))return void(p.enable?(r(t),l(t.exit),s("true")):s("false"));x=p.append(e,t),s(x)}else x=t.def(u,".profile");var b=e.block();r(b),t("if(",x,"){",b,"}");var _=e.block();l(_),t.exit("if(",x,"){",_,"}")}function z(e,t,o,i,n){function a(e){return 35664===e||35667===e||35671===e?2:35665===e||35668===e||35672===e?3:35666===e||35669===e||35673===e?4:1}function r(o,i,n){function a(){t("if(!",f,".buffer){",s,".enableVertexAttribArray(",d,");}");var o=n.type,a;if(a=n.size?t.def(n.size,"||",i):i,t("if(",f,".type!==",o,"||",f,".size!==",a,"||",g.map(function(e){return f+"."+e+"!=="+n[e]}).join("||"),"){",s,".bindBuffer(",34962,",",c,".buffer);",s,".vertexAttribPointer(",[d,a,o,n.normalized,n.stride,n.offset],");",f,".type=",o,";",f,".size=",a,";",g.map(function(e){return f+"."+e+"="+n[e]+";"}).join(""),"}"),te){var r=n.divisor;t("if(",f,".divisor!==",r,"){",e.instancing,".vertexAttribDivisorANGLE(",[d,r],");",f,".divisor=",r,";}")}}function r(){t("if(",f,".buffer){",s,".disableVertexAttribArray(",d,");",f,".buffer=null;","}if(",Xt.map(function(e,t){return f+"."+e+"!=="+p[t]}).join("||"),"){",s,".vertexAttrib4f(",d,",",p,");",Xt.map(function(e,t){return f+"."+e+"="+p[t]+";"}).join(""),"}")}var s=l.gl,d=t.def(o,".location"),f=t.def(l.attributes,"[",d,"]"),u=n.state,c=n.buffer,p=[n.x,n.y,n.z,n.w],g=["buffer","normalized","offset","stride"];u===1?a():u===2?r():(t("if(",u,"===",1,"){"),a(),t("}else{"),r(),t("}"))}var l=e.shared;i.forEach(function(i){var l=i.name,s=o.attributes[l],d;if(s){if(!n(s))return;d=s.append(e,t)}else{if(!n(ao))return;var f=e.scopeAttrib(l);Oe.optional(function(){e.assert(t,f+".state","missing attribute "+l)}),d={},Object.keys(new J).forEach(function(e){d[e]=t.def(f,".",e)})}r(e.link(i),a(i.info.type),d)})}function P(e,o,n,a,r){for(var l=e.shared,s=l.gl,d=0,f;d<a.length;++d){var u=a[d],c=u.name,p=u.info.type,g=n.uniforms[c],h=e.link(u),m=h+".location",x;if(g){if(!r(g))continue;if(Le(g)){var b=g.value;if(Oe.command(null!==b&&"undefined"!=typeof b,"missing uniform \""+c+"\"",e.commandStr),35678===p||35680===p){Oe.command("function"==typeof b&&(35678===p&&("texture2d"===b._reglType||"framebuffer"===b._reglType)||35680===p&&("textureCube"===b._reglType||"framebufferCube"===b._reglType)),"invalid texture for uniform "+c,e.commandStr);var _=e.link(b._texture||b.color[0]._texture);o(s,".uniform1i(",m,",",_+".bind());"),o.exit(_,".unbind();")}else if(35674===p||35675===p||35676===p){Oe.optional(function(){Oe.command(Q(b),"invalid matrix for uniform "+c,e.commandStr),Oe.command(35674===p&&4===b.length||35675===p&&9===b.length||35676===p&&16===b.length,"invalid length for matrix uniform "+c,e.commandStr)});var y=e.global.def("new Float32Array(["+Array.prototype.slice.call(b)+"])"),v=2;35675===p?v=3:35676===p&&(v=4),o(s,".uniformMatrix",v,"fv(",m,",false,",y,");")}else 5126===p?(Oe.commandType(b,"number","uniform "+c,e.commandStr),f="1f"):35664===p?(Oe.command(Q(b)&&2===b.length,"uniform "+c,e.commandStr),f="2f"):35665===p?(Oe.command(Q(b)&&3===b.length,"uniform "+c,e.commandStr),f="3f"):35666===p?(Oe.command(Q(b)&&4===b.length,"uniform "+c,e.commandStr),f="4f"):35670===p?(Oe.commandType(b,"boolean","uniform "+c,e.commandStr),f="1i"):5124===p?(Oe.commandType(b,"number","uniform "+c,e.commandStr),f="1i"):35671===p?(Oe.command(Q(b)&&2===b.length,"uniform "+c,e.commandStr),f="2i"):35667===p?(Oe.command(Q(b)&&2===b.length,"uniform "+c,e.commandStr),f="2i"):35672===p?(Oe.command(Q(b)&&3===b.length,"uniform "+c,e.commandStr),f="3i"):35668===p?(Oe.command(Q(b)&&3===b.length,"uniform "+c,e.commandStr),f="3i"):35673===p?(Oe.command(Q(b)&&4===b.length,"uniform "+c,e.commandStr),f="4i"):35669===p?(Oe.command(Q(b)&&4===b.length,"uniform "+c,e.commandStr),f="4i"):void 0,o(s,".uniform",f,"(",m,",",Q(b)?Array.prototype.slice.call(b):b,");");continue}else x=g.append(e,o)}else{if(!r(ao))continue;x=o.def(l.uniforms,"[",t.id(c),"]")}35678===p?o("if(",x,"&&",x,"._reglType===\"framebuffer\"){",x,"=",x,".color[0];","}"):35680===p&&o("if(",x,"&&",x,"._reglType===\"framebufferCube\"){",x,"=",x,".color[0];","}"),Oe.optional(function(){function t(t,i){e.assert(o,t,"bad data or missing for uniform \""+c+"\".  "+i)}function i(e){t("typeof "+x+"===\""+e+"\"","invalid type, expected "+e)}function n(o){t(l.isArrayLike+"("+x+")&&"+x+".length==="+o,"invalid vector, should have length "+o,e.commandStr)}function a(o){t("typeof "+x+"===\"function\"&&"+x+"._reglType===\"texture"+(3553===o?"2d":"Cube")+"\"","invalid texture type",e.commandStr)}5124===p?i("number"):35667===p?n(2,"number"):35668===p?n(3,"number"):35669===p?n(4,"number"):5126===p?i("number"):35664===p?n(2,"number"):35665===p?n(3,"number"):35666===p?n(4,"number"):35670===p?i("boolean"):35671===p?n(2,"boolean"):35672===p?n(3,"boolean"):35673===p?n(4,"boolean"):35674===p?n(4,"number"):35675===p?n(9,"number"):35676===p?n(16,"number"):35678===p?a(3553):35680===p?a(34067):void 0});var T=1;switch(p){case 35678:case 35680:var A=o.def(x,"._texture");o(s,".uniform1i(",m,",",A,".bind());"),o.exit(A,".unbind();");continue;case 5124:case 35670:f="1i";break;case 35667:case 35671:f="2i",T=2;break;case 35668:case 35672:f="3i",T=3;break;case 35669:case 35673:f="4i",T=4;break;case 5126:f="1f";break;case 35664:f="2f",T=2;break;case 35665:f="3f",T=3;break;case 35666:f="4f",T=4;break;case 35674:f="Matrix2fv";break;case 35675:f="Matrix3fv";break;case 35676:f="Matrix4fv";}if(o(s,".uniform",f,"(",m,","),"M"===f.charAt(0)){var C=ju(p-35674+2,2),E=e.global.def("new Float32Array(",C,")");o("false,(Array.isArray(",x,")||",x," instanceof Float32Array)?",x,":(",H(C,function(e){return E+"["+e+"]="+x+"["+e+"]"}),",",E,")")}else 1<T?o(H(T,function(e){return x+"["+e+"]"})):o(x);o(");")}}function G(e,t,o,i){function n(n){var a=f[n];return a?a.contextDep&&i.contextDynamic||a.propDep?a.append(e,o):a.append(e,t):t.def(d,".",n)}function a(){function e(){o(m,".drawElementsInstancedANGLE(",[c,g,x,p+"<<(("+x+"-"+5121+")>>1)",h],");")}function t(){o(m,".drawArraysInstancedANGLE(",[c,p,g,h],");")}u?b?e():(o("if(",u,"){"),e(),o("}else{"),t(),o("}")):t()}function r(){function e(){o(s+".drawElements("+[c,g,x,p+"<<(("+x+"-"+5121+")>>1)"]+");")}function t(){o(s+".drawArrays("+[c,p,g]+");")}u?b?e():(o("if(",u,"){"),e(),o("}else{"),t(),o("}")):t()}var l=e.shared,s=l.gl,d=l.draw,f=i.draw,u=function(){var n=f.elements,a=t,r;return n?((n.contextDep&&i.contextDynamic||n.propDep)&&(a=o),r=n.append(e,a)):r=a.def(d,".","elements"),r&&a("if("+r+")"+s+".bindBuffer("+34963+","+r+".buffer.buffer);"),r}(),c=n("primitive"),p=n("offset"),g=function(){var n=f.count,a=t,r;return n?((n.contextDep&&i.contextDynamic||n.propDep)&&(a=o),r=n.append(e,a),Oe.optional(function(){n.MISSING&&e.assert(t,"false","missing vertex count"),n.DYNAMIC&&e.assert(a,r+">=0","missing vertex count")})):(r=a.def(d,".","count"),Oe.optional(function(){e.assert(a,r+">=0","missing vertex count")})),r}();if(!("number"==typeof g))o("if(",g,"){"),o.exit("}");else if(0===g)return;var h,m;te&&(h=n("instances"),m=e.instancing);var x=u+".type",b=f.elements&&Le(f.elements);te&&("number"!=typeof h||0<=h)?"string"==typeof h?(o("if(",h,">0){"),a(),o("}else if(",h,"<0){"),r(),o("}")):a():r()}function j(e,t,o,i,n){var a=_(),r=a.proc("body",n);return Oe.optional(function(){a.commandStr=t.commandStr,a.command=a.link(t.commandStr)}),te&&(a.instancing=r.def(a.shared.extensions,".angle_instanced_arrays")),e(a,r,o,i),a.compile().body}function U(e,t,o,i){V(e,t),o.useVAO?o.drawVAO?t(e.shared.vao,".setVAO(",o.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),z(e,t,o,i.attributes,function(){return!0})),P(e,t,o,i.uniforms,function(){return!0}),G(e,t,t,o)}function W(e,t){var o=e.proc("draw",1);V(e,o),R(e,o,t.context),k(e,o,t.framebuffer),N(e,o,t),M(e,o,t.state),O(e,o,t,!1,!0);var i=t.shader.progVar.append(e,o);if(o(e.shared.gl,".useProgram(",i,".program);"),t.shader.program)U(e,o,t,t.shader.program);else{o(e.shared.vao,".setVAO(null);");var n=e.global.def("{}"),a=o.def(i,".id"),r=o.def(n,"[",a,"]");o(e.cond(r).then(r,".call(this,a0);").else(r,"=",n,"[",a,"]=",e.link(function(o){return j(U,e,t,o,1)}),"(",i,");",r,".call(this,a0);"))}0<Object.keys(t.state).length&&o(e.shared.current,".dirty=true;")}function X(e,t,o,i){function n(){return!0}e.batchId="a1",V(e,t),z(e,t,o,i.attributes,n),P(e,t,o,i.uniforms,n),G(e,t,t,o)}function q(e,t,o,i){function n(e){return e.contextDep&&r||e.propDep}function a(e){return!n(e)}V(e,t);var r=o.contextDep,l=t.def(),s=t.def();e.shared.props=s,e.batchId=l;var d=e.scope(),f=e.scope();if(t(d.entry,"for(",l,"=0;",l,"<","a1",";++",l,"){",s,"=","a0","[",l,"];",f,"}",d.exit),o.needsContext&&R(e,f,o.context),o.needsFramebuffer&&k(e,f,o.framebuffer),M(e,f,o.state,n),o.profile&&n(o.profile)&&O(e,f,o,!1,!0),!i){var u=e.global.def("{}"),c=o.shader.progVar.append(e,f),p=f.def(c,".id"),g=f.def(u,"[",p,"]");f(e.shared.gl,".useProgram(",c,".program);","if(!",g,"){",g,"=",u,"[",p,"]=",e.link(function(t){return j(X,e,o,t,2)}),"(",c,");}",g,".call(this,a0[",l,"],",l,");")}else o.useVAO?o.drawVAO?n(o.drawVAO)?f(e.shared.vao,".setVAO(",o.drawVAO.append(e,f),");"):d(e.shared.vao,".setVAO(",o.drawVAO.append(e,d),");"):d(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(d(e.shared.vao,".setVAO(null);"),z(e,d,o,i.attributes,a),z(e,f,o,i.attributes,n)),P(e,d,o,i.uniforms,a),P(e,f,o,i.uniforms,n),G(e,d,f,o)}function Y(e,t){function o(e){return e.contextDep&&n||e.propDep}var i=e.proc("batch",2);e.batchId="0",V(e,i);var n=!1,a=!0;Object.keys(t.context).forEach(function(e){n=n||t.context[e].propDep}),n||(R(e,i,t.context),a=!1);var r=t.framebuffer,l=!1;r?(r.propDep?n=l=!0:r.contextDep&&n&&(l=!0),!l&&k(e,i,r)):k(e,i,null),t.state.viewport&&t.state.viewport.propDep&&(n=!0),N(e,i,t),M(e,i,t.state,function(e){return!o(e)}),t.profile&&o(t.profile)||O(e,i,t,!1,"a1"),t.contextDep=n,t.needsContext=a,t.needsFramebuffer=l;var s=t.shader.progVar;if(s.contextDep&&n||s.propDep)q(e,i,t,null);else{var d=s.append(e,i);if(i(e.shared.gl,".useProgram(",d,".program);"),t.shader.program)q(e,i,t,t.shader.program);else{i(e.shared.vao,".setVAO(null);");var f=e.global.def("{}"),u=i.def(d,".id"),c=i.def(f,"[",u,"]");i(e.cond(c).then(c,".call(this,a0,a1);").else(c,"=",f,"[",u,"]=",e.link(function(o){return j(q,e,t,o,2)}),"(",d,");",c,".call(this,a0,a1);"))}}0<Object.keys(t.state).length&&i(e.shared.current,".dirty=true;")}function Z(e,o){function i(t){var i=o.shader[t];i&&n.set(a.shader,"."+t,i.append(e,n))}var n=e.proc("scope",3);e.batchId="a2";var a=e.shared,r=a.current;R(e,n,o.context),o.framebuffer&&o.framebuffer.append(e,n),we(Object.keys(o.state)).forEach(function(t){var i=o.state[t],r=i.append(e,n);Q(r)?r.forEach(function(o,a){n.set(e.next[t],"["+a+"]",o)}):n.set(a.next,"."+t,r)}),O(e,n,o,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(t){var i=o.draw[t];i&&n.set(a.draw,"."+t,""+i.append(e,n))}),Object.keys(o.uniforms).forEach(function(i){n.set(a.uniforms,"["+t.id(i)+"]",o.uniforms[i].append(e,n))}),Object.keys(o.attributes).forEach(function(t){var i=o.attributes[t].append(e,n),a=e.scopeAttrib(t);Object.keys(new J).forEach(function(e){n.set(a,"."+e,i[e])})}),o.scopeVAO&&n.set(a.vao,".targetVAO",o.scopeVAO.append(e,n)),i("vert"),i("frag"),0<Object.keys(o.state).length&&(n(r,".dirty=true;"),n.exit(r,".dirty=true;")),n("a1(",e.shared.context,",a0,",e.batchId,");")}function K(e){if(!("object"!=typeof e||Q(e))){for(var t=Object.keys(e),o=0;o<t.length;++o)if(Pe.isDynamic(e[t[o]]))return!0;return!1}}function $(e,t,o){function i(e,t){r.forEach(function(o){var i=n[o];if(Pe.isDynamic(i)){var a=e.invoke(t,i);t(f,".",o,"=",a,";")}})}var n=t.static[o];if(n&&K(n)){var a=e.global,r=Object.keys(n),l=!1,s=!1,d=!1,f=e.global.def("{}");r.forEach(function(t){var o=n[t];if(Pe.isDynamic(o)){"function"==typeof o&&(o=n[t]=Pe.unbox(o));var i=Ie(o,null);l=l||i.thisDep,d=d||i.propDep,s=s||i.contextDep}else{switch(a(f,".",t,"="),typeof o){case"number":a(o);break;case"string":a("\"",o,"\"");break;case"object":Array.isArray(o)&&a("[",o.join(),"]");break;default:a(e.link(o));}a(";")}}),t.dynamic[o]=new Pe.DynamicVariable(4,{thisDep:l,contextDep:s,propDep:d,ref:f,append:i}),delete t.static[o]}}var J=f.Record,ee={add:32774,subtract:32778,"reverse subtract":32779};o.ext_blend_minmax&&(ee.min=32775,ee.max=32776);var te=o.angle_instanced_arrays,oe=o.webgl_draw_buffers,ie={dirty:!0,profile:h.profile},ne={},ae=[],re={},le={};x("dither",3024),x("blend.enable",3042),b("blend.color","blendColor",[0,0,0,0]),b("blend.equation","blendEquationSeparate",[32774,32774]),b("blend.func","blendFuncSeparate",[1,0,1,0]),x("depth.enable",2929,!0),b("depth.func","depthFunc",513),b("depth.range","depthRange",[0,1]),b("depth.mask","depthMask",!0),b("colorMask","colorMask",[!0,!0,!0,!0]),x("cull.enable",2884),b("cull.face","cullFace",1029),b("frontFace","frontFace",2305),b("lineWidth","lineWidth",1),x("polygonOffset.enable",32823),b("polygonOffset.offset","polygonOffset",[0,0]),x("sample.alpha",32926),x("sample.enable",32928),b("sample.coverage","sampleCoverage",[1,!1]),x("stencil.enable",2960),b("stencil.mask","stencilMask",-1),b("stencil.func","stencilFunc",[519,0,-1]),b("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),b("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),x("scissor.enable",3089),b("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),b("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var se={gl:e,context:p,strings:t,next:ne,current:ie,draw:c,elements:r,buffer:a,shader:u,attributes:f.state,vao:f,uniforms:d,framebuffer:s,extensions:o,timer:g,isBufferArgs:Be},de={primTypes:rt,compareFuncs:to,blendFuncs:Jt,blendEquations:ee,stencilOps:oo,glTypes:tt,orientationType:no};Oe.optional(function(){se.isArrayLike=Q}),oe&&(de.backBuffer=[1029],de.drawBuffer=H(n.maxDrawbuffers,function(e){return 0===e?[0]:H(e,function(e){return 36064+e})}));var fe=0;return{next:ne,current:ie,procs:function(){var e=_(),t=e.proc("poll"),a=e.proc("refresh"),r=e.block();t(r),a(r);var l=e.shared,s=l.gl,d=l.next,f=l.current;r(f,".dirty=false;"),k(e,t),k(e,a,null,!0);var u;te&&(u=e.link(te)),o.oes_vertex_array_object&&a(e.link(o.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var c=0;c<n.maxAttributes;++c){var p=a.def(l.attributes,"[",c,"]"),g=e.cond(p,".buffer");g.then(s,".enableVertexAttribArray(",c,");",s,".bindBuffer(",34962,",",p,".buffer.buffer);",s,".vertexAttribPointer(",c,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(s,".disableVertexAttribArray(",c,");",s,".vertexAttrib4f(",c,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),a(g),te&&a(u,".vertexAttribDivisorANGLE(",c,",",p,".divisor);")}return a(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(re).forEach(function(o){var i=re[o],n=r.def(d,".",o),l=e.block();l("if(",n,"){",s,".enable(",i,")}else{",s,".disable(",i,")}",f,".",o,"=",n,";"),a(l),t("if(",n,"!==",f,".",o,"){",l,"}")}),Object.keys(le).forEach(function(o){var i=le[o],l=ie[o],u=e.block(),c,p;if(u(s,".",i,"("),Q(l)){var g=l.length;c=e.global.def(d,".",o),p=e.global.def(f,".",o),u(H(g,function(e){return c+"["+e+"]"}),");",H(g,function(e){return p+"["+e+"]="+c+"["+e+"];"}).join("")),t("if(",H(g,function(e){return c+"["+e+"]!=="+p+"["+e+"]"}).join("||"),"){",u,"}")}else c=r.def(d,".",o),p=r.def(f,".",o),u(c,");",f,".",o,"=",c,";"),t("if(",c,"!==",p,"){",u,"}");a(u)}),e.compile()}(),compile:function(e,t,o,i,n){var a=_();a.stats=a.link(n),Object.keys(t.static).forEach(function(e){$(a,t,e)}),Qt.forEach(function(t){$(a,e,t)});var r=F(e,t,o,i,a);return W(a,r),Z(a,r),Y(a,r),a.compile()}}}function Re(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}function ke(e,t){for(var o=0;o<e.length;++o)if(e[o]===t)return o;return-1}var Ne=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},Me=function(e,t){for(var o=Object.keys(t),n=0;n<o.length;++n)e[o[n]]=t[o[n]];return e},He=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"],Ve={};Ve[5120]=Ve[5121]=1,Ve[5122]=Ve[5123]=Ve[36193]=Ve[33635]=Ve[32819]=Ve[32820]=2,Ve[5124]=Ve[5125]=Ve[5126]=Ve[34042]=4;var Oe=Me(o,{optional:function(e){e()},raise:t,commandRaise:b,command:function(e,t,o){e||b(t,o||u())},parameter:n,commandParameter:_,constructor:function(e){Object.keys(e).forEach(function(e){0>He.indexOf(e)&&t("invalid regl constructor argument \""+e+"\". must be one of "+He)})},type:function(e,o,n){a(e,o)||t("invalid parameter type"+i(n)+". expected "+o+", got "+typeof e)},commandType:y,isTypedArray:function(e,o){Ne(e)||t("invalid parameter type"+i(o)+". must be a typed array")},nni:function(e,o){0<=e&&(0|e)===e||t("invalid parameter type, ("+e+")"+i(o)+". must be a nonnegative integer")},oneOf:r,shaderError:function(e,t,i,n,a){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(t),s=n===e.FRAGMENT_SHADER?"fragment":"vertex";y(i,"string",s+" shader source must be a string",a);var d=p(i,a),f=g(r);h(d,f),Object.keys(d).forEach(function(e){function t(e,t){i.push(e),n.push(t||"")}var o=d[e];if(o.hasErrors){var i=[""],n=[""];t("file number "+e+": "+o.name+"\n","color:red;text-decoration:underline;font-weight:bold"),o.lines.forEach(function(e){if(0<e.errors.length){t(l(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),t(e.line+"\n","color:red; background-color:yellow; font-weight:bold");var o=0;e.errors.forEach(function(i){var n=i.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(n);if(a){var r=a[1];n=a[2],"assign"===r?r="=":void 0,o=qu(e.line.indexOf(r,o),0)}else o=0;t(l("| ",6)),t(l("^^^",o+3)+"\n","font-weight:bold"),t(l("| ",6)),t(n+"\n","font-weight:bold")}),t(l("| ",6)+"\n")}else t(l(e.number,4)+"|  "),t(e.line+"\n","color:red")}),"undefined"==typeof document||window.chrome?console.log(i.join("")):(n[0]=i.join("%c"),console.log.apply(console,n))}}),o.raise("Error compiling "+s+" shader, "+d[0].name)}},linkError:function(e,t,i,n,a){if(!e.getProgramParameter(t,e.LINK_STATUS)){var r=e.getProgramInfoLog(t),l=p(i,a),s=p(n,a),d="Error linking program with vertex shader, \""+s[0].name+"\", and fragment shader \""+l[0].name+"\"";"undefined"==typeof document?console.log(d+"\n"+r):console.log("%c"+d+"\n"+"%c"+r,"color:red;text-decoration:underline;font-weight:bold","color:red"),o.raise(d)}},callSite:c,saveCommandRef:m,saveDrawInfo:x,framebufferFormat:function(e,t,o){e.texture?r(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):r(e.renderbuffer._renderbuffer.format,o,"unsupported renderbuffer format for attachment")},guessCommand:u,texture2D:function(e,t,n){var a=t.width,r=t.height,l=t.channels,s;o(0<a&&a<=n.maxTextureSize&&0<r&&r<=n.maxTextureSize,"invalid texture shape"),(e.wrapS!==33071||e.wrapT!==33071)&&o(T(a)&&T(r),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==a&&1!==r&&o(e.minFilter!==9984&&e.minFilter!==9986&&e.minFilter!==9985&&e.minFilter!==9987,"min filter requires mipmap"):(o(T(a)&&T(r),"texture must be a square power of 2 to support mipmapping"),o(t.mipmask===(a<<1)-1,"missing or incomplete mipmap data")),t.type===5126&&(0>n.extensions.indexOf("oes_texture_float_linear")&&o(e.minFilter===9728&&e.magFilter===9728,"filter not supported, must enable oes_texture_float_linear"),o(!e.genMipmaps,"mipmap generation not supported with float textures"));var d=t.images;for(s=0;16>s;++s)if(d[s]){var f=a>>s,u=r>>s;o(t.mipmask&1<<s,"missing mipmap data");var c=d[s];if(o(c.width===f&&c.height===u,"invalid shape for mip images"),o(c.format===t.format&&c.internalformat===t.internalformat&&c.type===t.type,"incompatible type for mip image"),c.compressed);else if(c.data){var p=Yu(v(c.type,l)*f/c.unpackAlignment)*c.unpackAlignment;o(c.data.byteLength===p*u,"invalid data for image, buffer size is inconsistent with image format")}else if(c.element);else if(c.copy);}else e.genMipmaps||o(0==(t.mipmask&1<<s),"extra mipmap data");t.compressed&&o(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,n,a){var r=e.width,l=e.height,s=e.channels;o(0<r&&r<=a.maxTextureSize&&0<l&&l<=a.maxTextureSize,"invalid texture shape"),o(r===l,"cube map must be square"),o(t.wrapS===33071&&t.wrapT===33071,"wrap mode not supported by cube map");for(var d=0,f;d<n.length;++d){f=n[d],o(f.width===r&&f.height===l,"inconsistent cube map face shape"),t.genMipmaps&&(o(!f.compressed,"can not generate mipmap for compressed textures"),o(1===f.mipmask,"can not specify mipmaps and generate mipmaps"));for(var u=f.images,c=0,p;16>c;++c)if(p=u[c],p){var g=r>>c,h=l>>c;if(o(f.mipmask&1<<c,"missing mipmap data"),o(p.width===g&&p.height===h,"invalid shape for mip images"),o(p.format===e.format&&p.internalformat===e.internalformat&&p.type===e.type,"incompatible type for mip image"),p.compressed);else if(p.data)o(p.data.byteLength===g*h*qu(v(p.type,s),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format");else if(p.element);else if(p.copy);}}}}),ze=0,Pe={DynamicVariable:A,define:function(e,t){return new A(e,B(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof A},unbox:function(e){return"function"==typeof e?new A(0,e):e},accessor:B},Ge={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},je="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Ue=z();Ue.zero=z();var We=3553,Xe=34067,qe=6408,Ye=5126,Ze=5121,Ke=36160,$e=function(e,t){var o=1;t.ext_texture_filter_anisotropic&&(o=e.getParameter(34047));var i=1,n=1;t.webgl_draw_buffers&&(i=e.getParameter(34852),n=e.getParameter(36063));var a=!!t.oes_texture_float;if(a){var r=e.createTexture();e.bindTexture(We,r),e.texImage2D(We,0,qe,1,1,0,qe,Ye,null);var l=e.createFramebuffer();if(e.bindFramebuffer(Ke,l),e.framebufferTexture2D(Ke,36064,We,r,0),e.bindTexture(We,null),e.checkFramebufferStatus(Ke)!==36053)a=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var s=Ue.allocType(Ye,4);e.readPixels(0,0,1,1,qe,Ye,s),e.getError()?a=!1:(e.deleteFramebuffer(l),e.deleteTexture(r),a=1===s[0]),Ue.freeType(s)}}var d="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),f=!0;if(!d){var u=e.createTexture(),c=Ue.allocType(Ze,36);e.activeTexture(33984),e.bindTexture(Xe,u),e.texImage2D(34069,0,qe,3,3,0,qe,Ze,c),Ue.freeType(c),e.bindTexture(Xe,null),e.deleteTexture(u),f=!e.getError()}return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:o,maxDrawbuffers:i,maxColorAttachments:n,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:a,npotTextureCube:f}},Qe=function(e){return Object.keys(e).map(function(t){return e[t]})},Je={shape:function(e){for(var t=[],o=e;o.length;o=o[0])t.push(o.length);return t},flatten:function(e,t,o,n){var a=1;if(t.length)for(var r=0;r<t.length;++r)a*=t[r];else a=0;var l=n||Ue.allocType(o,a);switch(t.length){case 0:break;case 1:G(e,t[0],l);break;case 2:j(e,t[0],t[1],l);break;case 3:U(e,t[0],t[1],t[2],l,0);break;default:W(e,t,0,l,0);}return l}},et={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},tt={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ot={dynamic:35048,stream:35040,static:35044},it=Je.flatten,nt=Je.shape,at=[];at[5120]=1,at[5122]=2,at[5124]=4,at[5121]=1,at[5123]=2,at[5125]=4,at[5126]=4;var rt={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},lt=new Float32Array(1),st=new Uint32Array(lt.buffer),dt=function(e){return!(e&e-1)&&!!e},ft=6408,ut=6407,ct=6409,pt=6410,gt=34041,ht=[9984,9986,9985,9987],mt=[0,ct,pt,ut,ft],xt={};xt[ct]=xt[6406]=xt[6402]=1,xt[gt]=xt[pt]=2,xt[ut]=xt[35904]=3,xt[ft]=xt[35906]=4;var bt=J("HTMLCanvasElement"),_t=J("OffscreenCanvas"),yt=J("CanvasRenderingContext2D"),vt=J("ImageBitmap"),Tt=J("HTMLImageElement"),At=J("HTMLVideoElement"),Ct=Object.keys(et).concat([bt,_t,yt,vt,Tt,At]),Et=[];Et[5121]=1,Et[5126]=4,Et[36193]=2,Et[5123]=2,Et[5125]=4;var Bt=[];Bt[32854]=2,Bt[32855]=2,Bt[36194]=2,Bt[gt]=4,Bt[33776]=.5,Bt[33777]=.5,Bt[33778]=1,Bt[33779]=1,Bt[35986]=.5,Bt[35987]=1,Bt[34798]=1,Bt[35840]=.5,Bt[35841]=.25,Bt[35842]=.5,Bt[35843]=.25,Bt[36196]=.5;var wt=32854,St=32855,Lt=36194,Dt=33189,It=36168,Ft=34041,Rt=35907,kt=34836,Nt=34842,Mt=34843,Ht=[];Ht[wt]=2,Ht[St]=2,Ht[Lt]=2,Ht[Dt]=2,Ht[It]=1,Ht[Ft]=4,Ht[Rt]=4,Ht[kt]=16,Ht[Nt]=8,Ht[Mt]=6;var Vt=function(e,t,o,i,n){function r(e){this.id=f++,this.refCount=1,this.renderbuffer=e,this.format=wt,this.width=0,this.height=0,n.profile&&(this.stats={size:0})}function l(t){var o=t.renderbuffer;Oe(o,"must not double destroy renderbuffer"),e.bindRenderbuffer(36161,null),e.deleteRenderbuffer(o),t.renderbuffer=null,t.refCount=0,delete u[t.id],i.renderbufferCount--}var s={rgba4:wt,rgb565:Lt,"rgb5 a1":St,depth:Dt,stencil:It,"depth stencil":Ft};t.ext_srgb&&(s.srgba=Rt),t.ext_color_buffer_half_float&&(s.rgba16f=Nt,s.rgb16f=Mt),t.webgl_color_buffer_float&&(s.rgba32f=kt);var d=[];Object.keys(s).forEach(function(e){var t=s[e];d[t]=e});var f=0,u={};return r.prototype.decRef=function(){0>=--this.refCount&&l(this)},n.profile&&(i.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach(function(t){e+=u[t].stats.size}),e}),{create:function(t,a){function l(t,i){var a=0,r=0,u=wt;if("object"==typeof t&&t){var c=t;if("shape"in c){var p=c.shape;Oe(Array.isArray(p)&&2<=p.length,"invalid renderbuffer shape"),a=0|p[0],r=0|p[1]}else"radius"in c&&(a=r=0|c.radius),"width"in c&&(a=0|c.width),"height"in c&&(r=0|c.height);"format"in c&&(Oe.parameter(c.format,s,"invalid renderbuffer format"),u=s[c.format])}else"number"==typeof t?(a=0|t,r="number"==typeof i?0|i:a):t?Oe.raise("invalid arguments to renderbuffer constructor"):a=r=1;return(Oe(0<a&&0<r&&a<=o.maxRenderbufferSize&&r<=o.maxRenderbufferSize,"invalid renderbuffer size"),a!==f.width||r!==f.height||u!==f.format)?(l.width=f.width=a,l.height=f.height=r,f.format=u,e.bindRenderbuffer(36161,f.renderbuffer),e.renderbufferStorage(36161,u,a,r),Oe(0===e.getError(),"invalid render buffer format"),n.profile&&(f.stats.size=xe(f.format,f.width,f.height)),l.format=d[f.format],l):void 0}var f=new r(e.createRenderbuffer());return u[f.id]=f,i.renderbufferCount++,l(t,a),l.resize=function(t,i){var a=0|t,r=0|i||a;return a===f.width&&r===f.height?l:(Oe(0<a&&0<r&&a<=o.maxRenderbufferSize&&r<=o.maxRenderbufferSize,"invalid renderbuffer size"),l.width=f.width=a,l.height=f.height=r,e.bindRenderbuffer(36161,f.renderbuffer),e.renderbufferStorage(36161,f.format,a,r),Oe(0===e.getError(),"invalid render buffer format"),n.profile&&(f.stats.size=xe(f.format,f.width,f.height)),l)},l._reglType="renderbuffer",l._renderbuffer=f,n.profile&&(l.stats=f.stats),l.destroy=function(){f.decRef()},l},clear:function(){Qe(u).forEach(l)},restore:function(){Qe(u).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,t.renderbuffer),e.renderbufferStorage(36161,t.format,t.width,t.height)}),e.bindRenderbuffer(36161,null)}}},Ot=6407,zt=6408,Pt=[Ot,zt],Gt=[];Gt[zt]=4,Gt[Ot]=3;var jt=[];jt[5121]=1,jt[5126]=4,jt[36193]=2;var Ut=[32854,32855,36194,35907,34842,34843,34836],Wt={};Wt[36053]="complete",Wt[36054]="incomplete attachment",Wt[36057]="incomplete dimensions",Wt[36055]="incomplete, missing attachment",Wt[36061]="unsupported";var Xt=["x","y","z","w"],qt="viewport",Yt="framebuffer",Zt="Width",Kt="Height",$t="drawingBuffer",Qt=["blend.func","blend.equation","stencil.func","stencil.opFront","stencil.opBack","sample.coverage",qt,"scissor.box","polygonOffset.offset"],Jt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},eo=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],to={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},oo={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},io={frag:35632,vert:35633},no={cw:2304,ccw:2305},ao=new Se(!1,!1,!1,function(){}),ro=35007,lo=function(e,t){function o(){return d.pop()||t.ext_disjoint_timer_query.createQueryEXT()}function n(e){d.push(e)}function a(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}function r(){return u.pop()||new a}function l(e){u.push(e)}function s(e,t,o){var i=r();i.startQueryIndex=e,i.endQueryIndex=t,i.sum=0,i.stats=o,c.push(i)}if(!t.ext_disjoint_timer_query)return null;var d=[],f=[],u=[],c=[],p=[],g=[];return{beginQuery:function(e){var i=o();t.ext_disjoint_timer_query.beginQueryEXT(ro,i),f.push(i),s(f.length-1,f.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(ro)},pushScopeStats:s,update:function(){var e=f.length,o,a;if(0!==e){g.length=qu(g.length,e+1),p.length=qu(p.length,e+1),p[0]=0,g[0]=0;var r=0;for(o=0,a=0;a<f.length;++a){var s=f[a];t.ext_disjoint_timer_query.getQueryObjectEXT(s,34919)?(r+=t.ext_disjoint_timer_query.getQueryObjectEXT(s,34918),n(s)):f[o++]=s,p[a+1]=r,g[a+1]=o}for(f.length=o,o=0,a=0;a<c.length;++a){var d=c[a],u=d.startQueryIndex,h=d.endQueryIndex;d.sum+=p[h]-p[u];var m=g[u],x=g[h];x===m?(d.stats.gpuTime+=d.sum/1e6,l(d)):(d.startQueryIndex=m,d.endQueryIndex=x,c[o++]=d)}c.length=o}},getNumPendingQueries:function(){return f.length},clear:function(){d.push.apply(d,f);for(var e=0;e<d.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(d[e]);f.length=0,d.length=0},restore:function(){f.length=0,d.length=0}}};return function(e){function t(){if(0===U.length)return A&&A.update(),void(Y=null);Y=Ge.next(t),u();for(var e=U.length-1,o;0<=e;--e)o=U[e],o&&o(S,null,0);m.flush(),A&&A.update()}function o(){!Y&&0<U.length&&(Y=Ge.next(t))}function i(){Y&&(Ge.cancel(t),Y=null)}function n(e){e.preventDefault(),b=!0,i(),W.forEach(function(e){e()})}function a(){m.getError(),b=!1,_.restore(),k.restore(),I.restore(),H.restore(),V.restore(),O.restore(),F.restore(),A&&A.restore(),z.procs.refresh(),o(),X.forEach(function(e){e()})}function r(e){function t(e){function t(e){if(e in o){var t=o[e];delete o[e],Object.keys(t).forEach(function(i){o[e+"."+i]=t[i]})}}var o=Me({},e);return delete o.uniforms,delete o.attributes,delete o.context,delete o.vao,"stencil"in o&&o.stencil.op&&(o.stencil.opBack=o.stencil.opFront=o.stencil.op,delete o.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),"vao"in e&&(o.vao=e.vao),o}function o(e){var t={},o={};return Object.keys(e).forEach(function(i){var n=e[i];Pe.isDynamic(n)?o[i]=Pe.unbox(n,i):t[i]=n}),{dynamic:o,static:t}}function n(e){for(;h.length<e;)h.push(null);return h}function a(e,t){var o;if(b&&Oe.raise("context lost"),"function"==typeof e)return g.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e)for(o=0;o<e;++o)g.call(this,null,t,o);else if(Array.isArray(e))for(o=0;o<e.length;++o)g.call(this,e[o],t,o);else return g.call(this,e,t,0);}else if("number"!=typeof e){if(!Array.isArray(e))return c.call(this,e);if(e.length)return p.call(this,e,e.length)}else if(0<e)return p.call(this,n(0|e),0|e)}Oe(!!e,"invalid args to regl({...})"),Oe.type(e,"object","invalid args to regl({...})");var r=o(e.context||{}),l=o(e.uniforms||{}),s=o(e.attributes||{}),d=o(t(e)),f={gpuTime:0,cpuTime:0,count:0},u=z.compile(d,s,l,r,f),c=u.draw,p=u.batch,g=u.scope,h=[];return Me(a,{stats:f})}function l(e,t){var o=0;z.procs.poll();var i=t.color;i&&(m.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),o|=16384),"depth"in t&&(m.clearDepth(+t.depth),o|=256),"stencil"in t&&(m.clearStencil(0|t.stencil),o|=1024),Oe(!!o,"called regl.clear with no buffer specified"),m.clear(o)}function s(e){if(Oe("object"==typeof e&&e,"regl.clear() takes an object as input"),!("framebuffer"in e))l(null,e);else if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)$(Me({framebuffer:e.framebuffer.faces[t]},e),l);else $(e,l)}function d(e){return Oe.type(e,"function","regl.frame() callback must be a function"),U.push(e),o(),{cancel:function(){function t(){var e=ke(U,t);U[e]=U[U.length-1],U.length-=1,0>=U.length&&i()}var o=ke(U,e);Oe(0<=o,"cannot cancel a frame twice"),U[o]=t}}}function f(){var e=G.viewport,t=G.scissor_box;e[0]=e[1]=t[0]=t[1]=0,S.viewportWidth=S.framebufferWidth=S.drawingBufferWidth=e[2]=t[2]=m.drawingBufferWidth,S.viewportHeight=S.framebufferHeight=S.drawingBufferHeight=e[3]=t[3]=m.drawingBufferHeight}function u(){S.tick+=1,S.time=p(),f(),z.procs.poll()}function c(){f(),z.procs.refresh(),A&&A.update()}function p(){return(je()-C)/1e3}function g(e,t){Oe.type(t,"function","listener callback must be a function");var o;switch(e){case"frame":return d(t);case"lost":o=W;break;case"restore":o=X;break;case"destroy":o=q;break;default:Oe.raise("invalid event, must be one of frame,lost,restore,destroy");}return o.push(t),{cancel:function(){for(var e=0;e<o.length;++e)if(o[e]===t)return o[e]=o[o.length-1],void o.pop()}}}var h=N(e);if(!h)return null;var m=h.gl,x=m.getContextAttributes(),b=m.isContextLost(),_=M(m,h);if(!_)return null;var y=w(),v=Re(),T=_.extensions,A=lo(m,T),C=je(),E=m.drawingBufferWidth,B=m.drawingBufferHeight,S={tick:0,time:0,viewportWidth:E,viewportHeight:B,framebufferWidth:E,framebufferHeight:B,drawingBufferWidth:E,drawingBufferHeight:B,pixelRatio:h.pixelRatio},D=$e(m,T),I=Z(m,v,h,function(e){return F.destroyBuffer(e)}),F=ye(m,T,D,v,I),R=K(m,T,I,v),k=ve(m,y,v,h),H=me(m,T,D,function(){z.procs.poll()},S,v,h),V=Vt(m,T,D,v,h),O=be(m,T,D,H,V,v),z=Fe(m,y,T,D,I,R,H,O,{},F,k,{elements:null,primitive:4,count:-1,offset:0,instances:-1},S,A,h),P=Te(m,O,z.procs.poll,S,x,T,D),G=z.next,j=m.canvas,U=[],W=[],X=[],q=[h.onDestroy],Y=null;j&&(j.addEventListener("webglcontextlost",n,!1),j.addEventListener("webglcontextrestored",a,!1));var $=O.setFBO=r({framebuffer:Pe.define.call(null,1,"framebuffer")});c();var Q=Me(r,{clear:s,prop:Pe.define.bind(null,1),context:Pe.define.bind(null,2),this:Pe.define.bind(null,3),draw:r({}),buffer:function(e){return I.create(e,34962,!1,!1)},elements:function(e){return R.create(e,!1)},texture:H.create2D,cube:H.createCube,renderbuffer:V.create,framebuffer:O.create,framebufferCube:O.createCube,vao:F.createVAO,attributes:x,frame:d,on:g,limits:D,hasExtension:function(e){return 0<=D.extensions.indexOf(e.toLowerCase())},read:P,destroy:function(){U.length=0,i(),j&&(j.removeEventListener("webglcontextlost",n),j.removeEventListener("webglcontextrestored",a)),k.clear(),O.clear(),V.clear(),H.clear(),R.clear(),I.clear(),F.clear(),A&&A.clear(),q.forEach(function(e){e()})},_gl:m,_refresh:c,poll:function(){u(),A&&A.update()},now:p,stats:v});return h.onDone(null,Q),Q}})}),x_=[0,0,0,0],b_=1024,__=Gn(function(e,t){function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)o(i,n)&&(e[n]=i[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,o,n,a){if(t.subarray&&e.subarray)return void e.set(t.subarray(o,o+n),a);for(var r=0;r<n;r++)e[a+r]=t[o+r]},flattenChunks:function(e){var t,o,n,a,r,s;for(n=0,t=0,o=e.length;t<o;t++)n+=e[t].length;for(s=new Uint8Array(n),a=0,(t=0,o=e.length);t<o;t++)r=e[t],s.set(r,a),a+=r.length;return s}},a={arraySet:function(e,t,o,n,a){for(var r=0;r<n;r++)e[a+r]=t[o+r]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,n)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(i)}),y_=__.assign,v_=__.shrinkBuf,T_=__.setTyped,A_=__.Buf8,C_=__.Buf16,E_=__.Buf32,B_=29,w_=256+1+B_,S_=30,L_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],D_=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F_=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R_=Array(2*(w_+2));jn(R_);var k_=Array(2*S_);jn(k_);var N_=Array(512);jn(N_);var M_=Array(258-3+1);jn(M_);var H_=Array(B_);jn(H_);var V_=Array(S_);jn(V_);var O_=!1,z_={_tr_init:ha,_tr_stored_block:ma,_tr_flush_block:function(e,t,o,i){var n=0,a,r;0<e.level?(e.strm.data_type===2&&(e.strm.data_type=ga(e)),da(e,e.l_desc),da(e,e.d_desc),n=ca(e),a=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=a&&(a=r)):a=r=o+5,o+4<=a&&-1!==t?ma(e,t,o,i):e.strategy===4||r===a?(Kn(e,2+(i?1:0),3),sa(e,R_,k_)):(Kn(e,4+(i?1:0),3),pa(e,e.l_desc.max_code+1,e.d_desc.max_code+1,n+1),sa(e,e.dyn_ltree,e.dyn_dtree)),ia(e),i&&na(e)},_tr_tally:function(e,t,o){return e.pending_buf[e.d_buf+2*e.last_lit]=255&t>>>8,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&o,e.last_lit++,0===t?e.dyn_ltree[2*o]++:(e.matches++,t--,e.dyn_ltree[2*(M_[o]+256+1)]++,e.dyn_dtree[2*qn(t)]++),e.last_lit===e.lit_bufsize-1},_tr_align:function(e){Kn(e,2,3),$n(e,256,R_),Jn(e)}},P_=function(e,t,o,i){for(var a=0|65535&e,r=0|65535&e>>>16,l=0;0!==o;){l=2e3<o?2e3:o,o-=l;do a=0|a+t[i++],r=0|r+a;while(--l);a%=65521,r%=65521}return 0|(a|r<<16)},G_=function(){for(var e=[],t=0,o;256>t;t++){o=t;for(var i=0;8>i;i++)o=1&o?3988292384^o>>>1:o>>>1;e[t]=o}return e}(),j_=function(e,t,o,n){e^=-1;for(var a=n;a<n+o;a++)e=e>>>8^G_[255&(e^t[a])];return-1^e},U_={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},W_,X_,q_,Y_;Y_=[new Ia(0,0,0,0,function(e,t){var o=65535;for(o>e.pending_buf_size-5&&(o=e.pending_buf_size-5);;){if(1>=e.lookahead){if(Ba(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+o;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,va(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(va(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(va(e,!0),0===e.strm.avail_out?3:4):e.strstart>e.block_start&&(va(e,!1),0===e.strm.avail_out)?1:1}),new Ia(4,4,8,4,wa),new Ia(4,5,16,8,wa),new Ia(4,6,32,32,wa),new Ia(4,4,16,16,Sa),new Ia(8,16,32,32,Sa),new Ia(8,16,128,128,Sa),new Ia(8,32,128,256,Sa),new Ia(32,128,258,1024,Sa),new Ia(32,258,258,4096,Sa)];var Z_={deflateInit:function(e,t){return Ma(e,t,8,15,8,0)},deflateInit2:Ma,deflateReset:Na,deflateResetKeep:ka,deflateSetHeader:function(e,t){return e&&e.state?2===e.state.wrap?(e.state.gzhead=t,0):-2:-2},deflate:Ha,deflateEnd:function(e){var t;return e&&e.state?(t=e.state.status,42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t)?xa(e,-2):(e.state=null,113===t?xa(e,-3):0):-2},deflateSetDictionary:function(e,t){var o=t.length,i,a,r,l,d,f,u,c;if(!e||!e.state)return-2;if(i=e.state,l=i.wrap,2===l||1===l&&42!==i.status||i.lookahead)return-2;for(1===l&&(e.adler=P_(e.adler,t,o,0)),i.wrap=0,o>=i.w_size&&(0===l&&(_a(i.head),i.strstart=0,i.block_start=0,i.insert=0),c=new __.Buf8(i.w_size),__.arraySet(c,t,o-i.w_size,i.w_size,0),t=c,o=i.w_size),d=e.avail_in,f=e.next_in,u=e.input,e.avail_in=o,e.next_in=0,e.input=t,Ba(i);3<=i.lookahead;){a=i.strstart,r=i.lookahead-2;do i.ins_h=(i.ins_h<<i.hash_shift^i.window[a+3-1])&i.hash_mask,i.prev[a&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=a,a++;while(--r);i.strstart=a,i.lookahead=2,Ba(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=f,e.input=u,e.avail_in=d,i.wrap=l,0},deflateInfo:"pako deflate (from Nodeca project)"},K_=!0,$_=!0;try{Ku.apply(null,[0])}catch(e){K_=!1}try{Ku.apply(null,new Uint8Array(1))}catch(e){$_=!1}for(var Q_=new __.Buf8(256),J_=0;256>J_;J_++)Q_[J_]=252<=J_?6:248<=J_?5:240<=J_?4:224<=J_?3:192<=J_?2:1;Q_[254]=Q_[254]=1;var ey={string2buf:function(e){var t=e.length,o=0,n,a,r,l,s;for(l=0;l<t;l++)a=e.charCodeAt(l),55296==(64512&a)&&l+1<t&&(r=e.charCodeAt(l+1),56320==(64512&r)&&(a=65536+(a-55296<<10)+(r-56320),l++)),o+=128>a?1:2048>a?2:65536>a?3:4;for(n=new __.Buf8(o),s=0,l=0;s<o;l++)a=e.charCodeAt(l),55296==(64512&a)&&l+1<t&&(r=e.charCodeAt(l+1),56320==(64512&r)&&(a=65536+(a-55296<<10)+(r-56320),l++)),128>a?n[s++]=a:2048>a?(n[s++]=192|a>>>6,n[s++]=128|63&a):65536>a?(n[s++]=224|a>>>12,n[s++]=128|63&a>>>6,n[s++]=128|63&a):(n[s++]=240|a>>>18,n[s++]=128|63&a>>>12,n[s++]=128|63&a>>>6,n[s++]=128|63&a);return n},buf2binstring:function(e){return Va(e,e.length)},binstring2buf:function(e){for(var t=new __.Buf8(e.length),o=0,n=t.length;o<n;o++)t[o]=e.charCodeAt(o);return t},buf2string:function(e,t){var o=t||e.length,n=Array(2*o),a,r,l,s;for(r=0,a=0;a<o;){if(l=e[a++],128>l){n[r++]=l;continue}if(s=Q_[l],4<s){n[r++]=65533,a+=s-1;continue}for(l&=2===s?31:3===s?15:7;1<s&&a<o;)l=l<<6|63&e[a++],s--;if(1<s){n[r++]=65533;continue}65536>l?n[r++]=l:(l-=65536,n[r++]=55296|1023&l>>10,n[r++]=56320|1023&l)}return Va(n,r)},utf8border:function(e,t){var o;for(t=t||e.length,t>e.length&&(t=e.length),o=t-1;0<=o&&128==(192&e[o]);)o--;return 0>o?t:0===o?t:o+Q_[e[o]]>t?o:t}},ty=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},oy=Object.prototype.toString,iy=4,ny=0,ay=1,ry=2;Oa.prototype.push=function(e,t){var o=this.strm,i=this.options.chunkSize,n,a;if(this.ended)return!1;a=t===~~t?t:!0===t?iy:0,o.input="string"==typeof e?ey.string2buf(e):"[object ArrayBuffer]"===oy.call(e)?new Uint8Array(e):e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new __.Buf8(i),o.next_out=0,o.avail_out=i),n=Z_.deflate(o,a),n!==ay&&n!==ny)return this.onEnd(n),this.ended=!0,!1;(0===o.avail_out||0===o.avail_in&&(a===iy||a===ry))&&("string"===this.options.to?this.onData(ey.buf2binstring(__.shrinkBuf(o.output,o.next_out))):this.onData(__.shrinkBuf(o.output,o.next_out)))}while((0<o.avail_in||0===o.avail_out)&&n!==ay);return a===iy?(n=Z_.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===ny):a!==ry||(this.onEnd(ny),o.avail_out=0,!0)},Oa.prototype.onData=function(e){this.chunks.push(e)},Oa.prototype.onEnd=function(e){e===ny&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=__.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ly=30,sy=function(e,t){var o,i,n,a,r,l,s,d,f,u,c,p,g,h,m,x,b,_,y,v,T,A,C,E,B;o=e.state,i=e.next_in,E=e.input,n=i+(e.avail_in-5),a=e.next_out,B=e.output,r=a-(t-e.avail_out),l=a+(e.avail_out-257),s=o.dmax,d=o.wsize,f=o.whave,u=o.wnext,c=o.window,p=o.hold,g=o.bits,h=o.lencode,m=o.distcode,x=(1<<o.lenbits)-1,b=(1<<o.distbits)-1;top:do{15>g&&(p+=E[i++]<<g,g+=8,p+=E[i++]<<g,g+=8),_=h[p&x];dolen:for(;;){if(y=_>>>24,p>>>=y,g-=y,y=255&_>>>16,0===y)B[a++]=65535&_;else if(16&y){v=65535&_,y&=15,y&&(g<y&&(p+=E[i++]<<g,g+=8),v+=p&(1<<y)-1,p>>>=y,g-=y),15>g&&(p+=E[i++]<<g,g+=8,p+=E[i++]<<g,g+=8),_=m[p&b];dodist:for(;;){if(y=_>>>24,p>>>=y,g-=y,y=255&_>>>16,16&y){if(T=65535&_,y&=15,g<y&&(p+=E[i++]<<g,g+=8,g<y&&(p+=E[i++]<<g,g+=8)),T+=p&(1<<y)-1,T>s){e.msg="invalid distance too far back",o.mode=ly;break top}if(p>>>=y,g-=y,y=a-r,T>y){if(y=T-y,y>f&&o.sane){e.msg="invalid distance too far back",o.mode=ly;break top}if(A=0,C=c,0===u){if(A+=d-y,y<v){v-=y;do B[a++]=c[A++];while(--y);A=a-T,C=B}}else if(u<y){if(A+=d+u-y,y-=u,y<v){v-=y;do B[a++]=c[A++];while(--y);if(A=0,u<v){y=u,v-=y;do B[a++]=c[A++];while(--y);A=a-T,C=B}}}else if(A+=u-y,y<v){v-=y;do B[a++]=c[A++];while(--y);A=a-T,C=B}for(;2<v;)B[a++]=C[A++],B[a++]=C[A++],B[a++]=C[A++],v-=3;v&&(B[a++]=C[A++],1<v&&(B[a++]=C[A++]))}else{A=a-T;do B[a++]=B[A++],B[a++]=B[A++],B[a++]=B[A++],v-=3;while(2<v);v&&(B[a++]=B[A++],1<v&&(B[a++]=B[A++]))}}else if(0==(64&y)){_=m[(65535&_)+(p&(1<<y)-1)];continue dodist}else{e.msg="invalid distance code",o.mode=ly;break top}break}}else if(0==(64&y)){_=h[(65535&_)+(p&(1<<y)-1)];continue dolen}else if(32&y){o.mode=12;break top}else{e.msg="invalid literal/length code",o.mode=ly;break top}break}}while(i<n&&a<l);return v=g>>3,i-=v,g-=v<<3,p&=(1<<g)-1,e.next_in=i,e.next_out=a,e.avail_in=i<n?5+(n-i):5-(i-n),e.avail_out=a<l?257+(l-a):257-(a-l),o.hold=p,void(o.bits=g)},dy=15,fy=852,uy=592,cy=0,py=1,gy=2,hy=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],my=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],xy=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],by=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],_y=function(e,t,o,i,n,a,r,l){var s=l.bits,d=0,f=0,u=0,c=0,p=0,g=0,h=0,m=0,x=0,b=0,_=null,y=0,v=new __.Buf16(dy+1),T=new __.Buf16(dy+1),A=null,C=0,E,B,w,S,D,I,F,R,k;for(d=0;d<=dy;d++)v[d]=0;for(f=0;f<i;f++)v[t[o+f]]++;for(p=s,c=dy;1<=c&&0===v[c];c--);if(p>c&&(p=c),0===c)return n[a++]=20971520,n[a++]=20971520,l.bits=1,0;for(u=1;u<c&&0===v[u];u++);for(p<u&&(p=u),m=1,d=1;d<=dy;d++)if(m<<=1,m-=v[d],0>m)return-1;if(0<m&&(e===cy||1!==c))return-1;for(T[1]=0,d=1;d<dy;d++)T[d+1]=T[d]+v[d];for(f=0;f<i;f++)0!==t[o+f]&&(r[T[t[o+f]]++]=f);if(e===cy?(_=A=r,I=19):e===py?(_=hy,y-=257,A=my,C-=257,I=256):(_=xy,A=by,I=-1),b=0,f=0,d=u,D=a,g=p,h=0,w=-1,x=1<<p,S=x-1,e===py&&x>fy||e===gy&&x>uy)return 1;for(;;){F=d-h,r[f]<I?(R=0,k=r[f]):r[f]>I?(R=A[C+r[f]],k=_[y+r[f]]):(R=96,k=0),E=1<<d-h,B=1<<g,u=B;do B-=E,n[D+(b>>h)+B]=0|(F<<24|R<<16|k);while(0!==B);for(E=1<<d-1;b&E;)E>>=1;if(0===E?b=0:(b&=E-1,b+=E),f++,0==--v[d]){if(d===c)break;d=t[o+r[f]]}if(d>p&&(b&S)!==w){for(0===h&&(h=p),D+=u,g=d-h,m=1<<g;g+h<c&&(m-=v[g+h],!(0>=m));)g++,m<<=1;if(x+=1<<g,e===py&&x>fy||e===gy&&x>uy)return 1;w=b&S,n[w]=0|(p<<24|g<<16|D-a)}}return 0!==b&&(n[D+b]=0|(4194304|d-h<<24)),l.bits=p,0},yy=!0,vy={inflateReset:Ua,inflateReset2:Wa,inflateResetKeep:ja,inflateInit:function(e){return Xa(e,15)},inflateInit2:Xa,inflate:function(e,t){var o=0,i=new __.Buf8(4),a=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],r,l,s,d,f,u,c,p,g,h,m,x,b,_,y,v,T,A,C,E,B,w,S,D;if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;r=e.state,12===r.mode&&(r.mode=13),f=e.next_out,s=e.output,c=e.avail_out,d=e.next_in,l=e.input,u=e.avail_in,p=r.hold,g=r.bits,h=u,m=c,w=0;inf_leave:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;16>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(2&r.wrap&&35615===p){r.check=0,i[0]=255&p,i[1]=255&p>>>8,r.check=j_(r.check,i,2,0),p=0,g=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&p)<<8)+(p>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!==(15&p)){e.msg="unknown compression method",r.mode=30;break}if(p>>>=4,g-=4,B=(15&p)+8,0===r.wbits)r.wbits=B;else if(B>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<B,e.adler=r.check=1,r.mode=512&p?10:12,p=0,g=0;break;case 2:for(;16>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(r.flags=p,8!==(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=1&p>>8),512&r.flags&&(i[0]=255&p,i[1]=255&p>>>8,r.check=j_(r.check,i,2,0)),p=0,g=0,r.mode=3;case 3:for(;32>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}r.head&&(r.head.time=p),512&r.flags&&(i[0]=255&p,i[1]=255&p>>>8,i[2]=255&p>>>16,i[3]=255&p>>>24,r.check=j_(r.check,i,4,0)),p=0,g=0,r.mode=4;case 4:for(;16>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}r.head&&(r.head.xflags=255&p,r.head.os=p>>8),512&r.flags&&(i[0]=255&p,i[1]=255&p>>>8,r.check=j_(r.check,i,2,0)),p=0,g=0,r.mode=5;case 5:if(1024&r.flags){for(;16>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}r.length=p,r.head&&(r.head.extra_len=p),512&r.flags&&(i[0]=255&p,i[1]=255&p>>>8,r.check=j_(r.check,i,2,0)),p=0,g=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(x=r.length,x>u&&(x=u),x&&(r.head&&(B=r.head.extra_len-r.length,!r.head.extra&&(r.head.extra=Array(r.head.extra_len)),__.arraySet(r.head.extra,l,d,x,B)),512&r.flags&&(r.check=j_(r.check,l,x,d)),u-=x,d+=x,r.length-=x),r.length))break inf_leave;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===u)break inf_leave;x=0;do B=l[d+x++],r.head&&B&&65536>r.length&&(r.head.name+=Ku(B));while(B&&x<u);if(512&r.flags&&(r.check=j_(r.check,l,x,d)),u-=x,d+=x,B)break inf_leave}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===u)break inf_leave;x=0;do B=l[d+x++],r.head&&B&&65536>r.length&&(r.head.comment+=Ku(B));while(B&&x<u);if(512&r.flags&&(r.check=j_(r.check,l,x,d)),u-=x,d+=x,B)break inf_leave}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;16>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(p!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}p=0,g=0}r.head&&(r.head.hcrc=1&r.flags>>9,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;32>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}e.adler=r.check=Pa(p),p=0,g=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=f,e.avail_out=c,e.next_in=d,e.avail_in=u,r.hold=p,r.bits=g,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break inf_leave;case 13:if(r.last){p>>>=7&g,g-=7&g,r.mode=27;break}for(;3>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}switch(r.last=1&p,p>>>=1,g-=1,3&p){case 0:r.mode=14;break;case 1:if(qa(r),r.mode=20,6===t){p>>>=2,g-=2;break inf_leave}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30;}p>>>=2,g-=2;break;case 14:for(p>>>=7&g,g-=7&g;32>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if((65535&p)!=(65535^p>>>16)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&p,p=0,g=0,r.mode=15,6===t)break inf_leave;case 15:r.mode=16;case 16:if(x=r.length,x){if(x>u&&(x=u),x>c&&(x=c),0===x)break inf_leave;__.arraySet(s,l,d,x,f),u-=x,d+=x,c-=x,f+=x,r.length-=x;break}r.mode=12;break;case 17:for(;14>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(r.nlen=(31&p)+257,p>>>=5,g-=5,r.ndist=(31&p)+1,p>>>=5,g-=5,r.ncode=(15&p)+4,p>>>=4,g-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;3>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}r.lens[a[r.have++]]=7&p,p>>>=3,g-=3}for(;19>r.have;)r.lens[a[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},w=_y(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,w){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;;){if(o=r.lencode[p&(1<<r.lenbits)-1],y=o>>>24,v=255&o>>>16,T=65535&o,y<=g)break;if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(16>T)p>>>=y,g-=y,r.lens[r.have++]=T;else{if(16===T){for(D=y+2;g<D;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(p>>>=y,g-=y,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}B=r.lens[r.have-1],x=3+(3&p),p>>>=2,g-=2}else if(17===T){for(D=y+3;g<D;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}p>>>=y,g-=y,B=0,x=3+(7&p),p>>>=3,g-=3}else{for(D=y+7;g<D;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}p>>>=y,g-=y,B=0,x=11+(127&p),p>>>=7,g-=7}if(r.have+x>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;x--;)r.lens[r.have++]=B}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,S={bits:r.lenbits},w=_y(1,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,w){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},w=_y(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,w){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break inf_leave;case 20:r.mode=21;case 21:if(6<=u&&258<=c){e.next_out=f,e.avail_out=c,e.next_in=d,e.avail_in=u,r.hold=p,r.bits=g,sy(e,m),f=e.next_out,s=e.output,c=e.avail_out,d=e.next_in,l=e.input,u=e.avail_in,p=r.hold,g=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;;){if(o=r.lencode[p&(1<<r.lenbits)-1],y=o>>>24,v=255&o>>>16,T=65535&o,y<=g)break;if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(v&&0==(240&v)){for(A=y,C=v,E=T;;){if(o=r.lencode[E+((p&(1<<A+C)-1)>>A)],y=o>>>24,v=255&o>>>16,T=65535&o,A+y<=g)break;if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}p>>>=A,g-=A,r.back+=A}if(p>>>=y,g-=y,r.back+=y,r.length=T,0===v){r.mode=26;break}if(32&v){r.back=-1,r.mode=12;break}if(64&v){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&v,r.mode=22;case 22:if(r.extra){for(D=r.extra;g<D;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}r.length+=p&(1<<r.extra)-1,p>>>=r.extra,g-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;;){if(o=r.distcode[p&(1<<r.distbits)-1],y=o>>>24,v=255&o>>>16,T=65535&o,y<=g)break;if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(0==(240&v)){for(A=y,C=v,E=T;;){if(o=r.distcode[E+((p&(1<<A+C)-1)>>A)],y=o>>>24,v=255&o>>>16,T=65535&o,A+y<=g)break;if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}p>>>=A,g-=A,r.back+=A}if(p>>>=y,g-=y,r.back+=y,64&v){e.msg="invalid distance code",r.mode=30;break}r.offset=T,r.extra=15&v,r.mode=24;case 24:if(r.extra){for(D=r.extra;g<D;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}r.offset+=p&(1<<r.extra)-1,p>>>=r.extra,g-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===c)break inf_leave;if(x=m-c,r.offset>x){if(x=r.offset-x,x>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}x>r.wnext?(x-=r.wnext,b=r.wsize-x):b=r.wnext-x,x>r.length&&(x=r.length),_=r.window}else _=s,b=f-r.offset,x=r.length;x>c&&(x=c),c-=x,r.length-=x;do s[f++]=_[b++];while(--x);0===r.length&&(r.mode=21);break;case 26:if(0===c)break inf_leave;s[f++]=r.length,c--,r.mode=21;break;case 27:if(r.wrap){for(;32>g;){if(0===u)break inf_leave;u--,p|=l[d++]<<g,g+=8}if(m-=c,e.total_out+=m,r.total+=m,m&&(e.adler=r.check=r.flags?j_(r.check,s,m,f-m):P_(r.check,s,m,f-m)),m=c,(r.flags?p:Pa(p))!==r.check){e.msg="incorrect data check",r.mode=30;break}p=0,g=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;32>g;){if(0===u)break inf_leave;u--,p+=l[d++]<<g,g+=8}if(p!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}p=0,g=0}r.mode=29;case 29:w=1;break inf_leave;case 30:w=-3;break inf_leave;case 31:return-4;case 32:default:return-2;}if(e.next_out=f,e.avail_out=c,e.next_in=d,e.avail_in=u,r.hold=p,r.bits=g,(r.wsize||m!==e.avail_out&&30>r.mode&&(27>r.mode||4!==t))&&Ya(e,e.output,e.next_out,m-e.avail_out));return h-=e.avail_in,m-=e.avail_out,e.total_in+=h,e.total_out+=m,r.total+=m,r.wrap&&m&&(e.adler=r.check=r.flags?j_(r.check,s,m,e.next_out-m):P_(r.check,s,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===h&&0===m||4===t)&&0===w&&(w=-5),w},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var o;return e&&e.state?(o=e.state,0==(2&o.wrap))?-2:(o.head=t,t.done=!1,0):-2},inflateSetDictionary:function(e,t){var o=t.length,i,n,a;return e&&e.state?(i=e.state,0!==i.wrap&&11!==i.mode)?-2:11===i.mode&&(n=1,n=P_(n,t,o,0),n!==i.check)?-3:(a=Ya(e,t,o,o),a)?(i.mode=31,-4):(i.havedict=1,0):-2},inflateInfo:"pako inflate (from Nodeca project)"},Ty={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Ay=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Cy=Object.prototype.toString,Ey,By;Za.prototype.push=function(e,t){var o=this.strm,i=this.options.chunkSize,n=this.options.dictionary,a=!1,r,l,s,d,f,u;if(this.ended)return!1;l=t===~~t?t:!0===t?Ty.Z_FINISH:Ty.Z_NO_FLUSH,o.input="string"==typeof e?ey.binstring2buf(e):"[object ArrayBuffer]"===Cy.call(e)?new Uint8Array(e):e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new __.Buf8(i),o.next_out=0,o.avail_out=i),r=vy.inflate(o,Ty.Z_NO_FLUSH),r===Ty.Z_NEED_DICT&&n&&(u="string"==typeof n?ey.string2buf(n):"[object ArrayBuffer]"===Cy.call(n)?new Uint8Array(n):n,r=vy.inflateSetDictionary(this.strm,u)),r===Ty.Z_BUF_ERROR&&!0===a&&(r=Ty.Z_OK,a=!1),r!==Ty.Z_STREAM_END&&r!==Ty.Z_OK)return this.onEnd(r),this.ended=!0,!1;o.next_out&&(0===o.avail_out||r===Ty.Z_STREAM_END||0===o.avail_in&&(l===Ty.Z_FINISH||l===Ty.Z_SYNC_FLUSH))&&("string"===this.options.to?(s=ey.utf8border(o.output,o.next_out),d=o.next_out-s,f=ey.buf2string(o.output,s),o.next_out=d,o.avail_out=i-d,d&&__.arraySet(o.output,o.output,s,d,0),this.onData(f)):this.onData(__.shrinkBuf(o.output,o.next_out))),0===o.avail_in&&0===o.avail_out&&(a=!0)}while((0<o.avail_in||0===o.avail_out)&&r!==Ty.Z_STREAM_END);return r===Ty.Z_STREAM_END&&(l=Ty.Z_FINISH),l===Ty.Z_FINISH?(r=vy.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Ty.Z_OK):l!==Ty.Z_SYNC_FLUSH||(this.onEnd(Ty.Z_OK),o.avail_out=0,!0)},Za.prototype.onData=function(e){this.chunks.push(e)},Za.prototype.onEnd=function(e){e===Ty.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=__.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var wy=__.assign,Sy={};wy(Sy,{Deflate:Oa,deflate:za,deflateRaw:function(e,t){return t=t||{},t.raw=!0,za(e,t)},gzip:function(e,t){return t=t||{},t.gzip=!0,za(e,t)}},{Inflate:Za,inflate:Ka,inflateRaw:function(e,t){return t=t||{},t.raw=!0,Ka(e,t)},ungzip:Ka},Ty);var Ly=Sy,Dy=Gn(function(e){(function(){var t={},o;e.exports=t,o="function"==typeof Pn?Ly:window.pako,function(n,a){n.toRGBA8=function(e){var t=e.width,o=e.height;if(null==e.tabs.acTL)return[n.toRGBA8.decodeImage(e.data,t,o,e).buffer];var a=[];null==e.frames[0].data&&(e.frames[0].data=e.data);for(var r=new Uint8Array(4*(t*o)),l=0,s;l<e.frames.length;l++){var d=e.frames[l],f=d.rect.x,u=d.rect.y,c=d.rect.width,p=d.rect.height,g=n.toRGBA8.decodeImage(d.data,c,p,e);if(0==l?s=g:0==d.blend?n._copyTile(g,c,p,s,t,o,f,u,0):1==d.blend&&n._copyTile(g,c,p,s,t,o,f,u,1),a.push(s.buffer),s=s.slice(0),0==d.dispose);else if(1==d.dispose)n._copyTile(r,c,p,s,t,o,f,u,0);else if(2==d.dispose){for(var h=l-1;2==e.frames[h].dispose;)h--;s=new Uint8Array(a[h]).slice(0)}}return a},n.toRGBA8.decodeImage=function(e,t,o,a){var r=t*o,l=n.decode._getBPP(a),s=Yu(t*l/8),d=new Uint8Array(4*r),f=new Uint32Array(d.buffer),u=a.ctype,c=a.depth,g=n._bin.readUshort;if(6==u){var h=r<<2;if(8==c)for(var m=0;m<h;m++)d[m]=e[m];if(16==c)for(var m=0;m<h;m++)d[m]=e[m<<1]}else if(2==u){var x=a.tabs.tRNS,b=-1,_=-1,v=-1;if(x&&(b=x[0],_=x[1],v=x[2]),8==c)for(var m=0;m<r;m++){var T=m<<2,A=3*m;d[T]=e[A],d[T+1]=e[A+1],d[T+2]=e[A+2],d[T+3]=255,-1!=b&&e[A]==b&&e[A+1]==_&&e[A+2]==v&&(d[T+3]=0)}if(16==c)for(var m=0;m<r;m++){var T=m<<2,A=6*m;d[T]=e[A],d[T+1]=e[A+2],d[T+2]=e[A+4],d[T+3]=255,-1!=b&&g(e,A)==b&&g(e,A+2)==_&&g(e,A+4)==v&&(d[T+3]=0)}}else if(3==u){var C=a.tabs.PLTE,p=a.tabs.tRNS,E=p?p.length:0;if(1==c)for(var B=0;B<o;B++)for(var w=B*s,S=B*t,m=0;m<t;m++){var T=S+m<<2,D=1&e[w+(m>>3)]>>7-((7&m)<<0),I=3*D;d[T]=C[I],d[T+1]=C[I+1],d[T+2]=C[I+2],d[T+3]=D<E?p[D]:255}if(2==c)for(var B=0;B<o;B++)for(var w=B*s,S=B*t,m=0;m<t;m++){var T=S+m<<2,D=3&e[w+(m>>2)]>>6-((3&m)<<1),I=3*D;d[T]=C[I],d[T+1]=C[I+1],d[T+2]=C[I+2],d[T+3]=D<E?p[D]:255}if(4==c)for(var B=0;B<o;B++)for(var w=B*s,S=B*t,m=0;m<t;m++){var T=S+m<<2,D=15&e[w+(m>>1)]>>4-((1&m)<<2),I=3*D;d[T]=C[I],d[T+1]=C[I+1],d[T+2]=C[I+2],d[T+3]=D<E?p[D]:255}if(8==c)for(var m=0;m<r;m++){var T=m<<2,D=e[m],I=3*D;d[T]=C[I],d[T+1]=C[I+1],d[T+2]=C[I+2],d[T+3]=D<E?p[D]:255}}else if(4==u){if(8==c)for(var m=0;m<r;m++){var T=m<<2,F=m<<1,R=e[F];d[T]=R,d[T+1]=R,d[T+2]=R,d[T+3]=e[F+1]}if(16==c)for(var m=0;m<r;m++){var T=m<<2,F=m<<2,R=e[F];d[T]=R,d[T+1]=R,d[T+2]=R,d[T+3]=e[F+2]}}else if(0==u){var b=a.tabs.tRNS?a.tabs.tRNS:-1;if(1==c)for(var m=0;m<r;m++){var R=255*(1&e[m>>3]>>7-(7&m)),k=R==255*b?0:255;f[m]=k<<24|R<<16|R<<8|R}if(2==c)for(var m=0;m<r;m++){var R=85*(3&e[m>>2]>>6-((3&m)<<1)),k=R==85*b?0:255;f[m]=k<<24|R<<16|R<<8|R}if(4==c)for(var m=0;m<r;m++){var R=17*(15&e[m>>1]>>4-((1&m)<<2)),k=R==17*b?0:255;f[m]=k<<24|R<<16|R<<8|R}if(8==c)for(var m=0;m<r;m++){var R=e[m],k=R==b?0:255;f[m]=k<<24|R<<16|R<<8|R}if(16==c)for(var m=0;m<r;m++){var R=e[m<<1],k=g(e,m<<1)==b?0:255;f[m]=k<<24|R<<16|R<<8|R}}return d},n.decode=function(e){for(var t=new Uint8Array(e),o=8,a=n._bin,r=a.readUshort,l=a.readUint,s={tabs:{},frames:[]},d=new Uint8Array(t.length),f=0,u=0,c=[137,80,78,71,13,10,26,10],p=0,g;8>p;p++)if(t[p]!=c[p])throw"The input is not a PNG file!";for(;o<t.length;){var h=a.readUint(t,o);o+=4;var m=a.readASCII(t,o,4);if(o+=4,"IHDR"==m)n.decode._IHDR(t,o,s);else if("IDAT"==m){for(var p=0;p<h;p++)d[f+p]=t[o+p];f+=h}else if("acTL"==m)s.tabs[m]={num_frames:l(t,o),num_plays:l(t,o+4)},g=new Uint8Array(t.length);else if("fcTL"==m){if(0!=u){var x=s.frames[s.frames.length-1];x.data=n.decode._decompress(s,g.slice(0,u),x.rect.width,x.rect.height),u=0}var b={x:l(t,o+12),y:l(t,o+16),width:l(t,o+4),height:l(t,o+8)},_=r(t,o+22);_=r(t,o+20)/(0==_?100:_);var y={rect:b,delay:Pu(1e3*_),dispose:t[o+24],blend:t[o+25]};s.frames.push(y)}else if("fdAT"==m){for(var p=0;p<h-4;p++)g[u+p]=t[o+p+4];u+=h-4}else if("pHYs"==m)s.tabs[m]=[a.readUint(t,o),a.readUint(t,o+4),t[o+8]];else if("cHRM"==m){s.tabs[m]=[];for(var p=0;8>p;p++)s.tabs[m].push(a.readUint(t,o+4*p))}else if("tEXt"==m){null==s.tabs[m]&&(s.tabs[m]={});var v=a.nextZero(t,o),T=a.readASCII(t,o,v-o),A=a.readASCII(t,v+1,o+h-v-1);s.tabs[m][T]=A}else if("iTXt"==m){null==s.tabs[m]&&(s.tabs[m]={});var v=0,C=o;v=a.nextZero(t,C);var T=a.readASCII(t,C,v-C);C=v+1,C+=2,v=a.nextZero(t,C);a.readASCII(t,C,v-C);C=v+1,v=a.nextZero(t,C);a.readUTF8(t,C,v-C);C=v+1;var A=a.readUTF8(t,C,h-(C-o));s.tabs[m][T]=A}else if("PLTE"==m)s.tabs[m]=a.readBytes(t,o,h);else if("hIST"==m){var E=s.tabs.PLTE.length/3;s.tabs[m]=[];for(var p=0;p<E;p++)s.tabs[m].push(r(t,o+2*p))}else if("tRNS"==m)3==s.ctype?s.tabs[m]=a.readBytes(t,o,h):0==s.ctype?s.tabs[m]=r(t,o):2==s.ctype&&(s.tabs[m]=[r(t,o),r(t,o+2),r(t,o+4)]);else if("gAMA"==m)s.tabs[m]=a.readUint(t,o)/1e5;else if("sRGB"==m)s.tabs[m]=t[o];else if("bKGD"==m)0==s.ctype||4==s.ctype?s.tabs[m]=[r(t,o)]:2==s.ctype||6==s.ctype?s.tabs[m]=[r(t,o),r(t,o+2),r(t,o+4)]:3==s.ctype&&(s.tabs[m]=t[o]);else if("IEND"==m){if(0!=u){var x=s.frames[s.frames.length-1];x.data=n.decode._decompress(s,g.slice(0,u),x.rect.width,x.rect.height),u=0}s.data=n.decode._decompress(s,d,s.width,s.height);break}o+=h;a.readUint(t,o);o+=4}return delete s.compress,delete s.interlace,delete s.filter,s},n.decode._decompress=function(e,t,o,i){return 0==e.compress&&(t=n.decode._inflate(t)),0==e.interlace?t=n.decode._filterZero(t,e,0,o,i):1==e.interlace&&(t=n.decode._readInterlace(t,e)),t},n.decode._inflate=function(e){return a.inflate(e)},n.decode._readInterlace=function(e,t){for(var o=t.width,i=t.height,a=n.decode._getBPP(t),r=a>>3,l=Yu(o*a/8),s=new Uint8Array(i*l),d=0,f=[0,0,4,0,2,0,1],u=[0,4,0,2,0,1,0],c=[8,8,8,4,4,2,2],p=[8,8,4,4,2,2,1],g=0;7>g;){for(var h=c[g],m=p[g],x=0,b=0,_=f[g];_<i;)_+=h,b++;for(var v=u[g];v<o;)v+=m,x++;var T=Yu(x*a/8);n.decode._filterZero(e,t,d,x,b);for(var A=0,C=f[g];C<i;){for(var E=u[g],B=d+A*T<<3;E<o;){if(1==a){var w=e[B>>3];w=1&w>>7-(7&B),s[C*l+(E>>3)]|=w<<7-((3&E)<<0)}if(2==a){var w=e[B>>3];w=3&w>>6-(7&B),s[C*l+(E>>2)]|=w<<6-((3&E)<<1)}if(4==a){var w=e[B>>3];w=15&w>>4-(7&B),s[C*l+(E>>1)]|=w<<4-((1&E)<<2)}if(8<=a)for(var S=C*l+E*r,D=0;D<r;D++)s[S+D]=e[(B>>3)+D];B+=a,E+=m}A++,C+=h}0!=x*b&&(d+=b*(1+T)),++g}return s},n.decode._getBPP=function(e){var t=[1,null,3,1,2,null,4][e.ctype];return t*e.depth},n.decode._filterZero=function(e,t,o,a,r){var l=n.decode._getBPP(t),s=Yu(a*l/8),d=n.decode._paeth;l=Yu(l/8);for(var f=0;f<r;f++){var u=o+f*s,i=u+f+1,c=e[i-1];if(0==c)for(var p=0;p<s;p++)e[u+p]=e[i+p];else if(1==c){for(var p=0;p<l;p++)e[u+p]=e[i+p];for(var p=l;p<s;p++)e[u+p]=255&e[i+p]+e[u+p-l]}else if(0==f){for(var p=0;p<l;p++)e[u+p]=e[i+p];if(2==c)for(var p=l;p<s;p++)e[u+p]=255&e[i+p];if(3==c)for(var p=l;p<s;p++)e[u+p]=255&e[i+p]+(e[u+p-l]>>1);if(4==c)for(var p=l;p<s;p++)e[u+p]=255&e[i+p]+d(e[u+p-l],0,0)}else{if(2==c)for(var p=0;p<s;p++)e[u+p]=255&e[i+p]+e[u+p-s];if(3==c){for(var p=0;p<l;p++)e[u+p]=255&e[i+p]+(e[u+p-s]>>1);for(var p=l;p<s;p++)e[u+p]=255&e[i+p]+(e[u+p-s]+e[u+p-l]>>1)}if(4==c){for(var p=0;p<l;p++)e[u+p]=255&e[i+p]+d(0,e[u+p-s],0);for(var p=l;p<s;p++)e[u+p]=255&e[i+p]+d(e[u+p-l],e[u+p-s],e[u+p-l-s])}}}return e},n.decode._paeth=function(e,t,o){var i=e+t-o,n=Gu(i-e),a=Gu(i-t),r=Gu(i-o);if(n<=a&&n<=r)return e;return a<=r?t:o},n.decode._IHDR=function(e,t,o){var i=n._bin;o.width=i.readUint(e,t),t+=4,o.height=i.readUint(e,t),t+=4,o.depth=e[t],t++,o.ctype=e[t],t++,o.compress=e[t],t++,o.filter=e[t],t++,o.interlace=e[t],t++},n._bin={nextZero:function(e,t){for(;0!=e[t];)t++;return t},readUshort:function(e,t){return e[t]<<8|e[t+1]},writeUshort:function(e,t,o){e[t]=255&o>>8,e[t+1]=255&o},readUint:function(e,t){return e[t]*16777216+(e[t+1]<<16|e[t+2]<<8|e[t+3])},writeUint:function(e,t,o){e[t]=255&o>>24,e[t+1]=255&o>>16,e[t+2]=255&o>>8,e[t+3]=255&o},readASCII:function(e,t,o){for(var n="",a=0;a<o;a++)n+=Ku(e[t+a]);return n},writeASCII:function(e,t,o){for(var n=0;n<o.length;n++)e[t+n]=o.charCodeAt(n)},readBytes:function(e,t,o){for(var n=[],a=0;a<o;a++)n.push(e[t+a]);return n},pad:function(e){return 2>e.length?"0"+e:e},readUTF8:function(t,o,a){for(var e="",r=0,l;r<a;r++)e+="%"+n._bin.pad(t[o+r].toString(16));try{l=decodeURIComponent(e)}catch(i){return n._bin.readASCII(t,o,a)}return l}},n._copyTile=function(e,t,o,i,n,a,r,l,s){for(var d=Zu(t,n),f=Zu(o,a),u=0,c=0,p=0;p<f;p++)for(var g=0;g<d;g++)if(0<=r&&0<=l?(u=p*t+g<<2,c=(l+p)*n+r+g<<2):(u=(-l+p)*t-r+g<<2,c=p*n+g<<2),0==s)i[c]=e[u],i[c+1]=e[u+1],i[c+2]=e[u+2],i[c+3]=e[u+3];else if(1==s){var h=e[u+3]*(1/255),m=e[u]*h,b=e[u+1]*h,_=e[u+2]*h,v=i[c+3]*(1/255),T=i[c]*v,A=i[c+1]*v,C=i[c+2]*v,E=1-h,B=h+v*E,w=0==B?0:1/B;i[c+3]=255*B,i[c+0]=(m+T*E)*w,i[c+1]=(b+A*E)*w,i[c+2]=(_+C*E)*w}else if(2==s){var h=e[u+3],m=e[u],b=e[u+1],_=e[u+2],v=i[c+3],T=i[c],A=i[c+1],C=i[c+2];h==v&&m==T&&b==A&&_==C?(i[c]=0,i[c+1]=0,i[c+2]=0,i[c+3]=0):(i[c]=m,i[c+1]=b,i[c+2]=_,i[c+3]=h)}else if(3==s){var h=e[u+3],m=e[u],b=e[u+1],_=e[u+2],v=i[c+3],T=i[c],A=i[c+1],C=i[c+2];if(h==v&&m==T&&b==A&&_==C)continue;if(220>h&&20<v)return!1}return!0},n.encode=function(e,t,o,a,r,l){null==a&&(a=0),null==l&&(l=!1);for(var s=new Uint8Array(e[0].byteLength*e.length+100),d=[137,80,78,71,13,10,26,10],f=0;8>f;f++)s[f]=d[f];var u=8,p=n._bin,g=n.crc.crc,h=p.writeUint,m=p.writeUshort,x=p.writeASCII,b=n.encode.compressPNG(e,t,o,a,l);h(s,u,13),u+=4,x(s,u,"IHDR"),u+=4,h(s,u,t),u+=4,h(s,u,o),u+=4,s[u]=b.depth,u++,s[u]=b.ctype,u++,s[u]=0,u++,s[u]=0,u++,s[u]=0,u++,h(s,u,g(s,u-17,17)),u+=4,h(s,u,1),u+=4,x(s,u,"sRGB"),u+=4,s[u]=1,u++,h(s,u,g(s,u-5,5)),u+=4;var _=1<e.length;if(_&&(h(s,u,8),u+=4,x(s,u,"acTL"),u+=4,h(s,u,e.length),u+=4,h(s,u,0),u+=4,h(s,u,g(s,u-12,12)),u+=4),3==b.ctype){var y=b.plte.length;h(s,u,3*y),u+=4,x(s,u,"PLTE"),u+=4;for(var f=0;f<y;f++){var v=3*f,T=b.plte[f];s[u+v+0]=255&T,s[u+v+1]=255&T>>8,s[u+v+2]=255&T>>16}if(u+=3*y,h(s,u,g(s,u-3*y-4,3*y+4)),u+=4,b.gotAlpha){h(s,u,y),u+=4,x(s,u,"tRNS"),u+=4;for(var f=0;f<y;f++)s[u+f]=255&b.plte[f]>>24;u+=y,h(s,u,g(s,u-y-4,y+4)),u+=4}}for(var c=0,A=0,C;A<b.frames.length;A++){C=b.frames[A],_&&(h(s,u,26),u+=4,x(s,u,"fcTL"),u+=4,h(s,u,c++),u+=4,h(s,u,C.rect.width),u+=4,h(s,u,C.rect.height),u+=4,h(s,u,C.rect.x),u+=4,h(s,u,C.rect.y),u+=4,m(s,u,r[A]),u+=2,m(s,u,1e3),u+=2,s[u]=C.dispose,u++,s[u]=C.blend,u++,h(s,u,g(s,u-30,30)),u+=4);var E=C.cimg,y=E.length;h(s,u,y+(0==A?0:4)),u+=4;var B=u;x(s,u,0==A?"IDAT":"fdAT"),u+=4,0!=A&&(h(s,u,c++),u+=4);for(var f=0;f<y;f++)s[u+f]=E[f];u+=y,h(s,u,g(s,B,u-B)),u+=4}return h(s,u,0),u+=4,x(s,u,"IEND"),u+=4,h(s,u,g(s,u-4,4)),u+=4,s.buffer.slice(0,u)},n.encode.compressPNG=function(e,t,o,a,r){for(var l=n.encode.compress(e,t,o,a,!1,r),s=0;s<e.length;s++){var d=l.frames[s],f=d.rect.width,u=d.rect.height,c=d.bpl,p=d.bpp,g=new Uint8Array(u*c+u);d.cimg=n.encode._filterZero(d.img,u,p,c,g)}return l},n.encode.compress=function(e,t,o,a,r,l){null==l&&(l=!1);for(var s=6,d=8,f=4,u=255,p=0;p<e.length;p++)for(var g=new Uint8Array(e[p]),h=g.length,m=0;m<h;m+=4)u&=g[m+3];var b=255!=u,_={},v=[];if(0!=e.length&&(_[0]=0,v.push(0),0!=a&&a--),0!=a){var T=n.quantize(e,a,r);e=T.bufs;for(var m=0,A;m<T.plte.length;m++)A=T.plte[m].est.rgba,null==_[A]&&(_[A]=v.length,v.push(A))}else for(var p=0;p<e.length;p++)for(var C=new Uint32Array(e[p]),h=C.length,m=0,A;m<h&&(A=C[m],!((m<t||A!=C[m-1]&&A!=C[m-t])&&null==_[A]&&(_[A]=v.length,v.push(A),300<=v.length)));m++);var E=!!b&&r,B=v.length;256>=B&&!1==l&&(d=2>=B?1:4>=B?2:16>=B?4:8,r&&(d=8),b=!0);for(var w=[],p=0;p<e.length;p++){var S=new Uint8Array(e[p]),D=new Uint32Array(S.buffer),I=0,F=0,R=t,k=o,N=0;if(0!=p&&!E){for(var M=r||1==p||2==w[w.length-2].dispose?1:2,H=0,V=1e9,O=0;O<M;O++){for(var z=new Uint8Array(e[p-1-O]),P=new Uint32Array(e[p-1-O]),G=t,U=o,W=-1,X=-1,q=0;q<o;q++)for(var Y=0,m;Y<t;Y++)m=q*t+Y,D[m]!=P[m]&&(Y<G&&(G=Y),Y>W&&(W=Y),q<U&&(U=q),q>X&&(X=q));var Z=-1==W?1:(W-G+1)*(X-U+1);Z<V&&(V=Z,H=O,-1==W?(I=F=0,R=k=1):(I=G,F=U,R=W-G+1,k=X-U+1))}var z=new Uint8Array(e[p-1-H]);1==H&&(w[w.length-1].dispose=2);var K=new Uint8Array(4*(R*k)),$=new Uint32Array(K.buffer);n._copyTile(z,t,o,K,R,k,-I,-F,0),n._copyTile(S,t,o,K,R,k,-I,-F,3)?(n._copyTile(S,t,o,K,R,k,-I,-F,2),N=1):(n._copyTile(S,t,o,K,R,k,-I,-F,0),N=0),S=K,D=new Uint32Array(S.buffer)}var Q=4*R;if(256>=B&&!1==l){Q=Yu(d*R/8);for(var K=new Uint8Array(Q*k),q=0;q<k;q++){var m=q*Q,J=q*R;if(8==d)for(var Y=0;Y<R;Y++)K[m+Y]=_[D[J+Y]];else if(4==d)for(var Y=0;Y<R;Y++)K[m+(Y>>1)]|=_[D[J+Y]]<<4-4*(1&Y);else if(2==d)for(var Y=0;Y<R;Y++)K[m+(Y>>2)]|=_[D[J+Y]]<<6-2*(3&Y);else if(1==d)for(var Y=0;Y<R;Y++)K[m+(Y>>3)]|=_[D[J+Y]]<<7-1*(7&Y)}S=K,s=3,f=1}else if(!1==b&&1==e.length){for(var K=new Uint8Array(3*(R*k)),ee=R*k,m=0;m<ee;m++){var te=3*m,oe=4*m;K[te]=S[oe],K[te+1]=S[oe+1],K[te+2]=S[oe+2]}S=K,s=2,f=3,Q=3*R}w.push({rect:{x:I,y:F,width:R,height:k},img:S,bpl:Q,bpp:f,blend:N,dispose:E?1:0})}return{ctype:s,depth:d,plte:v,gotAlpha:b,frames:w}},n.encode._filterZero=function(e,o,r,l,s){for(var d=[],f=0;5>f;f++)if(!(5e5<o*l&&(2==f||3==f||4==f))){for(var u=0;u<o;u++)n.encode._filterLine(s,e,u,l,r,f);if(d.push(a.deflate(s)),1==r)break}for(var c=1e9,p=0,g;p<d.length;p++)d[p].length<c&&(g=p,c=d[p].length);return d[g]},n.encode._filterLine=function(e,t,o,a,r,l){var s=o*a,i=s+o,d=n.decode._paeth;if(e[i]=l,i++,0==l)for(var f=0;f<a;f++)e[i+f]=t[s+f];else if(1==l){for(var f=0;f<r;f++)e[i+f]=t[s+f];for(var f=r;f<a;f++)e[i+f]=255&t[s+f]-t[s+f-r]+256}else if(0==o){for(var f=0;f<r;f++)e[i+f]=t[s+f];if(2==l)for(var f=r;f<a;f++)e[i+f]=t[s+f];if(3==l)for(var f=r;f<a;f++)e[i+f]=255&t[s+f]-(t[s+f-r]>>1)+256;if(4==l)for(var f=r;f<a;f++)e[i+f]=255&t[s+f]-d(t[s+f-r],0,0)+256}else{if(2==l)for(var f=0;f<a;f++)e[i+f]=255&t[s+f]+256-t[s+f-a];if(3==l){for(var f=0;f<r;f++)e[i+f]=255&t[s+f]+256-(t[s+f-a]>>1);for(var f=r;f<a;f++)e[i+f]=255&t[s+f]+256-(t[s+f-a]+t[s+f-r]>>1)}if(4==l){for(var f=0;f<r;f++)e[i+f]=255&t[s+f]+256-d(0,t[s+f-a],0);for(var f=r;f<a;f++)e[i+f]=255&t[s+f]+256-d(t[s+f-r],t[s+f-a],t[s+f-r-a])}}},n.crc={table:function(){for(var e=new Uint32Array(256),t=0,o;256>t;t++){o=t;for(var i=0;8>i;i++)1&o?o=3988292384^o>>>1:o>>>=1;e[t]=o}return e}(),update:function(e,t,o,a){for(var r=0;r<a;r++)e=n.crc.table[255&(e^t[o+r])]^e>>>8;return e},crc:function(e,t,o){return 4294967295^n.crc.update(4294967295,e,t,o)}},n.quantize=function(e,t,o){for(var l=[],s=0,d=0;d<e.length;d++)l.push(n.encode.alphaMul(new Uint8Array(e[d]),o)),s+=e[d].byteLength;for(var f=new Uint8Array(s),u=new Uint32Array(f.buffer),c=0,d=0;d<l.length;d++){for(var p=l[d],h=p.length,m=0;m<h;m++)f[c+m]=p[m];c+=h}var x={i0:0,i1:f.length,bst:null,est:null,tdst:0,left:null,right:null};x.bst=n.quantize.stats(f,x.i0,x.i1),x.est=n.quantize.estats(x.bst);for(var _=[x];_.length<t;){for(var y=0,v=0,d=0;d<_.length;d++)_[d].est.L>y&&(y=_[d].est.L,v=d);if(1e-3>y)break;var T=_[v],A=n.quantize.splitPixels(f,u,T.i0,T.i1,T.est.e,T.est.eMq255),C={i0:T.i0,i1:A,bst:null,est:null,tdst:0,left:null,right:null};C.bst=n.quantize.stats(f,C.i0,C.i1),C.est=n.quantize.estats(C.bst);for(var E={i0:A,i1:T.i1,bst:null,est:null,tdst:0,left:null,right:null,bst:{R:[],m:[],N:T.bst.N-C.bst.N}},d=0;16>d;d++)E.bst.R[d]=T.bst.R[d]-C.bst.R[d];for(var d=0;4>d;d++)E.bst.m[d]=T.bst.m[d]-C.bst.m[d];E.est=n.quantize.estats(E.bst),T.left=C,T.right=E,_[v]=C,_.push(E)}_.sort(function(e,t){return t.bst.N-e.bst.N});for(var B=0;B<l.length;B++){for(var w=n.quantize.planeDst,S=new Uint8Array(l[B].buffer),D=new Uint32Array(l[B].buffer),I=S.length,d=0;d<I;d+=4){for(var F=S[d]*(1/255),r=S[d+1]*(1/255),g=S[d+2]*(1/255),b=S[d+3]*(1/255),a=x;a.left;)a=0>=w(a.est,F,r,g,b)?a.left:a.right;D[d>>2]=a.est.rgba}l[B]=D.buffer}return{bufs:l,plte:_}},n.quantize.getNearest=function(e,t,o,i,r){if(null==e.left)return e.tdst=n.quantize.dist(e.est.q,t,o,i,r),e;var a=n.quantize.planeDst(e.est,t,o,i,r),l=e.left,s=e.right;0<a&&(l=e.right,s=e.left);var d=n.quantize.getNearest(l,t,o,i,r);if(d.tdst<=a*a)return d;var f=n.quantize.getNearest(s,t,o,i,r);return f.tdst<d.tdst?f:d},n.quantize.planeDst=function(t,o,i,n,r){var a=t.e;return a[0]*o+a[1]*i+a[2]*n+a[3]*r-t.eMq},n.quantize.dist=function(e,t,o,i,n){var a=t-e[0],r=o-e[1],l=i-e[2],s=n-e[3];return a*a+r*r+l*l+s*s},n.quantize.splitPixels=function(o,i,a,r,l,e){var s=n.quantize.vecDot;for(r-=4;a<r;){for(;s(o,a,l)<=e;)a+=4;for(;s(o,r,l)>e;)r-=4;if(a>=r)break;var d=i[a>>2];i[a>>2]=i[r>>2],i[r>>2]=d,a+=4,r-=4}for(;s(o,a,l)>e;)a-=4;return a+4},n.quantize.vecDot=function(t,o,i){return t[o]*i[0]+t[o+1]*i[1]+t[o+2]*i[2]+t[o+3]*i[3]},n.quantize.stats=function(e,t,o){for(var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=[0,0,0,0],s=o-t>>2,d=t;d<o;d+=4){var f=e[d]*(1/255),r=e[d+1]*(1/255),u=e[d+2]*(1/255),c=e[d+3]*(1/255);l[0]+=f,l[1]+=r,l[2]+=u,l[3]+=c,n[0]+=f*f,n[1]+=f*r,n[2]+=f*u,n[3]+=f*c,n[5]+=r*r,n[6]+=r*u,n[7]+=r*c,n[10]+=u*u,n[11]+=u*c,n[15]+=c*c}return n[4]=n[1],n[8]=n[2],n[12]=n[3],n[9]=n[6],n[13]=n[7],n[14]=n[11],{R:n,m:l,N:s}},n.quantize.estats=function(e){var t=e.R,o=e.m,a=e.N,r=o[0],l=o[1],s=o[2],d=o[3],f=0==a?0:1/a,u=[t[0]-r*r*f,t[1]-r*l*f,t[2]-r*s*f,t[3]-r*d*f,t[4]-l*r*f,t[5]-l*l*f,t[6]-l*s*f,t[7]-l*d*f,t[8]-s*r*f,t[9]-s*l*f,t[10]-s*s*f,t[11]-s*d*f,t[12]-d*r*f,t[13]-d*l*f,t[14]-d*s*f,t[15]-d*d*f],c=n.M4,p=[.5,.5,.5,.5],g=0,h=0;if(0!=a)for(var m=0;10>m&&(p=c.multVec(u,p),h=Ou(c.dot(p,p)),p=c.sml(1/h,p),!(1e-9>Gu(h-g)));m++)g=h;var x=[r*f,l*f,s*f,d*f],_=c.dot(c.sml(255,x),p),y=.001>x[3]?0:1/x[3];return{Cov:u,q:x,e:p,L:g,eMq255:_,eMq:c.dot(p,x),rgba:(Pu(255*x[3])<<24|Pu(255*x[2]*y)<<16|Pu(255*x[1]*y)<<8|Pu(255*x[0]*y)<<0)>>>0}},n.M4={multVec:function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],e[4]*t[0]+e[5]*t[1]+e[6]*t[2]+e[7]*t[3],e[8]*t[0]+e[9]*t[1]+e[10]*t[2]+e[11]*t[3],e[12]*t[0]+e[13]*t[1]+e[14]*t[2]+e[15]*t[3]]},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},sml:function(e,t){return[e*t[0],e*t[1],e*t[2],e*t[3]]}},n.encode.alphaMul=function(e,t){for(var o=new Uint8Array(e.length),n=e.length>>2,r=0;r<n;r++){var l=r<<2,s=e[l+3];t&&(s=128>s?0:255);var d=s*(1/255);o[l+0]=e[l+0]*d,o[l+1]=e[l+1]*d,o[l+2]=e[l+2]*d,o[l+3]=s}return o}}(t,o)})()}),Iy=Dy.decode,Fy=/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/,Ry=Xe(function(e,t){void 0===t&&(t=256);var o=new Float32Array(t*t);return o.fill(e),new Uint8Array(o.buffer)}),ky=Ja(),Ny=function(e,t,o,n,a){void 0===a&&(a=n);for(var r={},l=function(o){for(var i=function(e){r[n+"["+o+"]."+e]=function(i,n){var r=n[a];return o<r.length?r[o][e]:t[e]}},l=0,s=e,d;l<s.length;l++)d=s[l],i(d)},s=0;s<o;++s)l(s);return r}.bind(null,["color","offset"],{color:x_,offset:0}),My=.017453292519943295,Hy=.0333334,Vy=function(){function e(e,t,o,i){var n=Xu(o/t),a=n*t,r=e.texture({width:a,height:a,flipY:i,format:"rgba",type:"uint8"}),l=new Map,s=this.allTextureCoordinates(n,t);Object.assign(this,{tileSize:t,tilesAcross:n,pixelsAcross:a,tileCapacity:n*n,texture:r,contents:l,available:s})}return e.prototype.addTile=function(e,t){var o=this,i=o.available,n=o.contents,a=o.texture,r=o.tileSize,l=this.hashTileCoordinates(e);if(n.has(l)){var s=n.get(l);return n.delete(l),n.set(l,s),this.formatOutputTextureCoordinates(s)}if(Bi(i)){var d=n.keys().next().value;this.removeByHashKey(d)}var f=i.pop();n.set(l,f);var u=f.x,c=f.y;return a.subimage({data:t,width:r,height:r},u,c),this.formatOutputTextureCoordinates(f)},e.prototype.removeTile=function(e){this.removeByHashKey(this.hashTileCoordinates(e))},e.prototype.clearTiles=function(){for(var e=0,t=Array.from(this.contents.keys()),o;e<t.length;e++)o=t[e],this.removeByHashKey(o)},e.prototype.destroy=function(){this.texture.destroy()},e.prototype.removeByHashKey=function(e){if(this.contents.has(e)){var t=this.contents.get(e);this.contents.delete(e),this.available.push(t)}},e.prototype.formatOutputTextureCoordinates=function(e){var t=e.x,o=e.y,i=this,n=i.pixelsAcross,a=i.tileSize;return[{x:t/n,y:o/n},{x:(t+a)/n,y:(o+a)/n}]},e.prototype.hashTileCoordinates=function(e){var t=e.x,o=e.y,i=e.z;return t+":"+o+":"+i},e.prototype.allTextureCoordinates=function(e,t){return fi(er(e),function(o){return er(e).map(function(e){return{x:o*t,y:e*t}})})},e}(),Oy=function(){function t(t,o,i,n){var a=e.DomUtil.create("canvas"),r=b_,l=m_({canvas:a,onDone:function(e,t){return e?void console.log(e):void(2048<t.limits.maxTextureSize?r=2048:4096<t.limits.maxTextureSize&&(r=4096),261===t.limits.maxFragmentUniforms&&console.log("Software rendering detected and not supported with GLOperations plugin. If you have a GPU, check if drivers are installed ok?"))}}),s=fr(t,o),d=dr("colorScale",i,"sentinelValues",n),f=dr("colorScaleA",i,"sentinelValuesA",n),u=dr("colorScaleB",i,"sentinelValuesB",n);Object.assign(this,{canvas:a,regl:l,tileSize:t,maxTextureDimension:r,textureManager:new Vy(l,t,r,!1),textureManagerA:new Vy(l,t,r,!1),textureManagerB:new Vy(l,t,r,!1),textureManagerC:new Vy(l,t,r,!1),textureManagerD:new Vy(l,t,r,!1),textureManagerE:new Vy(l,t,r,!1),textureManagerF:new Vy(l,t,r,!1),textureManagerHillshade:new Vy(l,t,r,!1),drawTile:ur(l,s,d),drawTileHsSimple:cr(l,s,d),drawTileHsPregen:pr(l,s,d),drawTileInterpolateColor:Lr(l,s,f,u),drawTileInterpolateColorOnly:Dr(l,s,f,u),drawTileInterpolateValue:gr(l,s,d),calcTileMultiAnalyze1:mr(l,s),drawTileMultiAnalyze1:hr(l,s,d),calcTileMultiAnalyze2:br(l,s),drawTileMultiAnalyze2:xr(l,s,d),calcTileMultiAnalyze3:yr(l,s),drawTileMultiAnalyze3:_r(l,s,d),calcTileMultiAnalyze4:Tr(l,s),drawTileMultiAnalyze4:vr(l,s,d),calcTileMultiAnalyze5:Cr(l,s),drawTileMultiAnalyze5:Ar(l,s,d),calcTileMultiAnalyze6:Br(l,s),drawTileMultiAnalyze6:Er(l,s,d),drawTileDiff:Sr(l,s,d),calcTileDiff:wr(l,s),convolutionSmooth:Ir(l,s)})}return t.prototype.setMaxTextureDimension=function(e){var t=this,o=t.textureManager,i=t.tileSize,n=t.regl;o.destroy(),Object.assign(this,{maxTextureDimension:e,textureManager:new Vy(n,i,e,!1)})},t.prototype.findMaxTextureDimension=function(){var e=this.regl,t=b_;return 2048<e.limits.maxTextureSize?t=2048:4096<e.limits.maxTextureSize&&(t=4096),t},t.prototype.renderTile=function(e,t,o,i,n){var a=e.coords,r=e.pixelData;void 0===n&&(n=0);var l=this,s=l.regl,d=l.textureManager,f=l.tileSize;this.setCanvasSize(f,f);var u=d.addTile(a,r);s.clear({color:x_});var c=i.hsSimpleZoomdelta||0,p=qu(.5,ju(2,n+c)/2048),g=p/d.texture.width;return"none"===i.hillshadeType?this.drawTile({colorScale:$a(t),sentinelValues:$a(o),canvasSize:[f,f],canvasCoordinates:[0,0],textureBounds:u,texture:d.texture,enableSimpleHillshade:!1}):"simple"===i.hillshadeType&&this.drawTileHsSimple({colorScale:$a(t),sentinelValues:$a(o),canvasSize:[f,f],canvasCoordinates:[0,0],textureBounds:u,texture:d.texture,textureSize:d.texture.width,tileSize:f,offset:g,enableSimpleHillshade:!0,azimuth:i.hsSimpleAzimuth,altitude:i.hsSimpleAltitude,slopescale:i.hsSimpleSlopescale}),[0,0]},t.prototype.renderTileHsPregen=function(e,t,o,i){var n=this,a=n.regl,r=n.textureManager,l=n.textureManagerHillshade,s=n.tileSize;this.setCanvasSize(s,s);var d=r.addTile(e.coords,e.pixelData),f=l.addTile(t.coords,t.pixelData);return a.clear({color:x_}),this.drawTileHsPregen({colorScale:$a(o),sentinelValues:$a(i),canvasSize:[s,s],canvasCoordinates:[0,0],textureBounds:d,textureBoundsHs:f,texture:r.texture,hillshadePregenTexture:l.texture}),[0,0]},t.prototype.flipReadPixelsFloat=function(e,t,o){for(var i=4*e,n=new Float32Array(4*e),a=0;a<(0|t/2);++a){var r=a*i,l=(t-a-1)*i;n.set(o.subarray(r,r+i)),o.copyWithin(r,l,l+i),o.set(n,l)}return o},t.prototype.flipReadPixelsUint=function(e,t,o){for(var i=4*e,n=new Uint8Array(4*e),a=0;a<(0|t/2);++a){var r=a*i,l=(t-a-1)*i;n.set(o.subarray(r,r+i)),o.copyWithin(r,l,l+i),o.set(n,l)}return o},t.prototype.renderTileDiff=function(e,t,o,i){var n=this,a=this,r=a.regl,l=a.textureManagerA,s=a.textureManagerB,d=a.tileSize;this.setCanvasSize(d,d);var f=l.addTile(e.coords,e.pixelData),u=s.addTile(t.coords,t.pixelData),c=r.framebuffer({width:d,height:d,depth:!1,colorFormat:"rgba",colorType:"uint8"}),p=new Uint8Array(4*(d*d));return c.use(function(){n.calcTileDiff({canvasSize:[d,d],canvasCoordinates:[0,0],textureA:l.texture,textureB:s.texture,textureBoundsA:f,textureBoundsB:u}),r.read({data:p})}),p=this.flipReadPixelsUint(d,d,p),this.drawTileDiff({colorScale:$a(o),sentinelValues:$a(i),canvasSize:[d,d],canvasCoordinates:[0,0],textureA:l.texture,textureB:s.texture,textureBoundsA:f,textureBoundsB:u}),c.destroy(),[0,0,p]},t.prototype.renderConvolutionSmooth=function(e,t,o,i){var n=this,a=this.regl;this.setCanvasSize(t,o);var r=a.texture({data:e,width:t,height:o,flipY:!1}),l=a.framebuffer({width:t,height:o,depth:!1,colorFormat:"rgba",colorType:"uint8"}),s=new Uint8Array(4*(t*o));return l.use(function(){n.convolutionSmooth({texture:r,textureSize:t,kernelSize:i}),a.read({data:s})}),s=new Float32Array(s.buffer),l.destroy(),s},t.prototype.renderTileMulti1=function(e,t,o,i,n,a){var r=this,l=this,s=l.regl,d=l.textureManagerA,f=l.tileSize;this.setCanvasSize(f,f);var u=d.addTile(e.coords,e.pixelData),c=s.framebuffer({width:f,height:f,depth:!1,colorFormat:"rgba",colorType:"uint8"}),p=new Uint8Array(4*(f*f));return c.use(function(){r.calcTileMultiAnalyze1({canvasSize:[f,f],canvasCoordinates:[0,0],textureA:d.texture,textureBoundsA:u,filterLowA:i,filterHighA:n,multiplierA:a}),s.read({data:p})}),p=this.flipReadPixelsUint(f,f,p),this.drawTileMultiAnalyze1({colorScale:$a(t),sentinelValues:$a(o),canvasSize:[f,f],canvasCoordinates:[0,0],textureA:d.texture,textureBoundsA:u,filterLowA:i,filterHighA:n,multiplierA:a}),c.destroy(),[0,0,p]},t.prototype.renderTileMulti2=function(e,t,o,i,n,a,r,l,s,d){var f=this,u=this,c=u.regl,p=u.textureManagerA,g=u.textureManagerB,h=u.tileSize;this.setCanvasSize(h,h);var m=p.addTile(e.coords,e.pixelData),x=g.addTile(t.coords,t.pixelData),b=c.framebuffer({width:h,height:h,depth:!1,colorFormat:"rgba",colorType:"uint8"}),_=new Uint8Array(4*(h*h));return b.use(function(){f.calcTileMultiAnalyze2({canvasSize:[h,h],canvasCoordinates:[0,0],textureA:p.texture,textureB:g.texture,textureBoundsA:m,textureBoundsB:x,filterLowA:n,filterHighA:a,filterLowB:r,filterHighB:l,multiplierA:s,multiplierB:d}),c.read({data:_})}),_=this.flipReadPixelsUint(h,h,_),this.drawTileMultiAnalyze2({colorScale:$a(o),sentinelValues:$a(i),canvasSize:[h,h],canvasCoordinates:[0,0],textureA:p.texture,textureB:g.texture,textureBoundsA:m,textureBoundsB:x,filterLowA:n,filterHighA:a,filterLowB:r,filterHighB:l,multiplierA:s,multiplierB:d}),b.destroy(),[0,0,_]},t.prototype.renderTileMulti3=function(e,t,o,i,n,a,r,l,s,d,f,u,c,p){var g=this,h=this,m=h.regl,x=h.textureManagerA,b=h.textureManagerB,_=h.textureManagerC,y=h.tileSize;this.setCanvasSize(y,y);var v=x.addTile(e.coords,e.pixelData),T=b.addTile(t.coords,t.pixelData),A=_.addTile(o.coords,o.pixelData),C=m.framebuffer({width:y,height:y,depth:!1,colorFormat:"rgba",colorType:"uint8"}),E=new Uint8Array(4*(y*y));return C.use(function(){g.calcTileMultiAnalyze3({canvasSize:[y,y],canvasCoordinates:[0,0],textureA:x.texture,textureB:b.texture,textureC:_.texture,textureBoundsA:v,textureBoundsB:T,textureBoundsC:A,filterLowA:a,filterHighA:r,filterLowB:l,filterHighB:s,filterLowC:d,filterHighC:f,multiplierA:u,multiplierB:c,multiplierC:p}),m.read({data:E})}),E=this.flipReadPixelsUint(y,y,E),this.drawTileMultiAnalyze3({colorScale:$a(i),sentinelValues:$a(n),canvasSize:[y,y],canvasCoordinates:[0,0],textureA:x.texture,textureB:b.texture,textureC:_.texture,textureBoundsA:v,textureBoundsB:T,textureBoundsC:A,filterLowA:a,filterHighA:r,filterLowB:l,filterHighB:s,filterLowC:d,filterHighC:f,multiplierA:u,multiplierB:c,multiplierC:p}),C.destroy(),[0,0,E]},t.prototype.renderTileMulti4=function(e,t,o,i,n,a,r,l,s,d,f,u,c,p,g,h,m,x){var b=this,_=this,y=_.regl,v=_.textureManagerA,T=_.textureManagerB,A=_.textureManagerC,C=_.textureManagerD,E=_.tileSize;this.setCanvasSize(E,E);var B=v.addTile(e.coords,e.pixelData),w=T.addTile(t.coords,t.pixelData),S=A.addTile(o.coords,o.pixelData),D=C.addTile(i.coords,i.pixelData),I=y.framebuffer({width:E,height:E,depth:!1,colorFormat:"rgba",colorType:"uint8"}),F=new Uint8Array(4*(E*E));return I.use(function(){b.calcTileMultiAnalyze4({canvasSize:[E,E],canvasCoordinates:[0,0],textureA:v.texture,textureB:T.texture,textureC:A.texture,textureD:C.texture,textureBoundsA:B,textureBoundsB:w,textureBoundsC:S,textureBoundsD:D,filterLowA:r,filterHighA:l,filterLowB:s,filterHighB:d,filterLowC:f,filterHighC:u,filterLowD:c,filterHighD:p,multiplierA:g,multiplierB:h,multiplierC:m,multiplierD:x}),y.read({data:F})}),F=this.flipReadPixelsUint(E,E,F),this.drawTileMultiAnalyze4({colorScale:$a(n),sentinelValues:$a(a),canvasSize:[E,E],canvasCoordinates:[0,0],textureA:v.texture,textureB:T.texture,textureC:A.texture,textureD:C.texture,textureBoundsA:B,textureBoundsB:w,textureBoundsC:S,textureBoundsD:D,filterLowA:r,filterHighA:l,filterLowB:s,filterHighB:d,filterLowC:f,filterHighC:u,filterLowD:c,filterHighD:p,multiplierA:g,multiplierB:h,multiplierC:m,multiplierD:x}),I.destroy(),[0,0,F]},t.prototype.renderTileMulti5=function(e,t,o,i,n,a,r,l,s,d,f,u,c,p,g,h,m,x,b,_,y,v){var T=this,A=this,C=A.regl,E=A.textureManagerA,B=A.textureManagerB,w=A.textureManagerC,S=A.textureManagerD,D=A.textureManagerE,I=A.tileSize;this.setCanvasSize(I,I);var F=E.addTile(e.coords,e.pixelData),R=B.addTile(t.coords,t.pixelData),k=w.addTile(o.coords,o.pixelData),N=S.addTile(i.coords,i.pixelData),M=D.addTile(n.coords,n.pixelData),H=C.framebuffer({width:I,height:I,depth:!1,colorFormat:"rgba",colorType:"uint8"}),V=new Uint8Array(4*(I*I));return H.use(function(){T.calcTileMultiAnalyze5({canvasSize:[I,I],canvasCoordinates:[0,0],textureA:E.texture,textureB:B.texture,textureC:w.texture,textureD:S.texture,textureE:D.texture,textureBoundsA:F,textureBoundsB:R,textureBoundsC:k,textureBoundsD:N,textureBoundsE:M,filterLowA:l,filterHighA:s,filterLowB:d,filterHighB:f,filterLowC:u,filterHighC:c,filterLowD:p,filterHighD:g,filterLowE:h,filterHighE:m,multiplierA:x,multiplierB:b,multiplierC:_,multiplierD:y,multiplierE:v}),C.read({data:V})}),V=this.flipReadPixelsUint(I,I,V),this.drawTileMultiAnalyze5({colorScale:$a(a),sentinelValues:$a(r),canvasSize:[I,I],canvasCoordinates:[0,0],textureA:E.texture,textureB:B.texture,textureC:w.texture,textureD:S.texture,textureE:D.texture,textureBoundsA:F,textureBoundsB:R,textureBoundsC:k,textureBoundsD:N,textureBoundsE:M,filterLowA:l,filterHighA:s,filterLowB:d,filterHighB:f,filterLowC:u,filterHighC:c,filterLowD:p,filterHighD:g,filterLowE:h,filterHighE:m,multiplierA:x,multiplierB:b,multiplierC:_,multiplierD:y,multiplierE:v}),H.destroy(),[0,0,V]},t.prototype.renderTileMulti6=function(e,t,o,i,n,a,r,l,s,d,f,u,c,p,g,h,m,x,b,_,y,v,T,A,C,E){var B=this,w=this,S=w.regl,D=w.textureManagerA,I=w.textureManagerB,F=w.textureManagerC,R=w.textureManagerD,k=w.textureManagerE,N=w.textureManagerF,M=w.tileSize;this.setCanvasSize(M,M);var H=D.addTile(e.coords,e.pixelData),V=I.addTile(t.coords,t.pixelData),O=F.addTile(o.coords,o.pixelData),z=R.addTile(i.coords,i.pixelData),P=k.addTile(n.coords,n.pixelData),G=k.addTile(a.coords,a.pixelData),j=S.framebuffer({width:M,height:M,depth:!1,colorFormat:"rgba",colorType:"uint8"}),U=new Uint8Array(4*(M*M));return j.use(function(){B.calcTileMultiAnalyze6({canvasSize:[M,M],canvasCoordinates:[0,0],textureA:D.texture,textureB:I.texture,textureC:F.texture,textureD:R.texture,textureE:k.texture,textureF:N.texture,textureBoundsA:H,textureBoundsB:V,textureBoundsC:O,textureBoundsD:z,textureBoundsE:P,textureBoundsF:G,filterLowA:s,filterHighA:d,filterLowB:f,filterHighB:u,filterLowC:c,filterHighC:p,filterLowD:g,filterHighD:h,filterLowE:m,filterHighE:x,filterLowF:b,filterHighF:_,multiplierA:y,multiplierB:v,multiplierC:T,multiplierD:A,multiplierE:C,multiplierF:E}),S.read({data:U})}),U=this.flipReadPixelsUint(M,M,U),this.drawTileMultiAnalyze6({colorScale:$a(r),sentinelValues:$a(l),canvasSize:[M,M],canvasCoordinates:[0,0],textureA:D.texture,textureB:I.texture,textureC:F.texture,textureD:R.texture,textureE:k.texture,textureF:N.texture,textureBoundsA:H,textureBoundsB:V,textureBoundsC:O,textureBoundsD:z,textureBoundsE:P,textureBoundsF:G,filterLowA:s,filterHighA:d,filterLowB:f,filterHighB:u,filterLowC:c,filterHighC:p,filterLowD:g,filterHighD:h,filterLowE:m,filterHighE:x,filterLowF:b,filterHighF:_,multiplierA:y,multiplierB:v,multiplierC:T,multiplierD:A,multiplierE:C,multiplierF:E}),j.destroy(),[0,0,U]},t.prototype.renderTiles=function(e,t,o,i,n){void 0===n&&(n=0);var a=this,r=a.regl,l=a.textureManager,s=a.tileSize,d=this.computeRequiredCanvasDimensions(e.length),f=d[0],u=d[1];this.setCanvasSize(f,u);var c=this.getCanvasCoordinates(f,u,e.length),p=Zb(e,c,function(e,t){return Qu({},e,{canvasCoords:t})}),g=$a(t),h=$a(o),m=[f,u];l.clearTiles(),r.clear({color:x_});for(var x=St(p,l.tileCapacity),b=i.hsSimpleZoomdelta||0,_=function(e){var t=e.map(function(e){var t=e.coords,o=e.pixelData;return l.addTile(t,o)}),o=qu(.5,ju(2,n+b)/2048),a=o/l.texture.width;"none"===i.hillshadeType?y.drawTile(e.map(function(e,o){var i=e.canvasCoords;return{colorScale:g,sentinelValues:h,canvasSize:m,canvasCoordinates:i,textureBounds:t[o],texture:l.texture,enableSimpleHillshade:!1}})):"simple"===i.hillshadeType&&y.drawTileHsSimple(e.map(function(e,o){var n=e.canvasCoords;return{colorScale:g,sentinelValues:h,canvasSize:m,canvasCoordinates:n,textureBounds:t[o],textureSize:l.texture.width,texture:l.texture,tileSize:s,offset:a,enableSimpleHillshade:!0,azimuth:i.hsSimpleAzimuth,altitude:i.hsSimpleAltitude,slopescale:i.hsSimpleSlopescale}}))},y=this,v=0,T=x,A;v<T.length;v++)A=T[v],_(A);return c},t.prototype.renderTilesHsPregen=function(e,t,o,i){var n=this,a=n.regl,r=n.textureManager,l=n.textureManagerHillshade,s=this.computeRequiredCanvasDimensions(e.length),d=s[0],f=s[1];this.setCanvasSize(d,f);var u=this.getCanvasCoordinates(d,f,e.length),c=Zb(e,t,u,function(e,t,o){return{coords:e.coords,tilesPixelData:e.pixelData,tilesHsPixelData:t.pixelData,canvasCoords:o}}),p=$a(o),g=$a(i),h=[d,f];r.clearTiles(),l.clearTiles(),a.clear({color:x_});for(var m=St(c,r.tileCapacity),x=function(e){var t=e.map(function(e){var t=e.coords,o=e.tilesPixelData;return r.addTile(t,o)}),o=e.map(function(e){var t=e.coords,o=e.tilesHsPixelData;return l.addTile(t,o)});b.drawTileHsPregen(e.map(function(e,i){var n=e.canvasCoords;return{colorScale:p,sentinelValues:g,canvasSize:h,canvasCoordinates:n,textureBounds:t[i],textureBoundsHs:o[i],texture:r.texture,hillshadePregenTexture:l.texture}}))},b=this,_=0,y=m,v;_<y.length;_++)v=y[_],x(v);return u},t.prototype.renderTilesWithDiff=function(e,t,o,i,n){var a=this,r=this,l=r.regl,s=r.textureManagerA,d=r.textureManagerB,f=r.tileSize,u=this.computeRequiredCanvasDimensions(e.length),c=u[0],p=u[1];this.setCanvasSize(c,p);var g=this.getCanvasCoordinates(c,p,e.length),h=Zb(e,t,g,function(e,t,o){return{coords:e.coords,tilesAPixelData:e.pixelData,tilesBPixelData:t.pixelData,canvasCoords:o}}),m=$a(o),x=$a(i),b=[];return function(){var e=St(h,s.tileCapacity);l.clear({color:x_});for(var t=0,o=function(e){var o=e.map(function(e){var t=e.coords,o=e.tilesAPixelData;return s.addTile(t,o)}),i=e.map(function(e){var t=e.coords,o=e.tilesBPixelData;return d.addTile(t,o)});e.forEach(function(e,n){var r=e.canvasCoords,c=l.framebuffer({width:f,height:f,depth:!1,colorFormat:"rgba",colorType:"uint8"}),p=new Uint8Array(4*(f*f));c.use(function(){a.calcTileDiff({canvasSize:[f,f],canvasCoordinates:[0,0],textureA:s.texture,textureB:d.texture,textureBoundsA:o[n],textureBoundsB:i[n]}),l.read({data:p})}),p=a.flipReadPixelsUint(f,f,p),b[t]=p,t+=1,a.drawTileDiff({colorScale:m,sentinelValues:x,canvasSize:u,canvasCoordinates:r,textureA:s.texture,textureB:d.texture,textureBoundsA:o[n],textureBoundsB:i[n]}),c.destroy()})},i=0,r=e,c;i<r.length;i++)c=r[i],o(c);n(g)}(),this.textureManagerA.destroy(),this.textureManagerB.destroy(),this.textureManagerA=new Vy(l,f,b_,!1),this.textureManagerB=new Vy(l,f,b_,!1),b},t.prototype.renderTilesWithMultiAnalyze1=function(e,t,o,i,n,a,r){var l=this,s=this,d=s.regl,f=s.textureManagerA,u=s.tileSize,c=this.computeRequiredCanvasDimensions(e.length),p=c[0],g=c[1];this.setCanvasSize(p,g);var h=this.getCanvasCoordinates(p,g,e.length),m=Zb(e,h,function(e,t){return{coords:e.coords,tilesAPixelData:e.pixelData,canvasCoords:t}}),x=$a(t),b=$a(o),_=[];return function(){var e=St(m,f.tileCapacity);d.clear({color:x_});for(var t=0,o=function(e){var o=e.map(function(e){var t=e.coords,o=e.tilesAPixelData;return f.addTile(t,o)});e.forEach(function(e,r){var s=e.canvasCoords,p=d.framebuffer({width:u,height:u,depth:!1,colorFormat:"rgba",colorType:"uint8"}),g=new Uint8Array(4*(u*u));p.use(function(){l.calcTileMultiAnalyze1({canvasSize:[u,u],canvasCoordinates:[0,0],textureA:f.texture,textureBoundsA:o[r],filterLowA:i,filterHighA:n,multiplierA:a}),d.read({data:g})}),g=l.flipReadPixelsUint(u,u,g),_[t]=g,t+=1,l.drawTileMultiAnalyze1({colorScale:x,sentinelValues:b,canvasSize:c,canvasCoordinates:s,textureA:f.texture,textureBoundsA:o[r],filterLowA:i,filterHighA:n,multiplierA:a}),p.destroy()})},s=0,p=e,g;s<p.length;s++)g=p[s],o(g);r(h)}(),this.textureManagerA.destroy(),this.textureManagerA=new Vy(d,u,b_,!1),_},t.prototype.renderTilesWithMultiAnalyze2=function(e,t,o,i,n,a,r,l,s,d,f){var u=this,c=this,p=c.regl,g=c.textureManagerA,h=c.textureManagerB,m=c.tileSize,x=this.computeRequiredCanvasDimensions(e.length),b=x[0],_=x[1];this.setCanvasSize(b,_);var y=this.getCanvasCoordinates(b,_,e.length),v=Zb(e,t,y,function(e,t,o){return{coords:e.coords,tilesAPixelData:e.pixelData,tilesBPixelData:t.pixelData,canvasCoords:o}}),T=$a(o),A=$a(i),C=[];return function(){var e=St(v,g.tileCapacity);p.clear({color:x_});for(var t=0,o=function(e){var o=e.map(function(e){var t=e.coords,o=e.tilesAPixelData;return g.addTile(t,o)}),i=e.map(function(e){var t=e.coords,o=e.tilesBPixelData;return h.addTile(t,o)});e.forEach(function(e,f){var c=e.canvasCoords,b=p.framebuffer({width:m,height:m,depth:!1,colorFormat:"rgba",colorType:"uint8"}),_=new Uint8Array(4*(m*m));b.use(function(){u.calcTileMultiAnalyze2({canvasSize:[m,m],canvasCoordinates:[0,0],textureA:g.texture,textureB:h.texture,textureBoundsA:o[f],textureBoundsB:i[f],filterLowA:n,filterHighA:a,filterLowB:r,filterHighB:l,multiplierA:s,multiplierB:d}),p.read({data:_})}),_=u.flipReadPixelsUint(m,m,_),C[t]=_,t+=1,u.drawTileMultiAnalyze2({colorScale:T,sentinelValues:A,canvasSize:x,canvasCoordinates:c,textureA:g.texture,textureB:h.texture,textureBoundsA:o[f],textureBoundsB:i[f],filterLowA:n,filterHighA:a,filterLowB:r,filterHighB:l,multiplierA:s,multiplierB:d}),b.destroy()})},i=0,c=e,b;i<c.length;i++)b=c[i],o(b);f(y)}(),this.textureManagerA.destroy(),this.textureManagerB.destroy(),this.textureManagerA=new Vy(p,m,b_,!1),this.textureManagerB=new Vy(p,m,b_,!1),C},t.prototype.renderTilesWithMultiAnalyze3=function(e,t,o,i,n,a,r,l,s,d,f,u,c,p,g){var h=this,m=this,x=m.regl,b=m.textureManagerA,_=m.textureManagerB,y=m.textureManagerC,v=m.tileSize,T=this.computeRequiredCanvasDimensions(e.length),A=T[0],C=T[1];this.setCanvasSize(A,C);var E=this.getCanvasCoordinates(A,C,e.length),B=Zb(e,t,o,E,function(e,t,o,i){return{coords:e.coords,tilesAPixelData:e.pixelData,tilesBPixelData:t.pixelData,tilesCPixelData:o.pixelData,canvasCoords:i}}),w=$a(i),S=$a(n),D=[];return function(){var e=St(B,b.tileCapacity);x.clear({color:x_});for(var t=0,o=function(e){var o=e.map(function(e){var t=e.coords,o=e.tilesAPixelData;return b.addTile(t,o)}),i=e.map(function(e){var t=e.coords,o=e.tilesBPixelData;return _.addTile(t,o)}),n=e.map(function(e){var t=e.coords,o=e.tilesCPixelData;return y.addTile(t,o)});e.forEach(function(e,g){var m=e.canvasCoords,A=x.framebuffer({width:v,height:v,depth:!1,colorFormat:"rgba",colorType:"uint8"}),C=new Uint8Array(4*(v*v));A.use(function(){h.calcTileMultiAnalyze3({canvasSize:[v,v],canvasCoordinates:[0,0],textureA:b.texture,textureB:_.texture,textureC:y.texture,textureBoundsA:o[g],textureBoundsB:i[g],textureBoundsC:n[g],filterLowA:a,filterHighA:r,filterLowB:l,filterHighB:s,filterLowC:d,filterHighC:f,multiplierA:u,multiplierB:c,multiplierC:p}),x.read({data:C})}),C=h.flipReadPixelsUint(v,v,C),D[t]=C,t+=1,h.drawTileMultiAnalyze3({colorScale:w,sentinelValues:S,canvasSize:T,canvasCoordinates:m,textureA:b.texture,textureB:_.texture,textureC:y.texture,textureBoundsA:o[g],textureBoundsB:i[g],textureBoundsC:n[g],filterLowA:a,filterHighA:r,filterLowB:l,filterHighB:s,filterLowC:d,filterHighC:f,multiplierA:u,multiplierB:c,multiplierC:p}),A.destroy()})},i=0,n=e,m;i<n.length;i++)m=n[i],o(m);g(E)}(),this.textureManagerA.destroy(),this.textureManagerB.destroy(),this.textureManagerC.destroy(),this.textureManagerA=new Vy(x,v,b_,!1),this.textureManagerB=new Vy(x,v,b_,!1),this.textureManagerC=new Vy(x,v,b_,!1),D},t.prototype.renderTilesWithMultiAnalyze4=function(e,t,o,i,n,a,r,l,s,d,f,u,c,p,g,h,m,x,b){var _=this,y=this,v=y.regl,T=y.textureManagerA,A=y.textureManagerB,C=y.textureManagerC,E=y.textureManagerD,B=y.tileSize,w=this.computeRequiredCanvasDimensions(e.length),S=w[0],D=w[1];this.setCanvasSize(S,D);var I=this.getCanvasCoordinates(S,D,e.length),F=Zb(e,t,o,i,I,function(e,t,o,i,n){return{coords:e.coords,tilesAPixelData:e.pixelData,tilesBPixelData:t.pixelData,tilesCPixelData:o.pixelData,tilesDPixelData:i.pixelData,canvasCoords:n}}),R=$a(n),k=$a(a),N=[];return function(){var e=St(F,T.tileCapacity);v.clear({color:x_});for(var t=0,o=function(e){var o=e.map(function(e){var t=e.coords,o=e.tilesAPixelData;return T.addTile(t,o)}),i=e.map(function(e){var t=e.coords,o=e.tilesBPixelData;return A.addTile(t,o)}),n=e.map(function(e){var t=e.coords,o=e.tilesCPixelData;return C.addTile(t,o)}),a=e.map(function(e){var t=e.coords,o=e.tilesDPixelData;return E.addTile(t,o)});e.forEach(function(e,b){var y=e.canvasCoords,S=v.framebuffer({width:B,height:B,depth:!1,colorFormat:"rgba",colorType:"uint8"}),D=new Uint8Array(4*(B*B));S.use(function(){_.calcTileMultiAnalyze4({canvasSize:[B,B],canvasCoordinates:[0,0],textureA:T.texture,textureB:A.texture,textureC:C.texture,textureD:E.texture,textureBoundsA:o[b],textureBoundsB:i[b],textureBoundsC:n[b],textureBoundsD:a[b],filterLowA:r,filterHighA:l,filterLowB:s,filterHighB:d,filterLowC:f,filterHighC:u,filterLowD:c,filterHighD:p,multiplierA:g,multiplierB:h,multiplierC:m,multiplierD:x}),v.read({data:D})}),D=_.flipReadPixelsUint(B,B,D),N[t]=D,t+=1,_.drawTileMultiAnalyze4({colorScale:R,sentinelValues:k,canvasSize:w,canvasCoordinates:y,textureA:T.texture,textureB:A.texture,textureC:C.texture,textureD:E.texture,textureBoundsA:o[b],textureBoundsB:i[b],textureBoundsC:n[b],textureBoundsD:a[b],filterLowA:r,filterHighA:l,filterLowB:s,filterHighB:d,filterLowC:f,filterHighC:u,filterLowD:c,filterHighD:p,multiplierA:g,multiplierB:h,multiplierC:m,multiplierD:x}),S.destroy()})},i=0,n=e,a;i<n.length;i++)a=n[i],o(a);b(I)}(),this.textureManagerA.destroy(),this.textureManagerB.destroy(),this.textureManagerC.destroy(),this.textureManagerD.destroy(),this.textureManagerA=new Vy(v,B,b_,!1),this.textureManagerB=new Vy(v,B,b_,!1),this.textureManagerC=new Vy(v,B,b_,!1),this.textureManagerD=new Vy(v,B,b_,!1),N},t.prototype.renderTilesWithMultiAnalyze5=function(e,t,o,i,n,a,r,l,s,d,f,u,c,p,g,h,m,x,b,_,y,v,T){var A=this,C=this,E=C.regl,B=C.textureManagerA,w=C.textureManagerB,S=C.textureManagerC,D=C.textureManagerD,I=C.textureManagerE,F=C.tileSize,R=this.computeRequiredCanvasDimensions(e.length),k=R[0],N=R[1];this.setCanvasSize(k,N);var M=this.getCanvasCoordinates(k,N,e.length),H=Zb(e,t,o,i,n,M,function(e,t,o,i,n,a){return{coords:e.coords,tilesAPixelData:e.pixelData,tilesBPixelData:t.pixelData,tilesCPixelData:o.pixelData,tilesDPixelData:i.pixelData,tilesEPixelData:n.pixelData,canvasCoords:a}}),V=$a(a),O=$a(r),z=[];return function(){var e=St(H,B.tileCapacity);E.clear({color:x_});for(var t=0,o=function(e){var o=e.map(function(e){var t=e.coords,o=e.tilesAPixelData;return B.addTile(t,o)}),i=e.map(function(e){var t=e.coords,o=e.tilesBPixelData;return w.addTile(t,o)}),n=e.map(function(e){var t=e.coords,o=e.tilesCPixelData;return S.addTile(t,o)}),a=e.map(function(e){var t=e.coords,o=e.tilesDPixelData;return D.addTile(t,o)}),r=e.map(function(e){var t=e.coords,o=e.tilesEPixelData;return I.addTile(t,o)});e.forEach(function(e,T){var C=e.canvasCoords,k=E.framebuffer({width:F,height:F,depth:!1,colorFormat:"rgba",colorType:"uint8"}),N=new Uint8Array(4*(F*F));k.use(function(){A.calcTileMultiAnalyze5({canvasSize:[F,F],canvasCoordinates:[0,0],textureA:B.texture,textureB:w.texture,textureC:S.texture,textureD:D.texture,textureE:I.texture,textureBoundsA:o[T],textureBoundsB:i[T],textureBoundsC:n[T],textureBoundsD:a[T],textureBoundsE:r[T],filterLowA:l,filterHighA:s,filterLowB:d,filterHighB:f,filterLowC:u,filterHighC:c,filterLowD:p,filterHighD:g,filterLowE:h,filterHighE:m,multiplierA:x,multiplierB:b,multiplierC:_,multiplierD:y,multiplierE:v}),E.read({data:N})}),N=A.flipReadPixelsUint(F,F,N),z[t]=N,t+=1,A.drawTileMultiAnalyze5({colorScale:V,sentinelValues:O,canvasSize:R,canvasCoordinates:C,textureA:B.texture,textureB:w.texture,textureC:S.texture,textureD:D.texture,textureE:I.texture,textureBoundsA:o[T],textureBoundsB:i[T],textureBoundsC:n[T],textureBoundsD:a[T],textureBoundsE:r[T],filterLowA:l,filterHighA:s,filterLowB:d,filterHighB:f,filterLowC:u,filterHighC:c,filterLowD:p,filterHighD:g,filterLowE:h,filterHighE:m,multiplierA:x,multiplierB:b,multiplierC:_,multiplierD:y,multiplierE:v}),k.destroy()})},i=0,n=e,a;i<n.length;i++)a=n[i],o(a);T(M)}(),this.textureManagerA.destroy(),this.textureManagerB.destroy(),this.textureManagerC.destroy(),this.textureManagerD.destroy(),this.textureManagerE.destroy(),this.textureManagerA=new Vy(E,F,b_,!1),this.textureManagerB=new Vy(E,F,b_,!1),this.textureManagerC=new Vy(E,F,b_,!1),this.textureManagerD=new Vy(E,F,b_,!1),this.textureManagerE=new Vy(E,F,b_,!1),z},t.prototype.renderTilesWithMultiAnalyze6=function(e,t,o,i,n,a,r,l,s,d,f,u,c,p,g,h,m,x,b,_,y,v,T,A,C,E,B){var w=this,S=this,D=S.regl,I=S.textureManagerA,F=S.textureManagerB,R=S.textureManagerC,k=S.textureManagerD,N=S.textureManagerE,M=S.textureManagerF,H=S.tileSize,V=this.computeRequiredCanvasDimensions(e.length),O=V[0],z=V[1];this.setCanvasSize(O,z);var P=this.getCanvasCoordinates(O,z,e.length),G=Zb(e,t,o,i,n,a,P,function(e,t,o,i,n,a,r){return{coords:e.coords,tilesAPixelData:e.pixelData,tilesBPixelData:t.pixelData,tilesCPixelData:o.pixelData,tilesDPixelData:i.pixelData,tilesEPixelData:n.pixelData,tilesFPixelData:a.pixelData,canvasCoords:r}}),j=$a(r),U=$a(l),W=[];return function(){var e=St(G,I.tileCapacity);D.clear({color:x_});for(var t=0,o=function(e){var o=e.map(function(e){var t=e.coords,o=e.tilesAPixelData;return I.addTile(t,o)}),i=e.map(function(e){var t=e.coords,o=e.tilesBPixelData;return F.addTile(t,o)}),n=e.map(function(e){var t=e.coords,o=e.tilesCPixelData;return R.addTile(t,o)}),a=e.map(function(e){var t=e.coords,o=e.tilesDPixelData;return k.addTile(t,o)}),r=e.map(function(e){var t=e.coords,o=e.tilesEPixelData;return N.addTile(t,o)}),l=e.map(function(e){var t=e.coords,o=e.tilesFPixelData;return M.addTile(t,o)});e.forEach(function(e,B){var S=e.canvasCoords,O=D.framebuffer({width:H,height:H,depth:!1,colorFormat:"rgba",colorType:"uint8"}),z=new Uint8Array(4*(H*H));O.use(function(){w.calcTileMultiAnalyze6({canvasSize:[H,H],canvasCoordinates:[0,0],textureA:I.texture,textureB:F.texture,textureC:R.texture,textureD:k.texture,textureE:N.texture,textureF:M.texture,textureBoundsA:o[B],textureBoundsB:i[B],textureBoundsC:n[B],textureBoundsD:a[B],textureBoundsE:r[B],textureBoundsF:l[B],filterLowA:s,filterHighA:d,filterLowB:f,filterHighB:u,filterLowC:c,filterHighC:p,filterLowD:g,filterHighD:h,filterLowE:m,filterHighE:x,filterLowF:b,filterHighF:_,multiplierA:y,multiplierB:v,multiplierC:T,multiplierD:A,multiplierE:C,multiplierF:E}),D.read({data:z})}),z=w.flipReadPixelsUint(H,H,z),W[t]=z,t+=1,w.drawTileMultiAnalyze6({colorScale:j,sentinelValues:U,canvasSize:V,canvasCoordinates:S,textureA:I.texture,textureB:F.texture,textureC:R.texture,textureD:k.texture,textureE:N.texture,textureF:M.texture,textureBoundsA:o[B],textureBoundsB:i[B],textureBoundsC:n[B],textureBoundsD:a[B],textureBoundsE:r[B],textureBoundsF:l[B],filterLowA:s,filterHighA:d,filterLowB:f,filterHighB:u,filterLowC:c,filterHighC:p,filterLowD:g,filterHighD:h,filterLowE:m,filterHighE:x,filterLowF:b,filterHighF:_,multiplierA:y,multiplierB:v,multiplierC:T,multiplierD:A,multiplierE:C,multiplierF:E}),O.destroy()})},i=0,n=e,a;i<n.length;i++)a=n[i],o(a);B(P)}(),this.textureManagerA.destroy(),this.textureManagerB.destroy(),this.textureManagerC.destroy(),this.textureManagerD.destroy(),this.textureManagerE.destroy(),this.textureManagerF.destroy(),this.textureManagerA=new Vy(D,H,b_,!1),this.textureManagerB=new Vy(D,H,b_,!1),this.textureManagerC=new Vy(D,H,b_,!1),this.textureManagerD=new Vy(D,H,b_,!1),this.textureManagerE=new Vy(D,H,b_,!1),this.textureManagerF=new Vy(D,H,b_,!1),W},t.prototype.renderTilesWithTransition=function(e,t,i,a,r,l){return o(this,void 0,void 0,function(){var o=this,s,d,f,u,c,p,g,h,m,x,b,_,y,v,T,A;return n(this,function(n){switch(n.label){case 0:return s=this,d=s.regl,f=s.textureManager,u=s.tileSize,c=s.maxTextureDimension,p=this.computeRequiredCanvasDimensions(e.length),g=p[0],h=p[1],this.setCanvasSize(g,h),m=this.getCanvasCoordinates(g,h,e.length),x=Zb(e,t,m,function(e,t,o){return{coords:e.coords,oldPixelData:e.pixelData,newPixelData:t.pixelData,canvasCoords:o}}),b=new Vy(d,u,c,!1),_=$a(i),y=$a(a),v=d.now(),T=function(e){var t=St(x,f.tileCapacity);d.clear({color:x_});for(var i=function(t){var i=t.map(function(e){var t=e.coords,o=e.oldPixelData;return f.addTile(t,o)}),n=t.map(function(e){var t=e.coords,o=e.newPixelData;return b.addTile(t,o)});o.drawTileInterpolateValue(t.map(function(t,o){var a=t.canvasCoords;return{colorScale:_,sentinelValues:y,canvasSize:p,canvasCoordinates:a,textureA:f.texture,textureB:b.texture,textureBoundsA:i[o],textureBoundsB:n[o],interpolationFraction:e}}))},n=0,a=t,r;n<a.length;n++)r=a[n],i(r);l(m)},A=d.frame(function(e){var t=e.time,o=1e3*(t-v);T(o/r)}),[4,nr(r)];case 1:return n.sent(),A.cancel(),T(1),this.textureManager.destroy(),this.textureManager=b,[2];}})})},t.prototype.renderTilesWithTransitionAndNewColorScale=function(e,t,i,a,r,l,s,d){return o(this,void 0,void 0,function(){var o=this,f,u,c,p,g,h,m,x,b,_,y,v,T,A,C,E,B,w;return n(this,function(n){switch(n.label){case 0:return f=this,u=f.regl,c=f.textureManager,p=f.tileSize,g=f.maxTextureDimension,h=this.computeRequiredCanvasDimensions(e.length),m=h[0],x=h[1],this.setCanvasSize(m,x),b=this.getCanvasCoordinates(m,x,e.length),_=Zb(e,t,b,function(e,t,o){return{coords:e.coords,oldPixelData:e.pixelData,newPixelData:t.pixelData,canvasCoords:o}}),y=new Vy(u,p,g,!1),v=$a(i),T=$a(a),A=$a(r),C=$a(l),E=u.now(),B=function(e){var t=St(_,c.tileCapacity);u.clear({color:x_});for(var i=function(t){var i=t.map(function(e){var t=e.coords,o=e.oldPixelData;return c.addTile(t,o)}),n=t.map(function(e){var t=e.coords,o=e.newPixelData;return y.addTile(t,o)});o.drawTileInterpolateColor(t.map(function(t,o){var a=t.canvasCoords;return{colorScaleA:v,colorScaleB:T,sentinelValuesA:A,sentinelValuesB:C,canvasSize:h,canvasCoordinates:a,textureA:c.texture,textureB:y.texture,textureBoundsA:i[o],textureBoundsB:n[o],interpolationFraction:e}}))},n=0,a=t,r;n<a.length;n++)r=a[n],i(r);d(b)},w=u.frame(function(e){var t=e.time,o=1e3*(t-E);B(o/s)}),[4,nr(s)];case 1:return n.sent(),w.cancel(),B(1),this.textureManager.destroy(),this.textureManager=y,[2];}})})},t.prototype.renderTilesWithTransitionAndNewColorScaleOnly=function(e,t,i,a,r,l,s){return o(this,void 0,void 0,function(){var o=this,d,f,u,c,p,g,h,m,x,b,_,y,v,T,A,C,E,B;return n(this,function(n){switch(n.label){case 0:return d=this,f=d.regl,u=d.textureManager,c=d.tileSize,p=d.maxTextureDimension,g=this.computeRequiredCanvasDimensions(e.length),h=g[0],m=g[1],this.setCanvasSize(h,m),x=this.getCanvasCoordinates(h,m,e.length),b=Zb(e,x,function(e,t){return Qu({},e,{canvasCoords:t})}),_=new Vy(f,c,p,!1),y=$a(t),v=$a(i),T=$a(a),A=$a(r),C=f.now(),E=function(e){var t=St(b,u.tileCapacity);f.clear({color:x_});for(var i=function(t){var i=t.map(function(e){var t=e.coords,o=e.pixelData;return u.addTile(t,o)});o.drawTileInterpolateColorOnly(t.map(function(t,o){var n=t.canvasCoords;return{colorScaleA:y,colorScaleB:v,sentinelValuesA:T,sentinelValuesB:A,canvasSize:g,canvasCoordinates:n,texture:u.texture,textureBounds:i[o],interpolationFraction:e}}))},n=0,a=t,r;n<a.length;n++)r=a[n],i(r);s(x)},B=f.frame(function(e){var t=e.time,o=1e3*(t-C);E(o/l)}),[4,nr(l)];case 1:return n.sent(),B.cancel(),E(1),this.textureManager.destroy(),this.textureManager=_,[2];}})})},t.prototype.removeTile=function(e){this.textureManager.removeTile(e)},t.prototype.setCanvasSize=function(e,t){Object.assign(this.canvas,{width:e,height:t})},t.prototype.computeRequiredCanvasDimensions=function(e){var t=this.tileSize,o=Yu(Ou(e)),i=Yu(e/o);return[o*t,i*t]},t.prototype.getCanvasCoordinates=function(e,t,o){var i=this.tileSize;return fi(er(0,t,i),function(t){return er(0,e,i).map(function(e){return[e,t]})}).slice(0,o)},t}(),zy={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};jr.prototype={constructor:jr,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};fl.prototype={add:function(e){var t=this._names.indexOf(e);0>t&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);0<=t&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return 0<=this._names.indexOf(e)}};var Py={},Gy=null;if("undefined"!=typeof document){var jy=document.documentElement;"onmouseenter"in jy||(Py={mouseenter:"mouseover",mouseleave:"mouseout"})}var Uy=[null];Ml.prototype=function(){return new Ml([[document.documentElement]],Uy)}.prototype={constructor:Ml,select:Vr,selectAll:function(e){"function"!=typeof e&&(e=zr(e));for(var t=this._groups,o=t.length,a=[],r=[],l=0;l<o;++l)for(var s=t[l],d=s.length,n=0,f;n<d;++n)(f=s[n])&&(a.push(e.call(f,f.__data__,n,s)),r.push(f));return new Ml(a,r)},filter:function(e){"function"!=typeof e&&(e=Pr(e));for(var t=this._groups,o=t.length,a=Array(o),r=0;r<o;++r)for(var l=t[r],s=l.length,n=a[r]=[],d=0,f;d<s;++d)(f=l[d])&&e.call(f,f.__data__,d,l)&&n.push(f);return new Ml(a,this._parents)},data:function(e,t){if(!e)return p=Array(this.size()),f=-1,this.each(function(e){p[++f]=e}),p;var o=t?Xr:Wr,i=this._parents,n=this._groups;"function"!=typeof e&&(e=Ur(e));for(var a=n.length,r=Array(a),l=Array(a),s=Array(a),f=0;f<a;++f){var d=i[f],u=n[f],c=u.length,p=e.call(d,d&&d.__data__,f,i),g=p.length,h=l[f]=Array(g),m=r[f]=Array(g),x=s[f]=Array(c);o(d,u,h,m,x,p,t);for(var b=0,_=0,y,v;b<g;++b)if(y=h[b]){for(b>=_&&(_=b+1);!(v=m[_])&&++_<g;);y._next=v||null}}return r=new Ml(r,i),r._enter=l,r._exit=s,r},enter:function(){return new Ml(this._enter||this._groups.map(Gr),this._parents)},exit:function(){return new Ml(this._exit||this._groups.map(Gr),this._parents)},join:function(e,t,o){var i=this.enter(),n=this,a=this.exit();return i="function"==typeof e?e(i):i.append(e+""),null!=t&&(n=t(n)),null==o?a.remove():o(a),i&&n?i.merge(n).order():n},merge:function(e){for(var t=this._groups,o=e._groups,a=t.length,r=o.length,l=Zu(a,r),s=Array(a),d=0;d<l;++d)for(var f=t[d],u=o[d],c=f.length,n=s[d]=Array(c),p=0,g;p<c;++p)(g=f[p]||u[p])&&(n[p]=g);for(;d<a;++d)s[d]=t[d];return new Ml(s,this._parents)},order:function(){for(var e=this._groups,t=-1,o=e.length;++t<o;)for(var n=e[t],a=n.length-1,r=n[a],l;0<=--a;)(l=n[a])&&(r&&4^l.compareDocumentPosition(r)&&r.parentNode.insertBefore(l,r),r=l);return this},sort:function(e){function t(t,o){return t&&o?e(t.__data__,o.__data__):!t-!o}e||(e=qr);for(var o=this._groups,a=o.length,r=Array(a),l=0;l<a;++l){for(var s=o[l],d=s.length,n=r[l]=Array(d),f=0,u;f<d;++f)(u=s[f])&&(n[f]=u);n.sort(t)}return new Ml(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,o=e.length;t<o;++t)for(var a=e[t],r=0,l=a.length,n;r<l;++r)if(n=a[r],n)return n;return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,o=0,a=t.length;o<a;++o)for(var r=t[o],l=0,s=r.length,n;l<s;++l)(n=r[l])&&e.call(n,n.__data__,l,r);return this},attr:function(e,t){var o=Fr(e);if(2>arguments.length){var i=this.node();return o.local?i.getAttributeNS(o.space,o.local):i.getAttribute(o)}return this.each((null==t?o.local?Zr:Yr:"function"==typeof t?o.local?Jr:Qr:o.local?$r:Kr)(o,t))},style:function(e,t,o){return 1<arguments.length?this.each((null==t?tl:"function"==typeof t?il:ol)(e,t,null==o?"":o)):nl(this.node(),e)},property:function(e,t){return 1<arguments.length?this.each((null==t?al:"function"==typeof t?ll:rl)(e,t)):this.node()[e]},classed:function(e,t){var o=sl(e+"");if(2>arguments.length){for(var a=dl(this.node()),r=-1,l=o.length;++r<l;)if(!a.contains(o[r]))return!1;return!0}return this.each(("function"==typeof t?hl:t?pl:gl)(o,t))},text:function(e){return arguments.length?this.each(null==e?ml:("function"==typeof e?bl:xl)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?_l:("function"==typeof e?vl:yl)(e)):this.node().innerHTML},raise:function(){return this.each(Tl)},lower:function(){return this.each(Al)},append:function(e){var t="function"==typeof e?e:Nr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var o="function"==typeof e?e:Nr(e),i=null==t?Cl:"function"==typeof t?t:Hr(t);return this.select(function(){return this.insertBefore(o.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(El)},clone:function(e){return this.select(e?wl:Bl)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,a,r){var l=Dl(e+""),s=l.length,n,d;if(2>arguments.length){var f=this.node().__on;if(f)for(var u=0,c=f.length,p;u<c;++u)for(n=0,p=f[u];n<s;++n)if((d=l[n]).type===p.type&&d.name===p.name)return p.value;return}for(f=a?Fl:Il,null==r&&(r=!1),n=0;n<s;++n)this.each(f(l[n],a,r));return this},dispatch:function(e,t){return this.each(("function"==typeof t?Nl:kl)(e,t))}};var Wy=function(e){return 1===e.length&&(e=Vl(e)),{left:function(t,o,i,n){for(null==i&&(i=0),null==n&&(n=t.length);i<n;){var a=i+n>>>1;0>e(t[a],o)?i=a+1:n=a}return i},right:function(t,o,i,n){for(null==i&&(i=0),null==n&&(n=t.length);i<n;){var a=i+n>>>1;0<e(t[a],o)?n=a:i=a+1}return i}}}(Hl),Xy=Wy.right,qy=Ou(50),Yy=Ou(10),Zy=Ou(2),Ky=.7,$y=1/Ky,Qy="\\s*([+-]?\\d+)\\s*",Jy="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ev="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tv=/^#([0-9a-f]{3,8})$/,ov=new RegExp("^rgb\\("+[Qy,Qy,Qy]+"\\)$"),iv=new RegExp("^rgb\\("+[ev,ev,ev]+"\\)$"),nv=new RegExp("^rgba\\("+[Qy,Qy,Qy,Jy]+"\\)$"),av=new RegExp("^rgba\\("+[ev,ev,ev,Jy]+"\\)$"),rv=new RegExp("^hsl\\("+[Jy,ev,ev]+"\\)$"),lv=new RegExp("^hsla\\("+[Jy,ev,ev,Jy]+"\\)$"),sv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wl(ql,Kl,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Yl,formatHex:Yl,formatHsl:function(){return rs(this).formatHsl()},formatRgb:Zl,toString:Zl}),Wl(ts,es,Xl(ql,{brighter:function(e){return e=null==e?$y:ju($y,e),new ts(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?Ky:ju(Ky,e),new ts(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&255.5>this.r&&-.5<=this.g&&255.5>this.g&&-.5<=this.b&&255.5>this.b&&0<=this.opacity&&1>=this.opacity},hex:os,formatHex:os,formatRgb:is,toString:is})),Wl(ls,function(e,t,o,i){return 1===arguments.length?rs(e):new ls(e,t,o,null==i?1:i)},Xl(ql,{brighter:function(e){return e=null==e?$y:ju($y,e),new ls(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Ky:ju(Ky,e),new ls(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(0>this.h),t=isNaN(e)||isNaN(this.s)?0:this.s,o=this.l,i=o+(.5>o?o:1-o)*t,n=2*o-i;return new ts(ss(240<=e?e-240:e+120,n,i),ss(e,n,i),ss(120>e?e+240:e-120,n,i),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:qu(0,Zu(1,e)),(1===e?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var dv=Mu/180,fv=180/Mu,uv=18,K=.96422,Xn=.82521,Zn=4/29,cv=6/29,pv=3*cv*cv,gv=cv*cv*cv;Wl(fs,function(e,t,o,i){return 1===arguments.length?ds(e):new fs(e,t,o,null==i?1:i)},Xl(ql,{brighter:function(e){return new fs(this.l+uv*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new fs(this.l-uv*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,o=isNaN(this.b)?e:e-this.b/200;return t=K*cs(t),e=1*cs(e),o=Xn*cs(o),new ts(ps(3.1338561*t-1.6168667*e-.4906146*o),ps(-.9787684*t+1.9161415*e+.033454*o),ps(.0719453*t-.2289914*e+1.4052427*o),this.opacity)}})),Wl(xs,ms,Xl(ql,{brighter:function(e){return new xs(this.h,this.c,this.l+uv*(null==e?1:e),this.opacity)},darker:function(e){return new xs(this.h,this.c,this.l-uv*(null==e?1:e),this.opacity)},rgb:function(){return bs(this).rgb()}}));var hv=-.14861,A=+1.78277,B=-.29227,C=-.90649,D=+1.97294,E=D*C,mv=D*A,xv=A*B-C*hv;Wl(ys,function(e,t,o,i){return 1===arguments.length?_s(e):new ys(e,t,o,null==i?1:i)},Xl(ql,{brighter:function(e){return e=null==e?$y:ju($y,e),new ys(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Ky:ju(Ky,e),new ys(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*dv,t=+this.l,o=isNaN(this.s)?0:this.s*t*(1-t),i=Vu(e),n=Hu(e);return new ts(255*(t+o*(hv*i+A*n)),255*(t+o*(B*i+C*n)),255*(t+o*(D*i)),this.opacity)}}));var bv=function e(t){function o(e,t){var o=i((e=es(e)).r,(t=es(t)).r),n=i(e.g,t.g),a=i(e.b,t.b),r=Es(e.opacity,t.opacity);return function(i){return e.r=o(i),e.g=n(i),e.b=a(i),e.opacity=r(i),e+""}}var i=Cs(t);return o.gamma=e,o}(1),_v=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yv=new RegExp(_v.source,"g"),vv=Math.SQRT2,Tv=function(e){return function(o,i){var n=e((o=ms(o)).h,(i=ms(i)).h),a=Es(o.c,i.c),r=Es(o.l,i.l),l=Es(o.opacity,i.opacity);return function(e){return o.h=n(e),o.c=a(e),o.l=r(e),o.opacity=l(e),o+""}}}(function(e,t){var o=t-e;return o?Ts(e,180<o||-180>o?o-360*Pu(o/360):o):vs(isNaN(e)?t:e)}),Av=[0,1],Cv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;$s.prototype=Qs.prototype,Qs.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":qu(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+qu(0,0|this.precision))+(this.trim?"~":"")+this.type};var re={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Pu(e).toString(2)},c:function(e){return e+""},d:function(e){return Pu(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Pu(e).toString(8)},p:function(e,t){return ed(100*e,t)},r:ed,s:function(e,t){var o=qs(e,t);if(!o)return e+"";var a=o[0],r=o[1],l=r-(wv=3*qu(-8,Zu(8,Xu(r/3))))+1,i=a.length;return l===i?a:l>i?a+Array(l-i+1).join("0"):0<l?a.slice(0,l)+"."+a.slice(l):"0."+Array(1-l).join("0")+qs(e,qu(0,t+l-1))[0]},X:function(e){return Pu(e).toString(16).toUpperCase()},x:function(e){return Pu(e).toString(16)}},Ev=Array.prototype.map,Bv=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],wv,Sv,Lv,Dv;id({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var Iv=new Date,Fv=new Date,Rv=fd(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Rv.every=function(e){return e=Xu(e),isFinite(e)&&0<e?1<e?fd(function(t){t.setTime(Xu(t/e)*e)},function(t,o){t.setTime(+t+o*e)},function(t,o){return(o-t)/e}):Rv:null};var kv=Rv.range,Nv=1e3,Mv=6e4,Hv=36e5,Vv=864e5,Ov=fd(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Nv)},function(e,t){return(t-e)/Nv},function(e){return e.getUTCSeconds()}),zv=Ov.range,Pv=fd(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Nv)},function(e,t){e.setTime(+e+t*Mv)},function(e,t){return(t-e)/Mv},function(e){return e.getMinutes()}),Gv=Pv.range,jv=fd(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Nv-e.getMinutes()*Mv)},function(e,t){e.setTime(+e+t*Hv)},function(e,t){return(t-e)/Hv},function(e){return e.getHours()}),Uv=jv.range,Wv=fd(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mv)/Vv},function(e){return e.getDate()-1}),Xv=Wv.range,qv=ud(0),Yv=ud(1),Zv=ud(2),Kv=ud(3),$v=ud(4),Qv=ud(5),Jv=ud(6),eT=qv.range,tT=fd(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),oT=tT.range,iT=fd(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});iT.every=function(e){return isFinite(e=Xu(e))&&0<e?fd(function(t){t.setFullYear(Xu(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,o){t.setFullYear(t.getFullYear()+o*e)}):null};var nT=iT.range,aT=fd(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Mv)},function(e,t){return(t-e)/Mv},function(e){return e.getUTCMinutes()}),rT=aT.range,lT=fd(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Hv)},function(e,t){return(t-e)/Hv},function(e){return e.getUTCHours()}),sT=lT.range,dT=fd(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Vv},function(e){return e.getUTCDate()-1}),fT=dT.range,uT=cd(0),cT=cd(1),pT=cd(2),gT=cd(3),hT=cd(4),mT=cd(5),xT=cd(6),bT=uT.range,_T=fd(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),yT=_T.range,vT=fd(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});vT.every=function(e){return isFinite(e=Xu(e))&&0<e?fd(function(t){t.setUTCFullYear(Xu(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,o){t.setUTCFullYear(t.getUTCFullYear()+o*e)}):null};var TT=vT.range,AT={"-":"",_:" ",0:"0"},CT=/^\s*\d+/,ET=/^%/,BT=/[\\^$*+?|[\]().{}]/g,wT,ST,LT,DT,IT;Ef({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var FT=Date.prototype.toISOString?function(e){return e.toISOString()}:DT("%Y-%m-%dT%H:%M:%S.%LZ"),RT=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:IT("%Y-%m-%dT%H:%M:%S.%LZ");wf.prototype={constructor:wf,reset:function(){this.s=this.t=0},add:function(e){Sf(kT,e,this.t),Sf(this,kT.s,this.s),this.s?this.t+=kT.t:this.s=kT.t},valueOf:function(){return this.s}};var kT=new wf,NT=Ou,MT={Feature:function(e,t){Df(e.geometry,t)},FeatureCollection:function(e,t){for(var o=e.features,a=-1,r=o.length;++a<r;)Df(o[a].geometry,t)}},HT={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var o=e.coordinates,a=-1,r=o.length;++a<r;)e=o[a],t.point(e[0],e[1],e[2])},LineString:function(e,t){If(e.coordinates,t,0)},MultiLineString:function(e,t){for(var o=e.coordinates,a=-1,r=o.length;++a<r;)If(o[a],t,0)},Polygon:function(e,t){Ff(e.coordinates,t)},MultiPolygon:function(e,t){for(var o=e.coordinates,a=-1,r=o.length;++a<r;)Ff(o[a],t)},GeometryCollection:function(e,t){for(var o=e.geometries,a=-1,r=o.length;++a<r;)Df(o[a],t)}},VT=Bf(),OT=Bf(),zT=Bf(),PT=Bf(),GT=function(e){return 1===e.length&&(e=Nf(e)),{left:function(t,o,i,n){for(null==i&&(i=0),null==n&&(n=t.length);i<n;){var a=i+n>>>1;0>e(t[a],o)?i=a+1:n=a}return i},right:function(t,o,i,n){for(null==i&&(i=0),null==n&&(n=t.length);i<n;){var a=i+n>>>1;0<e(t[a],o)?n=a:i=a+1}return i}}}(kf),jT=Bf(),UT=Bf(),WT=Bf(),XT={point:Lf,lineStart:Lf,lineEnd:Lf,polygonStart:function(){XT.lineStart=Hf,XT.lineEnd=zf},polygonEnd:function(){XT.lineStart=XT.lineEnd=XT.point=Lf,UT.add(Gu(WT)),WT.reset()},result:function(){return UT.reset(),UT/2}},qT=1/0,YT=qT,ZT=-qT,KT=ZT,$T={point:Pf,lineStart:Lf,lineEnd:Lf,polygonStart:Lf,polygonEnd:Lf,result:function(){var e=[[qT,YT],[ZT,KT]];return ZT=KT=-(YT=qT=1/0),e}},QT=0,JT=0,eA=0,tA=0,oA=0,iA=0,nA=0,aA=0,rA=0,lA={point:Gf,lineStart:jf,lineEnd:Xf,polygonStart:function(){lA.lineStart=qf,lA.lineEnd=Yf},polygonEnd:function(){lA.point=Gf,lA.lineStart=jf,lA.lineEnd=Xf},result:function(){var e=rA?[nA/rA,aA/rA]:iA?[tA/iA,oA/iA]:eA?[QT/eA,JT/eA]:[NaN,NaN];return QT=JT=eA=tA=oA=iA=nA=aA=rA=0,e}},sA,dA,fA,uA,cA,pA,gA,hA;$f.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,2*Mu);break}}},result:Lf};var mA=Bf(),xA={point:Lf,lineStart:function(){xA.point=Qf},lineEnd:function(){bA&&Jf(_A,yA),xA.point=Lf},polygonStart:function(){bA=!0},polygonEnd:function(){bA=null},result:function(){return mA.reset(),+mA}},bA,_A,yA,vA,TA;eu.prototype={_radius:4.5,_circle:tu(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{null==this._circle&&(this._circle=tu(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var AA=function(e){return 1===e.length&&(e=iu(e)),{left:function(t,o,i,n){for(null==i&&(i=0),null==n&&(n=t.length);i<n;){var a=i+n>>>1;0>e(t[a],o)?i=a+1:n=a}return i},right:function(t,o,i,n){for(null==i&&(i=0),null==n&&(n=t.length);i<n;){var a=i+n>>>1;0<e(t[a],o)?n=a:i=a+1}return i}}}(ou),CA=Ou(50),EA=Ou(10),BA=Ou(2),wA=Array.prototype,SA=wA.slice,LA=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],DA="$";bu.prototype=_u.prototype={constructor:bu,has:function(e){return DA+e in this},get:function(e){return this[DA+e]},set:function(e,t){return this[DA+e]=t,this},remove:function(e){var t=DA+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===DA&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===DA&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===DA&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===DA&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===DA&&++e;return e},empty:function(){for(var e in this)if(e[0]===DA)return!1;return!0},each:function(e){for(var t in this)t[0]===DA&&e(this[t],t.slice(1),this)}};var IA=_u.prototype;yu.prototype=function(e,t){var o=new yu;if(e instanceof yu)e.each(function(e){o.add(e)});else if(e){var a=-1,r=e.length;if(null==t)for(;++a<r;)o.add(e[a]);else for(;++a<r;)o.add(t(e[a],a,e))}return o}.prototype={constructor:yu,has:IA.has,add:function(e){return e+="",this[DA+e]=e,this},remove:IA.remove,clear:IA.clear,values:IA.keys,size:IA.size,empty:IA.empty,each:IA.each};var FA={value:function(){}};Tu.prototype=vu.prototype={constructor:Tu,on:function(e,o){var a=this._,r=Au(e+"",a),l=-1,s=r.length,n;if(2>arguments.length){for(;++l<s;)if((n=(e=r[l]).type)&&(n=Cu(a[n],e.name)))return n;return}if(null!=o&&"function"!=typeof o)throw new Error("invalid callback: "+o);for(;++l<s;)if(n=(e=r[l]).type)a[n]=Eu(a[n],e.name,o);else if(null==o)for(n in a)a[n]=Eu(a[n],e.name,null);return this},copy:function(){var e={},o=this._;for(var i in o)e[i]=o[i].slice();return new Tu(e)},call:function(e,o){if(0<(l=arguments.length-2))for(var a=Array(l),r=0,l,s;r<l;++r)a[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,l=s.length;r<l;++r)s[r].value.apply(o,a)},apply:function(e,o,a){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],t=0,l=r.length;t<l;++t)r[t].value.apply(o,a)}};var RA=function(e,t){return function(o,i){var n=Bu(o).mimeType(e).response(t);if(null!=i){if("function"!=typeof i)throw new Error("invalid callback: "+i);return n.get(i)}return n}}("application/json",function(e){return JSON.parse(e.responseText)}),kA={},NA={},MA=Nu(","),HA=MA.parse,VA=MA.parseRows,OA=MA.format,zA=MA.formatBody,PA=MA.formatRows,GA=MA.formatRow,jA=MA.formatValue,UA=Nu("\t"),WA=UA.parse,XA=UA.parseRows,qA=UA.format,YA=UA.formatBody,ZA=UA.formatRows,KA=UA.formatRow,$A=UA.formatValue,QA=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours(),JA={select:function(e){return"string"==typeof e?new Ml([[document.querySelector(e)]],[document.documentElement]):new Ml([[e]],Uy)},selectAll:function(e){return"string"==typeof e?new Ml([document.querySelectorAll(e)],[document.documentElement]):new Ml([null==e?[]:e],Uy)},scaleLinear:dd,geoPath:function(e,t){function o(e){return e&&("function"==typeof i&&a.pointRadius(+i.apply(this,arguments)),Rf(e,n(a))),a.result()}var i=4.5,n,a;return o.area=function(e){return Rf(e,n(XT)),XT.result()},o.measure=function(e){return Rf(e,n(xA)),xA.result()},o.bounds=function(e){return Rf(e,n($T)),$T.result()},o.centroid=function(e){return Rf(e,n(lA)),lA.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,Mf):(e=t).stream,o):e},o.context=function(e){return arguments.length?(a=null==e?(t=null,new eu):new $f(t=e),"function"!=typeof i&&a.pointRadius(i),o):t},o.pointRadius=function(e){return arguments.length?(i="function"==typeof e?e:(a.pointRadius(+e),+e),o):i},o.projection(e).context(t)},contours:xu,interpolateHcl:Tv,event:Gy,json:RA,min:function(e,t){let o;if(t===void 0)for(const t of e)null!=t&&(o>t||void 0===o&&t>=t)&&(o=t);else{let i=-1;for(let n of e)null!=(n=t(n,++i,e))&&(o>n||void 0===o&&n>=n)&&(o=n)}return o},max:function(e,t){let o;if(t===void 0)for(const t of e)null!=t&&(o<t||void 0===o&&t>=t)&&(o=t);else{let i=-1;for(let n of e)null!=(n=t(n,++i,e))&&(o<n||void 0===o&&n>=n)&&(o=n)}return o},scan:function(e,t){const o=jl(e,t);return 0>o?void 0:o},range:function(e,t,o){e=+e,t=+t,o=2>(r=arguments.length)?(t=e,e=0,1):3>r?1:+o;for(var a=-1,r=0|qu(0,Yu((t-e)/o)),l=Array(r);++a<r;)l[a]=e+a*o;return l}},eC=Ja(),tC={colorScale:[],sentinelValues:[],transitions:!1,transitionTimeMs:800,debug:!1,extraPixelLayers:0,colorscaleMaxLength:16,sentinelMaxLength:16,minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,glOperation:"none",multiLayers:0,operationUrlA:"",operationUrlB:"",operationUrlC:"",operationUrlD:"",operationUrlE:"",operationUrlF:"",filterLowA:0,filterHighA:1e5,filterLowB:0,filterHighB:1e5,filterLowC:0,filterHighC:1e5,filterLowD:0,filterHighD:1e5,filterLowE:0,filterHighE:1e5,filterLowF:0,filterHighF:1e5,multiplierA:1,multiplierB:1,multiplierC:1,multiplierD:1,multiplierE:1,multiplierF:1,hillshadeType:"none",hsElevationScale:1,hsSimpleZoomdelta:0,hsSimpleSlopescale:3,hsSimpleAzimuth:315,hsSimpleAltitude:70,hsAdvSoftIterations:128,hsAdvAmbientIterations:40,hsAdvSunRadiusMultiplier:100,hsAdvFinalSoftMultiplier:4,hsAdvFinalAmbientMultiplier:.25,hsPregenUrl:"",_hillshadeOptions:{hillshadeType:"none"},contourType:"none",contourSmoothLines:!1,contourSmoothInput:!1,contourSmoothInputKernel:7,contourScaleFactor:1,contourInterval:25,contourIndexInterval:100,contourLineColor:"#000000",contourIlluminatedHighlightColor:"rgba(177,174,164,.5)",contourIlluminatedShadowColor:"#5b5143",contourIlluminatedShadowSize:2,contourLineWeight:.5,contourLineIndexWeight:2,contourIndexLabels:!1,contourLabelFont:"12px Arial",contourLabelDistance:250,contourHypso:!1,contourHypsoDomain:[0,1e3,2e3],contourHypsoColors:["#486341","#e5d9c9","#dddddd"],contourBathy:!1,contourBathyDomain:[-2e3,0],contourBathyColors:["#315d9b","#d5f2ff"],contourBathyShadowColor:"#4e5c66",contourBathyHighlightColor:"rgba(224, 242, 255, .5)"},oC=function(i){function a(e){var t=i.call(this,Object.assign({},tC,e))||this;t._contourData={},t._checkColorScaleAndSentinels();var a=t.options,r=a.nodataValue,l=a.preloadUrl,s=t._tileSizeAsNumber(),d=new Oy(s,r,t.options.colorscaleMaxLength,t.options.sentinelMaxLength);return Object.assign(t,{_renderer:d,_preloadTileCache:void 0}),t._maybePreload(l),t.on("tileunload",t._onTileRemove.bind(t)),t.on("load",function(){return setTimeout(function(){t.options.debug&&console.log("all tiles loaded. Updating contours if enabled."),t._maybeUpdateMergedArrayAndDrawContours()},300)}),setTimeout(function(){t._map.on("zoomend",function(){return setTimeout(function(){return o(t,void 0,void 0,function(){var e;return n(this,function(t){switch(t.label){case 0:return"none"===this.options.contourType?[3,2]:(this.options.debug&&console.log("zoom changed. Moving contour canvas."),[4,this._getActivetilesBounds()]);case 1:e=t.sent(),this._moveContourCanvas(e),t.label=2;case 2:return[2];}})})},50)})},300),t}return t(a,i),a.prototype.updateOptions=function(t){var i=this,a=this.options,r=a.url,l=a.glOperation,s=a.operationUrlA,d=a.operationUrlB,f=a.operationUrlC,u=a.operationUrlD,c=a.operationUrlE,p=a.operationUrlF,g=a.colorScale,h=a.sentinelValues,m=a.filterLowA,x=a.filterHighA,b=a.filterLowB,_=a.filterHighB,y=a.filterLowC,v=a.filterHighC,T=a.filterLowD,A=a.filterHighD,C=a.filterLowE,E=a.filterHighE,B=a.filterLowF,w=a.filterHighF,S=a.multiplierA,D=a.multiplierB,I=a.multiplierC,F=a.multiplierD,R=a.multiplierE,k=a.multiplierF,N=a.multiLayers,M=a.hsPregenUrl,H=a.hillshadeType,V=a.hsSimpleSlopescale,O=a.contourInterval,z=a.contourIndexInterval,P=a.contourLineColor,G=a.contourLineWeight,j=a.contourLineIndexWeight,U=a.contourType,W=a.contourSmoothLines,X=a.contourSmoothInput,q=a.contourSmoothInputKernel,Y=a.contourIlluminatedHighlightColor,Z=a.contourIlluminatedShadowColor,K=a.contourIlluminatedShadowSize,$=a.contourHypso,Q=a.contourHypsoDomain,J=a.contourHypsoColors,ee=a.contourBathy,te=a.contourBathyDomain,oe=a.contourBathyColors,ie=a.contourBathyShadowColor,ne=a.contourBathyHighlightColor,ae=a.contourIndexLabels,re=a.contourLabelFont,le=a.contourLabelDistance,se=a.colorscaleMaxLength,de=a.sentinelMaxLength;if(e.Util.setOptions(this,t),this.options.colorscaleMaxLength!==se||this.options.sentinelMaxLength!==de){this.options.debug&&console.log("Creating new renderer");var fe=this._tileSizeAsNumber(),ue=new Oy(fe,this.options.nodataValue,this.options.colorscaleMaxLength,this.options.sentinelMaxLength);this._renderer.regl.destroy(),delete this._renderer,Object.assign(this,{_renderer:ue})}if(this._checkColorScaleAndSentinels(),this._maybePreload(this.options.preloadUrl),this.options._hillshadeOptions={hillshadeType:this.options.hillshadeType,hsElevationScale:this.options.hsElevationScale,hsSimpleSlopescale:this.options.hsSimpleSlopescale,hsSimpleAzimuth:this.options.hsSimpleAzimuth,hsSimpleAltitude:this.options.hsSimpleAltitude,hsSimpleZoomdelta:this.options.hsSimpleZoomdelta,hsAdvSoftIterations:this.options.hsAdvSoftIterations,hsAdvAmbientIterations:this.options.hsAdvAmbientIterations,hsAdvSunRadiusMultiplier:this.options.hsAdvSunRadiusMultiplier,hsAdvFinalSoftMultiplier:this.options.hsAdvFinalSoftMultiplier,hsAdvFinalAmbientMultiplier:this.options.hsAdvFinalAmbientMultiplier,hsPregenUrl:this.options.hsPregenUrl},0<this.options.extraPixelLayers&&"none"===this.options.glOperation&&this._maybeLoadExtraLayers(s,d,f,u),this.options.hillshadeType!==H)if("simple"===this.options.hillshadeType)this._renderer.setMaxTextureDimension(this._tileSizeAsNumber());else if("simple"===H){var ce=this._renderer.findMaxTextureDimension();this._renderer.setMaxTextureDimension(ce)}"none"===this.options.glOperation?this.options.transitions?this.options.url===r?this.options.url===r&&(this._updateColorscaleWithTransitions(g,h),this.options.debug&&console.log("Running GLOperations with transition on colorscale only")):(this._updateTilesWithTransitions(g,h),this.options.debug&&console.log("Running GLOperations with transition on tiles")):this.options.url!==r||this.options.hillshadeType!==H||this.options.hsPregenUrl!==M||this.options.hsSimpleSlopescale!==V?(this._updateTiles(),this.options.debug&&console.log("Running GLOperations with new url, no transition and no operation")):JSON.stringify(this.options.colorScale)!==JSON.stringify(g)&&(this._updateTilesColorscaleOnly(),this.options.debug&&console.log("Running GLOperations with same url, no transition and no operation")):"multi"===this.options.glOperation?(1===this.options.multiLayers?this._updateTilesWithMultiAnalyze1(l,N,s,m,x,S):2===this.options.multiLayers?this._updateTilesWithMultiAnalyze2(l,N,s,d,m,x,b,_,S,D):3===this.options.multiLayers?this._updateTilesWithMultiAnalyze3(l,N,s,d,f,m,x,b,_,y,v,S,D,I):4===this.options.multiLayers?this._updateTilesWithMultiAnalyze4(l,N,s,d,f,u,m,x,b,_,y,v,T,A,S,D,I,F):5===this.options.multiLayers?this._updateTilesWithMultiAnalyze5(l,N,s,d,f,u,c,m,x,b,_,y,v,T,A,C,E,S,D,I,F,R):6===this.options.multiLayers&&this._updateTilesWithMultiAnalyze6(l,N,s,d,f,u,c,p,m,x,b,_,y,v,T,A,C,E,B,w,S,D,I,F,R,k),this.options.debug&&console.log("Running GLOperations with multiAnalyze")):"diff"===this.options.glOperation&&(this._updateTilesWithDiff(l,s,d),this.options.debug&&console.log("Running GLOperations with diff")),"none"===this.options.contourType?this.options.contourType!==U&&"none"===this.options.contourType&&(this._clearContours(),this._contourData.mergedTileArray=void 0):this.options.contourType!==U&&"none"===U?this._contourData.mergedTileArray?setTimeout(function(){i._calculateAndDrawContours()},50):setTimeout(function(){i._maybeUpdateMergedArrayAndDrawContours()},50):this.options.contourSmoothInput&&(this.options.contourSmoothInput!==X||this.options.contourSmoothInputKernel!==q)?setTimeout(function(){return o(i,void 0,void 0,function(){return n(this,function(e){switch(e.label){case 0:return[4,this._smoothContourInput()];case 1:return e.sent(),this._calculateAndDrawContours(),[2];}})})},50):this.options.contourInterval!==O||this.options.contourIndexInterval!==z||this.options.contourSmoothLines!==W||this.options.contourSmoothInput!==X?setTimeout(function(){i._calculateAndDrawContours()},50):(this.options.contourType!==U||this.options.contourLineColor!==P||this.options.contourLineWeight!==G||this.options.contourLineIndexWeight!==j||this.options.contourIlluminatedHighlightColor!==Y||this.options.contourIlluminatedShadowColor!==Z||this.options.contourIlluminatedShadowSize!==K||this.options.contourHypso!==$||this.options.contourHypsoDomain!==Q||this.options.contourHypsoColors!==J||this.options.contourBathy!==ee||this.options.contourBathyDomain!==te||this.options.contourBathyColors!==oe||this.options.contourBathyShadowColor!==ie||this.options.contourBathyHighlightColor!==ne||this.options.contourIndexLabels!==ae||this.options.contourLabelFont!==re||this.options.contourLabelDistance!==le)&&this._drawContours()},a.prototype.getEvents=function(){var t=this,o=this.options,i=o.onclick,n=o.ondblclick,a=o.onmousedown,r=o.onmouseup,l=o.onmouseover,s=o.onmouseout,d=o.onmousemove,f=o.oncontextmenu,u=Wi({click:i,dblclick:n,mousedown:a,mouseup:r,mouseover:l,mouseout:s,mousemove:d,contextmenu:f},function(e){return!Li(e)});return Qu({},e.GridLayer.prototype.getEvents.call(this),Fi(u,function(e){return e&&t._wrapMouseEventHandler(e)}))},a.prototype.getTileUrl=function(t,o){var i={r:e.Browser.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(i.y=n),i["-y"]=n}return e.Util.template(o,e.Util.extend(i,this.options))},a.prototype.redraw=function(){return this._map&&(this.options.debug&&console.log("redraw() called"),this._removeAllTiles(),this._update()),this},a.prototype.createTile=function(t,o){var i=this,n=this.options,a=n.colorScale,r=n.sentinelValues,l=n.extraPixelLayers,s=n.tileSize,d=n.url,f=n.hsPregenUrl,u=n.operationUrlA,c=n.operationUrlB,p=n.operationUrlC,g=n.operationUrlD,h=n.operationUrlE,m=n.operationUrlF,x=n.filterLowA,b=n.filterHighA,_=n.filterLowB,y=n.filterHighB,v=n.filterLowC,T=n.filterHighC,A=n.filterLowD,C=n.filterHighD,E=n.filterLowE,B=n.filterHighE,w=n.filterLowF,S=n.filterHighF,D=n.multiplierA,I=n.multiplierB,F=n.multiplierC,R=n.multiplierD,k=n.multiplierE,N=n.multiplierF;this.options.debug&&console.log("createTile");var M=e.DomUtil.create("canvas");return Object.assign(M,{className:"gl-tilelayer-tile",width:s,height:s}),"none"===this.options.glOperation?(1===l&&this._fetchTileData(t,u).then(function(e){i.options.debug&&console.log("createTile - extraPixelLayers === 1"),M.pixelDataA=e}),"pregen"===this.options._hillshadeOptions.hillshadeType?Promise.all([this._fetchTileData(t,d),this._fetchTileData(t,f)]).then(function(e){i.options.debug&&console.log("_fetchTileData with pregen hs");var n=e[0],l=e[1],s=i._renderer.renderTileHsPregen({coords:t,pixelData:n},{coords:t,pixelData:l},a,r,i.options._hillshadeOptions),d=s[0],f=s[1];M.pixelData=n,M.pixelDataHsPregen=l,i._copyToTileCanvas(M,d,f),o(void 0,M)}):this._fetchTileData(t,d).then(function(e){i.options.debug&&console.log("_fetchTileData with no operation");var n=i._renderer.renderTile({coords:t,pixelData:e},a,r,i.options._hillshadeOptions,i._getZoomForUrl()),l=n[0],s=n[1];M.pixelData=e,i._copyToTileCanvas(M,l,s),o(void 0,M)})):"diff"===this.options.glOperation?Promise.all([this._fetchTileData(t,u),this._fetchTileData(t,c)]).then(function(e){i.options.debug&&console.log("_fetchTileData with diff");var n=e[0],l=e[1],s=i._renderer.renderTileDiff({coords:t,pixelData:n},{coords:t,pixelData:l},a,r),d=s[0],f=s[1],u=s[2];M.pixelData=u,M.pixelDataA=n,M.pixelDataB=l,i._copyToTileCanvas(M,d,f),o(void 0,M)}):"multi"===this.options.glOperation&&1===this.options.multiLayers?Promise.all([this._fetchTileData(t,u)]).then(function(e){i.options.debug&&console.log("_fetchTileData with multi");var n=e[0],l=i._renderer.renderTileMulti1({coords:t,pixelData:n},a,r,x,b,D),s=l[0],d=l[1],f=l[2];M.pixelData=f,M.pixelDataA=n,i._copyToTileCanvas(M,s,d),o(void 0,M)}):"multi"===this.options.glOperation&&2===this.options.multiLayers?Promise.all([this._fetchTileData(t,u),this._fetchTileData(t,c)]).then(function(e){i.options.debug&&console.log("_fetchTileData with multi");var n=e[0],l=e[1],s=i._renderer.renderTileMulti2({coords:t,pixelData:n},{coords:t,pixelData:l},a,r,x,b,_,y,D,I),d=s[0],f=s[1],u=s[2];M.pixelData=u,M.pixelDataA=n,M.pixelDataB=l,i._copyToTileCanvas(M,d,f),o(void 0,M)}):"multi"===this.options.glOperation&&3===this.options.multiLayers?Promise.all([this._fetchTileData(t,u),this._fetchTileData(t,c),this._fetchTileData(t,p)]).then(function(e){i.options.debug&&console.log("_fetchTileData with multi");var n=e[0],l=e[1],s=e[2],d=i._renderer.renderTileMulti3({coords:t,pixelData:n},{coords:t,pixelData:l},{coords:t,pixelData:s},a,r,x,b,_,y,v,T,D,I,F),f=d[0],u=d[1],c=d[2];M.pixelData=c,M.pixelDataA=n,M.pixelDataB=l,M.pixelDataC=s,i._copyToTileCanvas(M,f,u),o(void 0,M)}):"multi"===this.options.glOperation&&4===this.options.multiLayers?Promise.all([this._fetchTileData(t,u),this._fetchTileData(t,c),this._fetchTileData(t,p),this._fetchTileData(t,g)]).then(function(e){i.options.debug&&console.log("_fetchTileData with multi");var n=e[0],l=e[1],s=e[2],d=e[3],f=i._renderer.renderTileMulti4({coords:t,pixelData:n},{coords:t,pixelData:l},{coords:t,pixelData:s},{coords:t,pixelData:d},a,r,x,b,_,y,v,T,A,C,D,I,F,R),u=f[0],c=f[1],p=f[2];M.pixelData=p,M.pixelDataA=n,M.pixelDataB=l,M.pixelDataC=s,M.pixelDataD=d,i._copyToTileCanvas(M,u,c),o(void 0,M)}):"multi"===this.options.glOperation&&5===this.options.multiLayers?Promise.all([this._fetchTileData(t,u),this._fetchTileData(t,c),this._fetchTileData(t,p),this._fetchTileData(t,g),this._fetchTileData(t,h)]).then(function(e){i.options.debug&&console.log("_fetchTileData with multi");var n=e[0],l=e[1],s=e[2],d=e[3],f=e[4],u=i._renderer.renderTileMulti5({coords:t,pixelData:n},{coords:t,pixelData:l},{coords:t,pixelData:s},{coords:t,pixelData:d},{coords:t,pixelData:f},a,r,x,b,_,y,v,T,A,C,E,B,D,I,F,R,k),c=u[0],p=u[1],g=u[2];M.pixelData=g,M.pixelDataA=n,M.pixelDataB=l,M.pixelDataC=s,M.pixelDataD=d,M.pixelDataE=f,i._copyToTileCanvas(M,c,p),o(void 0,M)}):"multi"===this.options.glOperation&&6===this.options.multiLayers&&Promise.all([this._fetchTileData(t,u),this._fetchTileData(t,c),this._fetchTileData(t,p),this._fetchTileData(t,g),this._fetchTileData(t,h),this._fetchTileData(t,m)]).then(function(e){i.options.debug&&console.log("_fetchTileData with multi");var n=e[0],l=e[1],s=e[2],d=e[3],f=e[4],u=e[5],c=i._renderer.renderTileMulti6({coords:t,pixelData:n},{coords:t,pixelData:l},{coords:t,pixelData:s},{coords:t,pixelData:d},{coords:t,pixelData:f},{coords:t,pixelData:u},a,r,x,b,_,y,v,T,A,C,E,B,w,S,D,I,F,R,k,N),p=c[0],g=c[1],h=c[2];M.pixelData=h,M.pixelDataA=n,M.pixelDataB=l,M.pixelDataC=s,M.pixelDataD=d,M.pixelDataE=f,M.pixelDataF=u,i._copyToTileCanvas(M,p,g),o(void 0,M)}),M},a.prototype._checkColorScaleAndSentinels=function(){var e=this.options,t=e.colorScale,o=e.sentinelValues,i=e.colorscaleMaxLength,n=e.sentinelMaxLength;if(0===t.length&&0===o.length)throw new Error("Either `colorScale` or `sentinelValues` must be of non-zero length.");if(t.length>i)throw new Error("Color scale length "+t.length+" exceeds the maximum, "+i+".");if(o.length>n)throw new Error("Sentinel values length "+o.length+" exceeds the maximum, "+n+".")},a.prototype._getSubdomain=function(e){var t=Gu(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},a.prototype._getZoomForUrl=function(){var e=this.options,t=e.maxZoom,o=e.zoomReverse,i=e.zoomOffset,n=this._tileZoom,a=o?t-n:n;return a+i},a.prototype._onTileRemove=function(t){var o=t.coords,i=t.tile;this.options.debug&&console.log("_onTileRemove()"),e.Browser.android||(i.onload=O),this._renderer.removeTile(o)},a.prototype._updateTiles=function(){return o(this,void 0,void 0,function(){var e=this,t,o,i,a,r,l,s,d;return n(this,function(n){switch(n.label){case 0:return t=this._getActiveTiles(),[4,this._getTilesData(t)];case 1:return o=n.sent(),this.options.debug&&console.log("_updateTiles() with url "+this.options.url),i=this.options,a=i.colorScale,r=i.sentinelValues,l=void 0===r?[]:r,"pregen"===this.options._hillshadeOptions.hillshadeType?[4,this._getTilesData(t,this.options.hsPregenUrl)]:[3,3];case 2:return d=n.sent(),s=this._renderer.renderTilesHsPregen(o,d,a,l,this.options._hillshadeOptions),[3,4];case 3:s=this._renderer.renderTiles(o,a,l,this.options._hillshadeOptions,this._getZoomForUrl()),n.label=4;case 4:return s.forEach(function(i,n){var a=i[0],r=i[1],l=t[n];e._copyToTileCanvas(l.el,a,r),l.el.pixelData=o[n].pixelData,"pregen"===e.options._hillshadeOptions.hillshadeType&&(l.el.pixelDataHsPregen=d[n].pixelData)}),[2];}})})},a.prototype._updateTilesColorscaleOnly=function(){return o(this,void 0,void 0,function(){var e=this,t,o,i,a,r,l,s,d,l,d;return n(this,function(){return this.options.debug&&console.log("_updateTilesColorscaleOnly()"),t=this._getActiveTiles(),o=this.options,i=o.colorScale,a=o.sentinelValues,r=void 0===a?[]:a,"pregen"===this.options._hillshadeOptions.hillshadeType?(l=t.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),s=t.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataHsPregen}}),d=this._renderer.renderTilesHsPregen(l,s,i,r,this.options._hillshadeOptions),d.forEach(function(o,i){var n=o[0],a=o[1],r=t[i];e._copyToTileCanvas(r.el,n,a)})):(l=t.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),d=this._renderer.renderTiles(l,i,r,this.options._hillshadeOptions,this._getZoomForUrl()),d.forEach(function(o,i){var n=o[0],a=o[1],r=t[i];e._copyToTileCanvas(r.el,n,a)})),[2]})})},a.prototype._updateTilesWithTransitions=function(e,t){return o(this,void 0,void 0,function(){var o=this,i,a,r,l,s,d,f,u,c;return n(this,function(n){switch(n.label){case 0:return this.options.debug&&console.log("_updateTilesWithTransitions()"),i=this._getActiveTiles(),a=i.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),[4,this._getTilesData(i)];case 1:return r=n.sent(),i.forEach(function(e,t){e.el.pixelData=r[t].pixelData}),l=this.options,s=l.colorScale,d=l.sentinelValues,f=void 0===d?[]:d,u=l.transitionTimeMs,c=function(e){e.forEach(function(e,t){var n=e[0],a=e[1],r=i[t];o._copyToTileCanvas(r.el,n,a)})},JSON.stringify(s)===JSON.stringify(e)&&JSON.stringify(f)===JSON.stringify(t)?this._renderer.renderTilesWithTransition(a,r,s,f,u,c):this._renderer.renderTilesWithTransitionAndNewColorScale(a,r,e,s,t,f,u,c),[2];}})})},a.prototype._updateColorscaleWithTransitions=function(e,t){return o(this,void 0,void 0,function(){var o=this,i,a,r,l,s,d,f,u;return n(this,function(){return this.options.debug&&console.log("_updateColorscaleWithTransitions()"),i=this._getActiveTiles(),a=i.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),r=this.options,l=r.colorScale,s=r.sentinelValues,d=void 0===s?[]:s,f=r.transitionTimeMs,u=function(e){e.forEach(function(e,t){var n=e[0],a=e[1],r=i[t];o._copyToTileCanvas(r.el,n,a)})},(JSON.stringify(l)!==JSON.stringify(e)||JSON.stringify(d)!==JSON.stringify(t))&&this._renderer.renderTilesWithTransitionAndNewColorScaleOnly(a,e,l,t,d,f,u),[2]})})},a.prototype._updateTilesWithDiff=function(e,t,i){return o(this,void 0,void 0,function(){var o=this,a,r,l,s,d,f,u,c,p,g;return n(this,function(n){switch(n.label){case 0:return(this.options.debug&&console.log("_updateTilesWithDiff()"),a=this._getActiveTiles(),r=[],l=[],this.options.glOperation!==e||this.options.operationUrlA!==t||this.options.operationUrlB!==i)?[3,1]:(this.options.debug&&console.log("_updateTilesWithDiff: both same url. Getting data from existing result"),r=a.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),[3,7]);case 1:return this.options.operationUrlA===t?[3,3]:(this.options.debug&&console.log("_updateTilesWithDiff: new A url. Downloading new tiles"),[4,this._getTilesData(a,this.options.operationUrlA)]);case 2:return r=n.sent(),a.forEach(function(e,t){e.el.pixelDataA=r[t].pixelData}),[3,4];case 3:this.options.debug&&console.log("_updateTilesWithDiff: same A url. Getting data from existing tiles"),r=a.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataA}}),n.label=4;case 4:return this.options.operationUrlB===i?[3,6]:(this.options.debug&&console.log("_updateTilesWithDiff: new B url. Downloading new tiles"),[4,this._getTilesData(a,this.options.operationUrlB)]);case 5:return l=n.sent(),a.forEach(function(e,t){e.el.pixelDataB=l[t].pixelData}),[3,7];case 6:this.options.debug&&console.log("_updateTilesWithDiff: same B url. Getting data from existing tiles"),l=a.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataB}}),n.label=7;case 7:return s=this.options,d=s.colorScale,f=s.sentinelValues,u=void 0===f?[]:f,this.options.glOperation===e&&this.options.operationUrlA===t&&this.options.operationUrlB===i?(this.options.debug&&console.log("_updateTilesWithDiff: both same urls. Running renderTiles()"),c=this._renderer.renderTiles(r,d,u,this.options._hillshadeOptions),c.forEach(function(e,t){var i=e[0],n=e[1],r=a[t];o._copyToTileCanvas(r.el,i,n)})):(this.options.debug&&console.log("_updateTilesWithDiff: not same urls. Running renderTilesWithDiff()"),p=function(e){e.forEach(function(e,t){var i=e[0],n=e[1],r=a[t];o._copyToTileCanvas(r.el,i,n)})},g=this._renderer.renderTilesWithDiff(r,l,d,u,p),a.forEach(function(e,t){e.el.pixelData=g[t]})),[2];}})})},a.prototype._updateTilesWithMultiAnalyze1=function(e,t,i,a,r,l){return o(this,void 0,void 0,function(){var o=this,s,d,f,u,c,p,g,h,m,x;return n(this,function(n){switch(n.label){case 0:return(this.options.debug&&console.log("_updateTilesWithMultiAnalyze1()"),s=this._getActiveTiles(),d=this.options,f=d.colorScale,u=d.sentinelValues,c=void 0===u?[]:u,this.options.glOperation!==e||this.options.operationUrlA!==i||this.options.filterLowA!==a||this.options.filterHighA!==r||this.options.multiplierA!==l||this.options.multiLayers!==t)?[3,1]:(this.options.debug&&console.log("_updateTilesWithMultiAnalyze1: all same urls. Fetching from existing tiles. Running renderTiles()"),p=s.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),g=this._renderer.renderTiles(p,f,c,this.options._hillshadeOptions),g.forEach(function(e,t){var i=e[0],n=e[1],a=s[t];o._copyToTileCanvas(a.el,i,n)}),[3,5]);case 1:return h=[],this.options.operationUrlA===i?[3,3]:[4,this._getTilesData(s,this.options.operationUrlA)];case 2:return h=n.sent(),s.forEach(function(e,t){e.el.pixelDataA=h[t].pixelData}),[3,4];case 3:h=s.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataA}}),n.label=4;case 4:m=function(e){e.forEach(function(e,t){var i=e[0],n=e[1],a=s[t];o._copyToTileCanvas(a.el,i,n)})},x=this._renderer.renderTilesWithMultiAnalyze1(h,f,c,this.options.filterLowA,this.options.filterHighA,this.options.multiplierA,m),s.forEach(function(e,t){e.el.pixelData=x[t]}),n.label=5;case 5:return[2];}})})},a.prototype._updateTilesWithMultiAnalyze2=function(e,t,i,a,r,l,s,d,f,u){return o(this,void 0,void 0,function(){var o=this,c,p,g,h,m,x,b,_,y,v,T;return n(this,function(n){switch(n.label){case 0:return(this.options.debug&&console.log("_updateTilesWithMultiAnalyze2()"),c=this._getActiveTiles(),p=this.options,g=p.colorScale,h=p.sentinelValues,m=void 0===h?[]:h,this.options.glOperation!==e||this.options.operationUrlA!==i||this.options.operationUrlB!==a||this.options.filterLowA!==r||this.options.filterHighA!==l||this.options.filterLowB!==s||this.options.filterHighB!==d||this.options.multiplierA!==f||this.options.multiplierB!==u||this.options.multiLayers!==t)?[3,1]:(this.options.debug&&console.log("_updateTilesWithMultiAnalyze2: all same urls. Fetching from existing tiles. Running renderTiles()"),x=c.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),b=this._renderer.renderTiles(x,g,m,this.options._hillshadeOptions),b.forEach(function(e,t){var i=e[0],n=e[1],a=c[t];o._copyToTileCanvas(a.el,i,n)}),[3,8]);case 1:return _=[],y=[],this.options.operationUrlA===i?[3,3]:[4,this._getTilesData(c,this.options.operationUrlA)];case 2:return _=n.sent(),c.forEach(function(e,t){e.el.pixelDataA=_[t].pixelData}),[3,4];case 3:_=c.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataA}}),n.label=4;case 4:return this.options.operationUrlB===a?[3,6]:[4,this._getTilesData(c,this.options.operationUrlB)];case 5:return y=n.sent(),c.forEach(function(e,t){e.el.pixelDataB=y[t].pixelData}),[3,7];case 6:y=c.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataB}}),n.label=7;case 7:v=function(e){e.forEach(function(e,t){var i=e[0],n=e[1],a=c[t];o._copyToTileCanvas(a.el,i,n)})},T=this._renderer.renderTilesWithMultiAnalyze2(_,y,g,m,this.options.filterLowA,this.options.filterHighA,this.options.filterLowB,this.options.filterHighB,this.options.multiplierA,this.options.multiplierB,v),c.forEach(function(e,t){e.el.pixelData=T[t]}),n.label=8;case 8:return[2];}})})},a.prototype._updateTilesWithMultiAnalyze3=function(e,t,i,a,r,l,s,d,f,u,c,p,g,h){return o(this,void 0,void 0,function(){var o=this,m,x,b,_,y,v,T,A,C,E,B,w;return n(this,function(n){switch(n.label){case 0:return(this.options.debug&&console.log("_updateTilesWithMultiAnalyze3()"),m=this._getActiveTiles(),x=this.options,b=x.colorScale,_=x.sentinelValues,y=void 0===_?[]:_,this.options.glOperation!==e||this.options.operationUrlA!==i||this.options.operationUrlB!==a||this.options.operationUrlC!==r||this.options.filterLowA!==l||this.options.filterHighA!==s||this.options.filterLowB!==d||this.options.filterHighB!==f||this.options.filterLowC!==u||this.options.filterHighC!==c||this.options.multiplierA!==p||this.options.multiplierB!==g||this.options.multiplierC!==h||this.options.multiLayers!==t)?[3,1]:(this.options.debug&&console.log("_updateTilesWithMultiAnalyze3: all same urls. Fetching from existing tiles. Running renderTiles()"),v=m.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),T=this._renderer.renderTiles(v,b,y,this.options._hillshadeOptions),T.forEach(function(e,t){var i=e[0],n=e[1],a=m[t];o._copyToTileCanvas(a.el,i,n)}),[3,11]);case 1:return A=[],C=[],E=[],this.options.operationUrlA===i?[3,3]:[4,this._getTilesData(m,this.options.operationUrlA)];case 2:return A=n.sent(),m.forEach(function(e,t){e.el.pixelDataA=A[t].pixelData}),[3,4];case 3:A=m.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataA}}),n.label=4;case 4:return this.options.operationUrlB===a?[3,6]:[4,this._getTilesData(m,this.options.operationUrlB)];case 5:return C=n.sent(),m.forEach(function(e,t){e.el.pixelDataB=C[t].pixelData}),[3,7];case 6:C=m.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataB}}),n.label=7;case 7:return this.options.operationUrlC===r?[3,9]:[4,this._getTilesData(m,this.options.operationUrlC)];case 8:return E=n.sent(),m.forEach(function(e,t){e.el.pixelDataC=E[t].pixelData}),[3,10];case 9:E=m.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataC}}),n.label=10;case 10:B=function(e){e.forEach(function(e,t){var i=e[0],n=e[1],a=m[t];o._copyToTileCanvas(a.el,i,n)})},w=this._renderer.renderTilesWithMultiAnalyze3(A,C,E,b,y,this.options.filterLowA,this.options.filterHighA,this.options.filterLowB,this.options.filterHighB,this.options.filterLowC,this.options.filterHighC,this.options.multiplierA,this.options.multiplierB,this.options.multiplierC,B),m.forEach(function(e,t){e.el.pixelData=w[t]}),n.label=11;case 11:return[2];}})})},a.prototype._updateTilesWithMultiAnalyze4=function(e,t,i,a,r,l,s,d,f,u,c,p,g,h,m,x,b,_){return o(this,void 0,void 0,function(){var o=this,y,v,T,A,C,E,B,w,S,D,I,F,R;return n(this,function(n){switch(n.label){case 0:return(this.options.debug&&console.log("_updateTilesWithMultiAnalyze4()"),y=this._getActiveTiles(),v=this.options,T=v.colorScale,A=v.sentinelValues,C=void 0===A?[]:A,this.options.glOperation!==e||this.options.operationUrlA!==i||this.options.operationUrlB!==a||this.options.operationUrlC!==r||this.options.operationUrlD!==l||this.options.filterLowA!==s||this.options.filterHighA!==d||this.options.filterLowB!==f||this.options.filterHighB!==u||this.options.filterLowC!==c||this.options.filterHighC!==p||this.options.filterLowD!==g||this.options.filterHighD!==h||this.options.multiplierA!==m||this.options.multiplierB!==x||this.options.multiplierC!==b||this.options.multiplierD!==_||this.options.multiLayers!==t)?[3,1]:(this.options.debug&&console.log("_updateTilesWithMultiAnalyze4: all same urls. Fetching from existing tiles. Running renderTiles()"),E=y.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),B=this._renderer.renderTiles(E,T,C,this.options._hillshadeOptions),B.forEach(function(e,t){var i=e[0],n=e[1],a=y[t];o._copyToTileCanvas(a.el,i,n)}),[3,14]);case 1:return w=[],S=[],D=[],I=[],this.options.operationUrlA===i?[3,3]:[4,this._getTilesData(y,this.options.operationUrlA)];case 2:return w=n.sent(),y.forEach(function(e,t){e.el.pixelDataA=w[t].pixelData}),[3,4];case 3:w=y.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataA}}),n.label=4;case 4:return this.options.operationUrlB===a?[3,6]:[4,this._getTilesData(y,this.options.operationUrlB)];case 5:return S=n.sent(),y.forEach(function(e,t){e.el.pixelDataB=S[t].pixelData}),[3,7];case 6:S=y.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataB}}),n.label=7;case 7:return this.options.operationUrlC===r?[3,9]:[4,this._getTilesData(y,this.options.operationUrlC)];case 8:return D=n.sent(),y.forEach(function(e,t){e.el.pixelDataC=D[t].pixelData}),[3,10];case 9:D=y.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataC}}),n.label=10;case 10:return this.options.operationUrlD===l?[3,12]:[4,this._getTilesData(y,this.options.operationUrlD)];case 11:return I=n.sent(),y.forEach(function(e,t){e.el.pixelDataD=I[t].pixelData}),[3,13];case 12:I=y.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataD}}),n.label=13;case 13:F=function(e){e.forEach(function(e,t){var i=e[0],n=e[1],a=y[t];o._copyToTileCanvas(a.el,i,n)})},R=this._renderer.renderTilesWithMultiAnalyze4(w,S,D,I,T,C,this.options.filterLowA,this.options.filterHighA,this.options.filterLowB,this.options.filterHighB,this.options.filterLowC,this.options.filterHighC,this.options.filterLowD,this.options.filterHighD,this.options.multiplierA,this.options.multiplierB,this.options.multiplierC,this.options.multiplierD,F),y.forEach(function(e,t){e.el.pixelData=R[t]}),n.label=14;case 14:return[2];}})})},a.prototype._updateTilesWithMultiAnalyze5=function(e,t,i,a,r,l,s,d,f,u,c,p,g,h,m,x,b,_,y,v,T,A){return o(this,void 0,void 0,function(){var o=this,C,E,B,w,S,D,I,F,R,k,N,M,H,V;return n(this,function(n){switch(n.label){case 0:return(this.options.debug&&console.log("_updateTilesWithMultiAnalyze5()"),C=this._getActiveTiles(),E=this.options,B=E.colorScale,w=E.sentinelValues,S=void 0===w?[]:w,this.options.glOperation!==e||this.options.operationUrlA!==i||this.options.operationUrlB!==a||this.options.operationUrlC!==r||this.options.operationUrlD!==l||this.options.operationUrlE!==s||this.options.filterLowA!==d||this.options.filterHighA!==f||this.options.filterLowB!==u||this.options.filterHighB!==c||this.options.filterLowC!==p||this.options.filterHighC!==g||this.options.filterLowD!==h||this.options.filterHighD!==m||this.options.filterLowE!==x||this.options.filterHighE!==b||this.options.multiplierA!==_||this.options.multiplierB!==y||this.options.multiplierC!==v||this.options.multiplierD!==T||this.options.multiplierE!==A||this.options.multiLayers!==t)?[3,1]:(this.options.debug&&console.log("_updateTilesWithMultiAnalyze5: all same urls. Fetching from existing tiles. Running renderTiles()"),D=C.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),I=this._renderer.renderTiles(D,B,S,this.options._hillshadeOptions),I.forEach(function(e,t){var i=e[0],n=e[1],a=C[t];o._copyToTileCanvas(a.el,i,n)}),[3,17]);case 1:return F=[],R=[],k=[],N=[],M=[],this.options.operationUrlA===i?[3,3]:[4,this._getTilesData(C,this.options.operationUrlA)];case 2:return F=n.sent(),C.forEach(function(e,t){e.el.pixelDataA=F[t].pixelData}),[3,4];case 3:F=C.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataA}}),n.label=4;case 4:return this.options.operationUrlB===a?[3,6]:[4,this._getTilesData(C,this.options.operationUrlB)];case 5:return R=n.sent(),C.forEach(function(e,t){e.el.pixelDataB=R[t].pixelData}),[3,7];case 6:R=C.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataB}}),n.label=7;case 7:return this.options.operationUrlC===r?[3,9]:[4,this._getTilesData(C,this.options.operationUrlC)];case 8:return k=n.sent(),C.forEach(function(e,t){e.el.pixelDataC=k[t].pixelData}),[3,10];case 9:k=C.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataC}}),n.label=10;case 10:return this.options.operationUrlD===l?[3,12]:[4,this._getTilesData(C,this.options.operationUrlD)];case 11:return N=n.sent(),C.forEach(function(e,t){e.el.pixelDataD=N[t].pixelData}),[3,13];case 12:N=C.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataD}}),n.label=13;case 13:return this.options.operationUrlE===s?[3,15]:[4,this._getTilesData(C,this.options.operationUrlE)];case 14:return M=n.sent(),C.forEach(function(e,t){e.el.pixelDataE=M[t].pixelData}),[3,16];case 15:M=C.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataE}}),n.label=16;case 16:H=function(e){e.forEach(function(e,t){var i=e[0],n=e[1],a=C[t];o._copyToTileCanvas(a.el,i,n)})},V=this._renderer.renderTilesWithMultiAnalyze5(F,R,k,N,M,B,S,this.options.filterLowA,this.options.filterHighA,this.options.filterLowB,this.options.filterHighB,this.options.filterLowC,this.options.filterHighC,this.options.filterLowD,this.options.filterHighD,this.options.filterLowE,this.options.filterHighE,this.options.multiplierA,this.options.multiplierB,this.options.multiplierC,this.options.multiplierD,this.options.multiplierE,H),C.forEach(function(e,t){e.el.pixelData=V[t]}),n.label=17;case 17:return[2];}})})},a.prototype._updateTilesWithMultiAnalyze6=function(e,t,i,a,r,l,s,d,f,u,c,p,g,h,m,x,b,_,y,v,T,A,C,E,B,w){return o(this,void 0,void 0,function(){var o=this,S,D,I,F,R,k,N,M,H,V,O,z,P,G,j;return n(this,function(n){switch(n.label){case 0:return(this.options.debug&&console.log("_updateTilesWithMultiAnalyze6()"),S=this._getActiveTiles(),D=this.options,I=D.colorScale,F=D.sentinelValues,R=void 0===F?[]:F,this.options.glOperation!==e||this.options.operationUrlA!==i||this.options.operationUrlB!==a||this.options.operationUrlC!==r||this.options.operationUrlD!==l||this.options.operationUrlE!==s||this.options.operationUrlF!==d||this.options.filterLowA!==f||this.options.filterHighA!==u||this.options.filterLowB!==c||this.options.filterHighB!==p||this.options.filterLowC!==g||this.options.filterHighC!==h||this.options.filterLowD!==m||this.options.filterHighD!==x||this.options.filterLowE!==b||this.options.filterHighE!==_||this.options.filterLowF!==y||this.options.filterHighF!==v||this.options.multiplierA!==T||this.options.multiplierB!==A||this.options.multiplierC!==C||this.options.multiplierD!==E||this.options.multiplierE!==B||this.options.multiplierF!==w||this.options.multiLayers!==t)?[3,1]:(this.options.debug&&console.log("_updateTilesWithMultiAnalyze6: all same urls. Fetching from existing tiles. Running renderTiles()"),k=S.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelData}}),N=this._renderer.renderTiles(k,I,R,this.options._hillshadeOptions),N.forEach(function(e,t){var i=e[0],n=e[1],a=S[t];o._copyToTileCanvas(a.el,i,n)}),[3,20]);case 1:return M=[],H=[],V=[],O=[],z=[],P=[],this.options.operationUrlA===i?[3,3]:[4,this._getTilesData(S,this.options.operationUrlA)];case 2:return M=n.sent(),S.forEach(function(e,t){e.el.pixelDataA=M[t].pixelData}),[3,4];case 3:M=S.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataA}}),n.label=4;case 4:return this.options.operationUrlB===a?[3,6]:[4,this._getTilesData(S,this.options.operationUrlB)];case 5:return H=n.sent(),S.forEach(function(e,t){e.el.pixelDataB=H[t].pixelData}),[3,7];case 6:H=S.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataB}}),n.label=7;case 7:return this.options.operationUrlC===r?[3,9]:[4,this._getTilesData(S,this.options.operationUrlC)];case 8:return V=n.sent(),S.forEach(function(e,t){e.el.pixelDataC=V[t].pixelData}),[3,10];case 9:V=S.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataC}}),n.label=10;case 10:return this.options.operationUrlD===l?[3,12]:[4,this._getTilesData(S,this.options.operationUrlD)];case 11:return O=n.sent(),S.forEach(function(e,t){e.el.pixelDataD=O[t].pixelData}),[3,13];case 12:O=S.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataD}}),n.label=13;case 13:return this.options.operationUrlE===s?[3,15]:[4,this._getTilesData(S,this.options.operationUrlE)];case 14:return z=n.sent(),S.forEach(function(e,t){e.el.pixelDataE=z[t].pixelData}),[3,16];case 15:z=S.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataE}}),n.label=16;case 16:return this.options.operationUrlF===d?[3,18]:[4,this._getTilesData(S,this.options.operationUrlF)];case 17:return P=n.sent(),S.forEach(function(e,t){e.el.pixelDataF=P[t].pixelData}),[3,19];case 18:P=S.map(function(e){var t=e.coords,o=e.el;return{coords:t,pixelData:o.pixelDataF}}),n.label=19;case 19:G=function(e){e.forEach(function(e,t){var i=e[0],n=e[1],a=S[t];o._copyToTileCanvas(a.el,i,n)})},j=this._renderer.renderTilesWithMultiAnalyze6(M,H,V,O,z,P,I,R,this.options.filterLowA,this.options.filterHighA,this.options.filterLowB,this.options.filterHighB,this.options.filterLowC,this.options.filterHighC,this.options.filterLowD,this.options.filterHighD,this.options.filterLowE,this.options.filterHighE,this.options.filterLowF,this.options.filterHighF,this.options.multiplierA,this.options.multiplierB,this.options.multiplierC,this.options.multiplierD,this.options.multiplierE,this.options.multiplierF,G),S.forEach(function(e,t){e.el.pixelData=j[t]}),n.label=20;case 20:return[2];}})})},a.prototype._maybePreload=function(e){e&&(!this._preloadTileCache||this._preloadTileCache.url!==e)&&this._preloadTiles(e)},a.prototype._maybeLoadExtraLayers=function(e,t,i,a){return o(this,void 0,void 0,function(){var o,r,l,s,d;return n(this,function(n){switch(n.label){case 0:return(o=[],!(1<=this.options.extraPixelLayers))?[3,2]:(o=this._getActiveTiles(),e===this.options.operationUrlA?[3,2]:[4,this._getTilesData(o,this.options.operationUrlA)]);case 1:r=n.sent(),o.forEach(function(e,t){e.el.pixelDataA=r[t].pixelData}),n.label=2;case 2:return 2<=this.options.extraPixelLayers?t===this.options.operationUrlB?[3,4]:[4,this._getTilesData(o,this.options.operationUrlB)]:[3,4];case 3:l=n.sent(),o.forEach(function(e,t){e.el.pixelDataB=l[t].pixelData}),n.label=4;case 4:return 3<=this.options.extraPixelLayers?i===this.options.operationUrlC?[3,6]:[4,this._getTilesData(o,this.options.operationUrlC)]:[3,6];case 5:s=n.sent(),o.forEach(function(e,t){e.el.pixelDataC=s[t].pixelData}),n.label=6;case 6:return 4<=this.options.extraPixelLayers?a===this.options.operationUrlD?[3,8]:[4,this._getTilesData(o,this.options.operationUrlD)]:[3,8];case 7:d=n.sent(),o.forEach(function(e,t){e.el.pixelDataD=d[t].pixelData}),n.label=8;case 8:return[2];}})})},a.prototype._preloadTiles=function(e){return o(this,void 0,void 0,function(){var t,o;return n(this,function(i){switch(i.label){case 0:return t=this._getActiveTiles(),[4,this._fetchTilesData(t,e)];case 1:return o=i.sent(),this._preloadTileCache={url:e,tiles:o},[2];}})})},a.prototype._getActiveTiles=function(){this.options.debug&&console.log("_getActiveTiles()"),this._pruneTiles();var e=lr(this._tiles);return _i(e).sort(function(e,t){return ar(e.coords,t.coords)})},a.prototype._getTilesData=function(e,t){return void 0===t&&(t=this.options.url),o(this,void 0,void 0,function(){var o;return n(this,function(){return this.options.debug&&console.log("_getTilesData() with url: "+t),o=this._preloadTileCache,o&&t===o.url&&rr(o.tiles.map(function(e){var t=e.coords;return t}),e.map(function(e){var t=e.coords;return t}))?(this._preloadTileCache=void 0,[2,Promise.resolve(o.tiles)]):[2,this._fetchTilesData(e,t)]})})},a.prototype._fetchTilesData=function(e,t){return o(this,void 0,void 0,function(){var o=this,i;return n(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(e){var i=e.coords;return o._fetchTileData(i,t)}))];case 1:return i=n.sent(),this.options.debug&&console.log("_fetchTilesData() with url:"+t),this.fire("load",{url:t}),[2,Zb(e,i,function(e,t){var o=e.coords;return{coords:o,pixelData:t}})];}})})},a.prototype._fetchTileData=function(e,t){return tr(this.getTileUrl(e,t),this.options.nodataValue,this._tileSizeAsNumber())},a.prototype._tileSizeAsNumber=function(){var e=this.options.tileSize;return"number"==typeof e?e:e.x},a.prototype._copyToTileCanvas=function(e,t,o){this.options.debug&&console.log("_copyToTileCanvas()");var i=this._tileSizeAsNumber(),n=e.getContext("2d");if(null===n)throw new Error("Tile canvas 2D context is null.");n.clearRect(0,0,i,i),n.drawImage(this._renderer.canvas,t,o,i,i,0,0,i,i)},a.prototype._getActivetilesBounds=function(){return o(this,void 0,void 0,function(){var e,t,o,i,a,r,l,s;return n(this,function(){return e=this._getActiveTiles(),t=e[0].coords.x,o=e[0].coords.x,i=e[0].coords.y,a=e[0].coords.y,e.forEach(function(e){e.coords.x>o&&(o=e.coords.x),e.coords.x<t&&(t=e.coords.x),e.coords.y>a&&(a=e.coords.y),e.coords.y<i&&(i=e.coords.y)}),r=o-t+1,l=a-i+1,s={xMin:t,xMax:o,yMin:i,yMax:a,xTiles:r,yTiles:l},[2,s]})})},a.prototype._mergePixelData=function(e,t){return o(this,void 0,void 0,function(){var o,a,r,l,s,d,f,u,c,p,g,h,m,b,_,v,T,A;return n(this,function(){for(this.options.debug&&console.log("_mergePixelData()"),o=this._tileZoom,a=document.createElement("canvas"),this._contourData.width=e.xTiles*t,this._contourData.height=e.yTiles*t,a.width=this._contourData.width,a.height=this._contourData.height,r=a.getContext("2d"),l=Ry(this.options.nodataValue,t),s=0;s<=e.xTiles;s++)for(d=e.xMin+s,f=0;f<=e.yTiles;f++){u=e.yMin+f,c=void 0;try{p=this._tiles[d+":"+u+":"+o].el,c=p.pixelData}catch(e){c=l}g=new Uint8ClampedArray(c),h=new Uint8ClampedArray(g.buffer,0,4*t*t),m=new ImageData(h,t,t),r.putImageData(m,s*t,f*t)}if(b=r.getImageData(0,0,e.xTiles*t,e.yTiles*t),_=new Float32Array(b.data.buffer),_=_.map(function(e){return-9e5>e&&(e=NaN),e},this),v=Array.from(_),T=function(e){return e.reduce(function(e,t){return(isNaN(e)?0:e)+(isNaN(t)?0:t)},0)},this.options.debug&&(console.log("sum mergedPixelArray"),console.log(T(v))),this.options.contourCanvas)A=this.options.contourCanvas,A.width=this._contourData.width,A.height=this._contourData.height;else return console.log("Error: contourCanvas not specified."),[2];return this._contourData.mergedTileArray=v,this._contourData.smoothedTileArray=void 0,[2]})})},a.prototype._maybeUpdateMergedArrayAndDrawContours=function(){return o(this,void 0,void 0,function(){var e=this;return n(this,function(t){switch(t.label){case 0:return"none"===this.options.contourType?[2]:(this._map.fire("contourDrawing",{status:!0}),this.options.debug&&console.log("_maybeUpdateMergedArrayAndDrawContours()"),[4,this._clearContours()]);case 1:return t.sent(),setTimeout(function(){return o(e,void 0,void 0,function(){var e,t;return n(this,function(o){switch(o.label){case 0:return[4,this._getActivetilesBounds()];case 1:return e=o.sent(),t=this._tileSizeAsNumber(),[4,this._mergePixelData(e,t)];case 2:return o.sent(),this.options.contourSmoothInput?[4,this._smoothContourInput()]:[3,4];case 3:o.sent(),o.label=4;case 4:return[4,this._calculateAndDrawContours()];case 5:return o.sent(),[4,this._moveContourCanvas(e)];case 6:return o.sent(),[2];}})})},50),[2];}})})},a.prototype._smoothContourInput=function(){return o(this,void 0,void 0,function(){var e,t,o,i,a,r,l;return n(this,function(){for(this.options.debug&&console.log("_smoothContourInput()"),e=this._contourData.mergedTileArray,t=e.map(function(e){return isNaN(e)&&(e=this.options.nodataValue),e},this),o=new Uint8Array(Float32Array.from(t).buffer),i=this._renderer.renderConvolutionSmooth(o,this._contourData.width,this._contourData.height,this.options.contourSmoothInputKernel),a=[],r=0;r<i.length;r+=1)l=i[r],l===this.options.nodataValue&&(l=NaN),a.push(l);return this._contourData.smoothedTileArray=a,[2]})})},a.prototype._calculateAndDrawContours=function(){return o(this,void 0,void 0,function(){var e=this;return n(this,function(t){switch(t.label){case 0:return"none"===this.options.contourType?[2]:(this._map.fire("contourDrawing",{status:!0}),this.options.debug&&console.log("_calculateAndDrawContours()"),[4,this._clearContours()]);case 1:return t.sent(),[4,this._calculateContours()];case 2:return t.sent(),setTimeout(function(){e._drawContours()},50),[2];}})})},a.prototype._addlabel=function(e,t,o,i){e.save(),e.translate(t.xy[0],t.xy[1]),e.rotate(t.angle+(0>Vu(t.angle)?Mu:0)),e.textAlign="center",e.fillStyle=o,e.font=i,e.fillText(t.text,-1,4),e.restore()},a.prototype._calculateContours=function(){return o(this,void 0,void 0,function(){var e=this,t,o,a,r,l,s,d;return n(this,function(){for(this.options.debug&&console.log("_calculateContours()"),t=this.options.contourSmoothInput?this._contourData.smoothedTileArray:this._contourData.mergedTileArray,1!==this.options.contourScaleFactor&&(t=t.map(function(t){return t*e.options.contourScaleFactor})),this.options.debug&&(console.log("valuesArray"),console.log(t)),o=JA.max(t,function(t){return t===e.options.nodataValue?NaN:t}),a=JA.min(t,function(t){return t===e.options.nodataValue?NaN:t}),o=Yu(o/this.options.contourInterval)*this.options.contourInterval,a=Xu(a/this.options.contourInterval)*this.options.contourInterval,this.options.debug&&(console.log("Contours: max"),console.log(o)),this.options.debug&&(console.log("Contours: min"),console.log(a)),r=[],l=a;l<=o;l+=this.options.contourInterval)r.push(l);return this.options.debug&&(console.log("Contour thresholds"),console.log(r)),s=JA.contours().size([this._contourData.width,this._contourData.height]),s.thresholds(r),s.smooth(this.options.contourSmoothLines),d=s(t),this._contourData.contoursGeoData=d,this.options.debug&&(console.log("contoursGeoData"),console.log(d)),[2]})})},a.prototype._clearContours=function(){return o(this,void 0,void 0,function(){var e,t;return n(this,function(){if(this.options.debug&&console.log("_clearContours()"),this.options.contourCanvas)e=this.options.contourCanvas,t=e.getContext("2d");else return console.log("Error: contourCanvas not specified."),[2];return t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this._contourData.width,this._contourData.height),t.beginPath(),[2]})})},a.prototype._moveContourCanvas=function(t){return o(this,void 0,void 0,function(){var o,i,a,r,l,s;return n(this,function(){if(this.options.debug&&console.log("_moveContourCanvas()"),this.options.contourCanvas)o=this.options.contourCanvas;else return console.log("Error: contourCanvas not specified."),[2];if(this.options.contourPane)i=this.options.contourPane;else return console.log("Error: contourPane not specified."),[2];return a=this._map.getZoomScale(this._map.getZoom(),this._level.zoom),r=this._map.getPixelOrigin(),l=this._level.origin.multiplyBy(a).subtract(r),s=this._getTilePos(this._keyToTileCoords(t.xMin+":"+t.yMin+":"+this._level.zoom)),e.DomUtil.setTransform(i,l,a),e.DomUtil.setTransform(o,s),[2]})})},a.prototype._drawContours=function(){return o(this,void 0,void 0,function(){var e=this,t,o,i,a,r,l,s,d,f,u,g,h,m,x,p,b;return n(this,function(){if(this.options.debug&&console.log("_drawContours()"),t=this._contourData.width,o=this._contourData.height,this.options.contourCanvas)i=this.options.contourCanvas,a=i.getContext("2d");else return console.log("Error: contourCanvas not specified."),[2];if(r=JA.geoPath().context(a),l=JA.scaleLinear().domain(this.options.contourBathyDomain).range(this.options.contourBathyColors),s=JA.scaleLinear().domain(this.options.contourHypsoDomain).range(this.options.contourHypsoColors).interpolate(JA.interpolateHcl),d=this._contourData.contoursGeoData,f=this.options.contourIndexInterval,u=this.options.contourBathyDomain[this.options.contourBathyDomain.length-1],a.clearRect(0,0,t,o),a.save(),"lines"!=this.options.contourType)"illuminated"==this.options.contourType&&(a.lineWidth=this.options.contourIlluminatedShadowSize+1,a.shadowBlur=this.options.contourIlluminatedShadowSize,a.shadowOffsetX=this.options.contourIlluminatedShadowSize,a.shadowOffsetY=this.options.contourIlluminatedShadowSize,d.forEach(function(e){a.beginPath(),e.value>=u||!this.options.contourBathy?(a.shadowColor=this.options.contourIlluminatedShadowColor,a.strokeStyle=this.options.contourIlluminatedHighlightColor,this.options.contourHypso&&(a.fillStyle=s(e.value))):(a.shadowColor=this.options.contourBathyShadowColor,a.strokeStyle=this.options.contourBathyHighlightColor,this.options.contourBathy&&(a.fillStyle=l(e.value))),r(e),a.stroke(),(this.options.contourHypso||this.options.contourBathy)&&a.fill()},this));else if(a.lineWidth=this.options.contourLineWeight,a.strokeStyle=this.options.contourLineColor,this.options.contourHypso||this.options.contourBathy?d.forEach(function(e){a.beginPath();var t;e.value>=u||!this.options.contourBathy?this.options.contourHypso&&(t=s(e.value)):this.options.contourBathy&&(t=l(e.value)),r(e),t&&(a.fillStyle=t,a.fill()),a.stroke()},this):(a.beginPath(),d.forEach(function(e){(0==f||0!=e.value%f)&&r(e)}),a.stroke()),0!=this.options.contourIndexInterval)if(!this.options.contourIndexLabels)a.lineWidth=this.options.contourLineIndexWeight,a.beginPath(),d.forEach(function(e){0==e.value%f&&r(e)}),a.stroke();else for(g=[],h=function(n){var l=n.value;0==n.value%m.options.contourIndexInterval&&n.coordinates.forEach(function(i){return i.forEach(function(i,a){var r=i.slice(1,1/0),s=JA.range(e.options.contourLabelDistance,1.4*e.options.contourLabelDistance),d=s.map(function(e){return-((r.length-1)%e)}),f=s[JA.scan(d)],u=1+JA.scan(r.map(function(e){return(0===a?-1:1)*e[1]}))%f;r.forEach(function(e,s){if(s%f==u&&10<e[0]&&e[0]<t-10&&10<e[1]&&e[1]<o-10){var i=(s-2+r.length)%r.length,a=(s+2)%r.length,d=r[a][0]-r[i][0],c=r[a][1]-r[i][1];if(0==d&&0==c)return;g.push({threshold:l,xy:e.map(function(e){return 1*e}),angle:zu(c,d),text:""+n.value})}})},e)},m),a.save(),a.beginPath(),a.moveTo(0,0),a.lineTo(t,0),a.lineTo(t,o),a.lineTo(0,o),a.lineTo(0,0);for(var d=0,f=g,u;d<f.length;d++){u=f[d];for(var c=0;c<2*Mu;c+=.2){var p=[20*Vu(c),10*-Hu(c)],h=Vu(u.angle),x=Hu(u.angle);a[0==c?"moveTo":"lineTo"](u.xy[0]+p[0]*h-p[1]*x,u.xy[1]+p[1]*h+p[0]*x)}}a.clip(),0==n.value%m.options.contourIndexInterval&&(a.beginPath(),a.strokeStyle=m.options.contourLineColor,a.lineWidth=m.options.contourLineIndexWeight,r(n),a.stroke()),a.restore();for(var s=0,b=g,u;s<b.length;s++)u=b[s],m._addlabel(a,u,m.options.contourLineColor,m.options.contourLabelFont)},m=this,(x=0,p=d);x<p.length;x++)b=p[x],h(b);return a.restore(),this._map.fire("contourDrawing",{status:!1}),[2]})})},a.prototype._wrapMouseEventHandler=function(e){var t=this;return function(o){var i=o.latlng,n=t._map.project(i,t._tileZoom).floor(),a=t._getTileContainingPoint(n),r=a&&t._getCoordsInTile(a,n),l=void 0;void 0!==r&&(l=(r.y*t._tileSizeAsNumber()+r.x)*4);var s={};if(void 0===l)s.pixelValue=void 0;else{var d=a.el.pixelData;s.pixelValue=r&&t._getPixelValue(d,l)}if(void 0!==l&&1<=t.options.extraPixelLayers){var f=a.el.pixelDataA;s.pixelValueA=r&&t._getPixelValue(f,l)}if(void 0!==l&&2<=t.options.extraPixelLayers){var u=a.el.pixelDataB;s.pixelValueB=r&&t._getPixelValue(u,l)}if(void 0!==l&&3<=t.options.extraPixelLayers){var c=a.el.pixelDataC;s.pixelValueC=r&&t._getPixelValue(c,l)}if(void 0!==l&&4<=t.options.extraPixelLayers){var p=a.el.pixelDataD;s.pixelValueD=r&&t._getPixelValue(p,l)}if(void 0!==l&&5<=t.options.extraPixelLayers){var g=a.el.pixelDataE;s.pixelValueE=r&&t._getPixelValue(g,l)}if(void 0!==l&&6<=t.options.extraPixelLayers){var h=a.el.pixelDataF;s.pixelValueF=r&&t._getPixelValue(h,l)}e(Qu({},o,{pixelValues:s}))}},a.prototype._getTileContainingPoint=function(e){var t=this,o=lr(this._tiles);return _i(o).find(function(o){return o.coords.z===t._tileZoom&&t._tileBounds(o).contains(e)})},a.prototype._tileBounds=function(t){var o=t.coords,i=o.x,n=o.y,a=this._tileSizeAsNumber(),r=e.point(i*a,n*a),l=e.point(r.x+(a-1),r.y+(a-1));return e.bounds(r,l)},a.prototype._getCoordsInTile=function(t,o){var i=t.coords,n=i.x,a=i.y,r=this._tileSizeAsNumber();return e.point(o.x-n*r,o.y-a*r)},a.prototype._getPixelValue=function(e,t){if(e){var o=this.options,i=o.nodataValue,n=o.sentinelValues,a=new DataView(e.buffer),r=a.getFloat32(t,eC);if(r!==i){var l=n&&n.find(function(e){var t=e.offset;return t===r});return l||r}}},a.defaultOptions=tC,a}(e.GridLayer);return oC}(L);
//# sourceMappingURL=bundle.min.js.map
